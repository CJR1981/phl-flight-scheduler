<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHL Flight Scheduler - v3.0 Integrated</title>
    <!--  
    PHL Flight Scheduler v3.0 - INTEGRATED
    Date: February 7, 2026
    
    v3.0 Changes - INTEGRATED CSV PREPROCESSING:
    - **NEW**: Built-in file upload for arrivals and departures CSVs (eliminates Excel Power Query!)
    - **NEW**: Date selector for schedule creation (specific date, not just day of week)
    - **NEW**: Automatic CSV matching and turn processing
      - Matches flights by Nose # (tail number)
      - Creates turn records for aircraft with both arrival and departure
      - Creates terminator records for arrivals without matching departure
      - Calculates ground time between arrival and departure
    - **NEW**: Excel export with Team column prepopulated
      - After scheduler runs, Team assignments automatically added to matched schedule
      - Ready for PowerApp/Dataverse upload
    - **WORKFLOW**: Upload CSVs ‚Üí Select Date ‚Üí Process ‚Üí Download Matched Schedule ‚Üí Run Scheduler ‚Üí Export with Teams
    
    v2.9 Changes - Print Button Error Fix:
    - **FIX**: Print button error when popup blocker prevents window from opening
      - Added null check after window.open() to handle blocked popups gracefully
      - Shows user-friendly error message suggesting to allow popups or use Excel export
      - Prevents "Cannot read properties of undefined (reading 'document')" error
    
    v2.8 Changes - Team Ready Time Logic Fix:
    - **CRITICAL FIX**: Corrected team ready time calculation
      - BUG: Teams were considered "ready" 15 minutes BEFORE shift start
      - REALITY: Teams cannot be ready before they clock in!
      - FIXED: Standard mode - teams ready 15 min AFTER shift start (equipment prep time)
      - FIXED: Flexible modes - teams ready AT shift start (maximum realistic flexibility)
      - Example: Team starts 13:00 √¢‚Ä†‚Äô ready at 13:15 (not 12:45!)
      - This adds realistic prep time for clock-in, truck assignment, equipment check
    
    v2.7 Changes - CRITICAL ALGORITHM BUG FIX:
    - **EMERGENCY FIX**: Corrected team availability checking in ALL assignment functions
      - BUG: Functions checked flight DEPARTURE time against team shift start
      - CORRECT: Must check SERVICE START time (departure - 40 min domestic, - 60 min intl)
      - Example: Flight departs 12:23, service starts 11:43, team must be ready by 11:43
      - Was allowing teams to be assigned flights BEFORE they started work!
      - Fixed in: canAssignFlight(), canAssignFlightFlexible(), canAssignFlightVeryFlexible()
      - This was causing impossible assignments like TM211 (starts 13:00) getting flight departing 12:23
    
    v2.6 Changes:
    - CRITICAL FIX: ETD updates now properly saved when keeping original team
      - Fixed BOTH 'keep' case (no conflicts) AND 'keep_adjust' case (with conflicts)
      - When user rejects swap recommendation and keeps original team
      - Flight time is now updated in both assignment AND team operations array
      - Team operations are re-sorted chronologically after time update
      - Fixes issue where modified ETD was not appearing in flight schedule
      - Applies whether there are timing conflicts or not
    
    v2.2 Changes:
    - CRITICAL FIX: Aircraft turn awareness in conflict detection
      - Flights on same aircraft (same Nose #) are serviced together on one truck load
      - No conflict checking between flights on the same turn
      - Prevents false conflicts on sequential departures of same aircraft
    
    v2.1 Changes:
    - Corrected buffer conflict detection logic
    - Proper international vs domestic buffer handling
    - Character encoding fixes
    -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #0078D2 0%, #005BA1 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .upload-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .upload-section h2 {
            color: #2a5298;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .file-upload-group {
            margin-bottom: 20px;
        }

        .file-upload-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #495057;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type="file"] {
            width: 100%;
            padding: 12px;
            border: 2px dashed #cbd5e0;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-input-wrapper input[type="file"]:hover {
            border-color: #0078D2;
            background: #f7fafc;
        }

        .file-status {
            margin-top: 8px;
            font-size: 0.9em;
            color: #28a745;
            font-weight: 500;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        button {
            padding: 14px 28px;
            font-size: 1em;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: #0078D2;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 120, 210, 0.4);
            background: #005BA1;
        }

        .btn-success {
            background: #0078D2;
            color: white;
        }

        .btn-success:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 120, 210, 0.4);
            background: #005BA1;
        }

        .results-section {
            margin-top: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #0078D2;
        }

        .stat-card h3 {
            font-size: 0.9em;
            color: #6c757d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #2a5298;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th {
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-domestic {
            background: #d1ecf1;
            color: #0c5460;
        }

        .status-international {
            background: #fff3cd;
            color: #856404;
        }
        
        .team-selector {
            padding: 8px 12px;
            border: 2px solid #cbd5e0;
            border-radius: 6px;
            background: white;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 120px;
        }
        
        .team-selector:hover {
            border-color: #0078D2;
            background: #f7fafc;
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
        }
        
        .team-selector:focus {
            outline: none;
            border-color: #0078D2;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }
        
        .team-selector option {
            padding: 8px;
        }
        
        .team-detail-card {
            background: white;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .team-detail-header {
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .team-detail-header h3 {
            margin: 0;
            font-size: 1.5em;
        }
        
        .team-detail-info {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            font-size: 0.95em;
        }
        
        .team-detail-info-item {
            display: flex;
            flex-direction: column;
        }
        
        .team-detail-info-item label {
            opacity: 0.8;
            font-size: 0.85em;
            margin-bottom: 2px;
        }
        
        .team-detail-info-item value {
            font-weight: 600;
        }
        
        .team-flights-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .team-flights-table th {
            background: #f8f9fa;
            color: #495057;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #e9ecef;
        }
        
        .team-flights-table td {
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .team-flights-table tr:hover {
            background: #f8f9fa;
        }
        
        .team-flights-table tr:last-child td {
            border-bottom: none;
        }
        
        .flight-detail-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 600;
            margin-right: 5px;
        }
        
        .overnight-card .team-detail-header {
            background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
            color: #000;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0078D2;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .alert {
            padding: 15px 20px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .alert-info {
            background: #d1ecf1;
            border-left: 4px solid #0c5460;
            color: #0c5460;
        }

        .alert-warning {
            background: #fff3cd;
            border-left: 4px solid #856404;
            color: #856404;
        }

        .alert-success {
            background: #d4edda;
            border-left: 4px solid #155724;
            color: #155724;
        }

        .section-title {
            font-size: 1.3em;
            color: #2a5298;
            margin: 30px 0 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }

        .workload-bar {
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
        }

        .workload-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745 0%, #20c997 50%, #ffc107 80%, #dc3545 100%);
            transition: width 0.3s;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
                justify-content: center;
            }
        }

        /* Live Update Module Styles */
        .live-update-toggle {
            background: rgba(255,255,255,0.95);
            border: 2px solid #3b82f6;
            border-radius: 8px;
            padding: 15px 25px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .live-update-toggle:hover {
            background: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
        }

        .live-update-toggle h3 {
            color: #1e3a8a;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-icon {
            font-size: 1.2em;
            transition: transform 0.3s;
        }

        .toggle-icon.expanded {
            transform: rotate(180deg);
        }

        .live-update-panel {
            background: #f8fafc;
            border-radius: 8px;
            padding: 0;
            margin-bottom: 25px;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .live-update-panel.expanded {
            max-height: 2000px;
            padding: 25px;
        }

        .alert-summary-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .alert-badge {
            background: white;
            padding: 12px 20px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            flex: 1;
            min-width: 150px;
        }

        .alert-badge.critical {
            border-left: 4px solid #ef4444;
        }

        .alert-badge.warning {
            border-left: 4px solid #f59e0b;
        }

        .alert-badge.success {
            border-left: 4px solid #10b981;
        }

        .alert-badge-label {
            font-size: 0.85em;
            color: #64748b;
            font-weight: 600;
        }

        .alert-badge-count {
            font-size: 1.5em;
            font-weight: 700;
            color: #1e293b;
        }

        .update-main-grid {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 25px;
        }

        .update-entry-panel {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .panel-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .flight-search-box {
            position: relative;
            margin-bottom: 20px;
        }

        .flight-search-box input {
            width: 100%;
            padding: 12px 40px 12px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .flight-search-box input:focus {
            outline: none;
            border-color: #3b82f6;
            border-radius: 6px 6px 0 0;
        }

        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
        }

        .flight-update-card {
            background: #f8fafc;
            border: 2px solid #3b82f6;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 15px;
        }

        .flight-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .flight-number-display {
            font-size: 1.2em;
            font-weight: 700;
            color: #1e293b;
        }

        .flight-type-badge {
            background: #dbeafe;
            color: #1e40af;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
        }

        .flight-type-badge.international {
            background: #fef3c7;
            color: #92400e;
        }

        .flight-details-display {
            font-size: 0.9em;
            color: #64748b;
            margin-bottom: 15px;
        }

        .flight-details-display div {
            margin-bottom: 6px;
        }

        .update-form-fields {
            margin-bottom: 15px;
        }

        .form-field-group {
            margin-bottom: 12px;
        }

        .field-label {
            font-size: 0.85em;
            font-weight: 600;
            color: #475569;
            margin-bottom: 6px;
            display: block;
        }

        .field-input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #cbd5e1;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .field-input:disabled {
            background: #f1f5f9;
            color: #64748b;
        }

        .delay-display {
            background: #fef3c7;
            border: 1px solid #fcd34d;
            border-radius: 4px;
            padding: 10px;
            font-size: 0.9em;
            color: #92400e;
        }

        .update-action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .btn-analyze {
            background: #3b82f6;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-analyze:hover {
            background: #2563eb;
        }

        .btn-clear {
            background: white;
            color: #64748b;
            border: 1px solid #cbd5e1;
            padding: 10px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-clear:hover {
            background: #f8fafc;
        }

        .btn-cancel-flight {
            background: #ef4444;
            color: white;
            grid-column: 1 / -1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-cancel-flight:hover {
            background: #dc2626;
        }

        .impact-analysis-panel {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .impact-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
            font-weight: 600;
            color: #f59e0b;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #f59e0b;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .impact-section-box {
            background: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .impact-section-title {
            font-size: 1em;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .team-impact-card {
            background: white;
            border-left: 4px solid #f59e0b;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 4px;
        }

        .team-impact-card.no-conflict {
            border-left-color: #10b981;
        }

        .team-impact-name {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .team-impact-details {
            font-size: 0.9em;
            color: #64748b;
            line-height: 1.6;
        }

        .conflict-tag {
            display: inline-block;
            background: #fef3c7;
            color: #92400e;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75em;
            font-weight: 600;
            margin-top: 6px;
        }

        .conflict-tag.success {
            background: #d1fae5;
            color: #065f46;
        }

        .reallocation-options-grid {
            display: grid;
            gap: 15px;
        }

        .option-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .option-card:hover {
            border-color: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
        }

        .option-card.recommended {
            border-color: #10b981;
            background: #f0fdf4;
        }

        .recommended-tag {
            position: absolute;
            top: -10px;
            right: 16px;
            background: #10b981;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 700;
        }

        .option-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .option-title-text {
            font-size: 1em;
            font-weight: 600;
            color: #1e293b;
        }

        .option-impact-description {
            font-size: 0.85em;
            color: #64748b;
            margin-bottom: 12px;
            line-height: 1.5;
        }

        .option-stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #e2e8f0;
        }

        .stat-box {
            text-align: center;
        }

        .stat-value-text {
            font-size: 1.1em;
            font-weight: 700;
            color: #1e293b;
        }

        .stat-label-text {
            font-size: 0.75em;
            color: #94a3b8;
            margin-top: 2px;
        }

        .recent-updates-section {
            margin-top: 25px;
        }

        .recent-update-item {
            padding: 8px;
            background: white;
            border-radius: 4px;
            margin-bottom: 6px;
            font-size: 0.85em;
            color: #64748b;
        }

        @media (max-width: 1024px) {
            .update-main-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Toast Notification System */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            background: white;
            border-radius: 8px;
            padding: 16px 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            min-width: 300px;
            max-width: 400px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast.success {
            border-left: 4px solid #10b981;
        }

        .toast.error {
            border-left: 4px solid #ef4444;
        }

        .toast.info {
            border-left: 4px solid #3b82f6;
        }

        .toast.warning {
            border-left: 4px solid #f59e0b;
        }

        .toast-icon {
            font-size: 1.5em;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .toast-message {
            font-size: 0.9em;
            color: #64748b;
        }

        /* Modified Flight Indicators */
        .flight-modified {
            background: #f0fdf4 !important;
            border-left: 4px solid #10b981 !important;
        }

        .modified-badge {
            display: inline-block;
            background: #10b981;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75em;
            font-weight: 600;
            margin-left: 8px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .time-modified {
            background: #fef3c7;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 700;
        }

        .team-modified {
            background: #dbeafe;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 700;
        }

        .schedule-modified-banner {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 12px 20px;
            text-align: center;
            font-weight: 600;
            display: none;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .schedule-modified-banner.visible {
            display: block;
        }

        /* Cancelled Flight Styling */
        .flight-cancelled {
            background: #fef2f2 !important;
            border-left: 4px solid #ef4444 !important;
        }

        .cancelled-badge {
            display: inline-block;
            background: #ef4444;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75em;
            font-weight: 600;
            margin-left: 8px;
        }

        .cancelled-text {
            color: #dc2626;
            font-weight: 600;
            text-decoration: line-through;
        }

        .cancelled-team {
            color: #dc2626;
            font-style: italic;
        }

        /* CSV Preprocessing Section Styles */
        .preprocessing-section {
            background: #f8f9fa;
            border: 2px solid #0078D2;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 30px;
        }

        .preprocessing-section h2 {
            color: #0078D2;
            margin-bottom: 20px;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .preprocessing-section h2::before {
            content: "üìÅ";
            font-size: 1.2em;
        }

        .upload-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .upload-box {
            background: white;
            border: 2px dashed #0078D2;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .upload-box:hover {
            background: #f0f8ff;
        }

        .upload-box.has-file {
            border-style: solid;
            background: #e8f5e9;
            border-color: #4caf50;
        }

        .upload-box h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .upload-box p {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .upload-box input[type="file"] {
            display: none;
        }

        .upload-button {
            background: #0078D2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.3s ease;
        }

        .upload-button:hover {
            background: #005BA1;
        }

        .file-name {
            display: inline-block;
            background: #e3f2fd;
            color: #0078D2;
            padding: 8px 15px;
            border-radius: 20px;
            margin-top: 10px;
            font-size: 0.9em;
            font-weight: 500;
        }

        .date-selector {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .date-selector label {
            display: block;
            color: #333;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .date-selector input[type="date"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #0078D2;
            border-radius: 6px;
            font-size: 1em;
            font-family: inherit;
        }

        .processing-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .btn-process {
            background: #4caf50;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .btn-process:hover:not(:disabled) {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }

        .btn-process:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-download-matched {
            background: #ff9800;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .btn-download-matched:hover:not(:disabled) {
            background: #f57c00;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }

        .btn-download-matched:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .processing-status {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }

        .processing-status.show {
            display: block;
        }

        .status-message {
            padding: 12px 20px;
            border-radius: 6px;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .status-message.info {
            background: #e3f2fd;
            color: #1976d2;
            border-left: 4px solid #1976d2;
        }

        .status-message.success {
            background: #e8f5e9;
            color: #388e3c;
            border-left: 4px solid #4caf50;
        }

        .status-message.warning {
            background: #fff3e0;
            color: #f57c00;
            border-left: 4px solid #ff9800;
        }

        .status-message.error {
            background: #ffebee;
            color: #c62828;
            border-left: 4px solid #f44336;
        }
    </style>
</head>
<body>
    <!-- Toast Notification Container -->
    <div class="toast-container" id="toastContainer"></div>
    
    <div class="container">
        <div class="header">
            <h1>PHL Flight Scheduler <span style="background: #10b981; padding: 4px 12px; border-radius: 12px; font-size: 0.4em; margin-left: 10px; vertical-align: middle;">v3.0</span></h1>
            <p>Live Update & Reallocation System</p>
            <p>Philadelphia International Airport - Catering Operations Scheduler</p>
        </div>

        <!-- Modified Schedule Banner -->
        <div class="schedule-modified-banner" id="modifiedBanner">
            Schedule Modified - Changes applied. Export to Excel to save modifications.
        </div>

        <!-- NEW: CSV Preprocessing Section -->
        <div class="preprocessing-section">
            <h2>Upload Flight Data & Generate Schedule</h2>
            <p style="color: #666; margin-bottom: 20px;">Upload your CSV files, select the date, and the scheduler will automatically generate team assignments</p>
            
            <div class="upload-grid">
                <div class="upload-box" id="departuresBox">
                    <h3>üì§ Departures CSV</h3>
                    <p>Upload scheduled departures list</p>
                    <button class="upload-button" type="button" onclick="document.getElementById('departuresFile').click();">Choose File</button>
                    <input type="file" id="departuresFile" accept=".csv" onchange="handleFileUpload(this, 'departures');">
                    <div id="departuresFileName"></div>
                </div>

                <div class="upload-box" id="arrivalsBox">
                    <h3>üì• Arrivals CSV</h3>
                    <p>Upload scheduled arrivals list</p>
                    <button class="upload-button" type="button" onclick="document.getElementById('arrivalsFile').click();">Choose File</button>
                    <input type="file" id="arrivalsFile" accept=".csv" onchange="handleFileUpload(this, 'arrivals');">
                    <div id="arrivalsFileName"></div>
                </div>
            </div>

            <div class="date-selector">
                <label for="scheduleDate">üìÖ Select Schedule Date:</label>
                <input type="date" id="scheduleDate" required>
            </div>

            <div class="processing-controls">
                <button class="btn-process" id="processBtn" onclick="processFlightData()" disabled>
                    üîÑ Process & Generate Schedule
                </button>
                <button class="btn-success" id="exportSchedulerBtn" onclick="exportToExcel()" disabled style="display: none; padding: 15px 40px; font-size: 1.1em; font-weight: 600;">
                    üìä Export Detailed Schedule (9 Tabs)
                </button>
            </div>
            
            <div style="text-align: center; margin-top: 15px;">
                <button class="btn-download-matched" id="downloadMatchedBtn" onclick="downloadMatchedExcel()" disabled style="padding: 8px 16px; font-size: 0.9em; background: #64748b; opacity: 0.8;">
                    üíæ Download Matched Schedule
                </button>
                <div style="font-size: 0.75em; color: #94a3b8; margin-top: 5px;">
                    For PowerApp upload (rarely needed)
                </div>
            </div>

            <div class="processing-status" id="processingStatus">
                <div id="statusMessages"></div>
            </div>
        </div>

        <!-- Hidden selector for scheduler - automatically set based on date -->
        <select id="dayOfWeek" style="display: none;">
            <option value="Monday">Monday</option>
            <option value="Tuesday">Tuesday</option>
            <option value="Wednesday">Wednesday</option>
            <option value="Thursday">Thursday</option>
            <option value="Friday">Friday</option>
            <option value="Saturday">Saturday</option>
            <option value="Sunday">Sunday</option>
        </select>

        <!-- Schedule Results Container (shown after generation) -->
        <div style="padding: 30px; display: none;" id="resultsContainer">
            <div class="results-section" id="results">
                <h2 class="section-title">üìä Schedule Summary</h2>
                <div class="stats-grid" id="statsGrid"></div>

                <!-- Live Update & Reallocation Module (moved to top) -->
                <div class="live-update-toggle" id="liveUpdateToggle" style="margin: 30px 0 20px 0;">
                    <h3>‚ö° Live Flight Update & Reallocation</h3>
                    <span class="toggle-icon" id="toggleIcon">&#9660;</span>
                </div>

                <div class="live-update-panel" id="liveUpdatePanel">
                    <!-- Alert Summary Bar -->
                    <div class="alert-summary-bar">
                        <div class="alert-badge critical">
                            <div>
                                <div class="alert-badge-label">Critical</div>
                                <div class="alert-badge-count" id="criticalCount">0</div>
                            </div>
                        </div>
                        <div class="alert-badge warning">
                            <div>
                                <div class="alert-badge-label">Needs Attention</div>
                                <div class="alert-badge-count" id="warningCount">0</div>
                            </div>
                        </div>
                        <div class="alert-badge success">
                            <div>
                                <div class="alert-badge-label">Resolved Today</div>
                                <div class="alert-badge-count" id="resolvedCount">0</div>
                            </div>
                        </div>
                    </div>

                    <!-- Main Grid: Entry Panel + Impact Analysis -->
                    <div class="update-main-grid">
                        <!-- Left: Flight Update Entry -->
                        <div class="update-entry-panel">
                            <div class="panel-title">Update Flight Status</div>

                            <div class="flight-search-box">
                                <input type="text" id="flightSearchInput" placeholder="Search by flight number or destination...">
                                <span class="search-icon">&#128269;</span>
                            </div>

                            <!-- Flight Update Card (populated when flight selected) -->
                            <div id="flightUpdateCard" style="display: none;">
                                <div class="flight-update-card">
                                    <div class="flight-card-header">
                                        <div class="flight-number-display" id="selectedFlightNumber">AA 1234</div>
                                        <div class="flight-type-badge" id="selectedFlightType">DOMESTIC</div>
                                    </div>

                                    <div class="flight-details-display">
                                        <div><strong>Destination:</strong> <span id="selectedDestination">DFW</span></div>
                                        <div><strong>Scheduled Departure (STD):</strong> <span id="selectedSTD">08:30</span></div>
                                        <div><strong>Assigned Team:</strong> <span id="selectedTeam">TM-015</span></div>
                                        <div><strong>Current Ops Load:</strong> <span id="selectedOpsLoad">5 flights</span></div>
                                    </div>

                                    <div class="update-form-fields">
                                        <div class="form-field-group">
                                            <label class="field-label">Scheduled Departure (STD)</label>
                                            <input type="time" class="field-input" id="stdInput" disabled>
                                        </div>

                                        <div class="form-field-group">
                                            <label class="field-label">New Estimated Departure (ETD)</label>
                                            <input type="time" class="field-input" id="etdInput">
                                        </div>

                                        <div class="form-field-group">
                                            <div class="delay-display" id="delayDisplay">
                                                <strong>Calculated Delay:</strong> <span id="delayAmount">+0 minutes</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="update-action-buttons">
                                        <button class="btn-analyze" id="analyzeBtn" onclick="window.testAnalyze()">Analyze Impact</button>
                                        <button class="btn-clear" id="clearBtn" onclick="window.testClear()">Clear</button>
                                        <button class="btn-cancel-flight" id="cancelFlightBtn" onclick="window.testCancel()">Cancel Flight</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Recent Updates -->
                            <div class="recent-updates-section">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <div class="panel-title" style="font-size: 0.95em;">Recent Updates (Today)</div>
                                    <button id="undoBtn" onclick="undoLastChange()" 
                                            style="padding: 6px 12px; background: #f59e0b; color: white; border: none; border-radius: 4px; 
                                                   font-size: 0.85em; font-weight: 600; cursor: pointer; display: none;"
                                            title="Undo the most recent change">
                                        Undo Last
                                    </button>
                                </div>
                                <div id="recentUpdatesList">
                                    <div style="font-size: 0.85em; color: #94a3b8; padding: 10px; text-align: center;">
                                        No updates yet today
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right: Impact Analysis & Recommendations -->
                        <div class="impact-analysis-panel">
                            <div class="impact-panel-header">
                                <div class="panel-title" style="margin: 0;">Impact Analysis & Recommendations</div>
                                <div class="status-indicator" id="analysisStatus" style="display: none;">
                                    <div class="status-dot"></div>
                                    <span>Analyzing...</span>
                                </div>
                            </div>

                            <div id="impactContent">
                                <div style="text-align: center; padding: 40px; color: #94a3b8;">
                                    <p>Select a flight and click "Analyze Impact" to see<br>reallocation recommendations</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <h2 class="section-title">Team Assignments Summary</h2>
                <div style="margin-bottom: 15px;">
                    <input type="text" id="teamSearchInput" placeholder="&#128269; Search teams by ID, shift, or flights..." 
                           style="width: 100%; padding: 12px; border: 2px solid #cbd5e0; border-radius: 6px; font-size: 1em;">
                </div>
                <div class="table-container">
                    <table id="teamTable">
                        <thead>
                            <tr>
                                <th onclick="sortTeamTable(0)" style="cursor: pointer;">Team &#8597;</th>
                                <th onclick="sortTeamTable(1)" style="cursor: pointer;">Shift &#8597;</th>
                                <th onclick="sortTeamTable(2)" style="cursor: pointer;">Operations &#8597;</th>
                                <th>Workload</th>
                                <th>Flights</th>
                                <th onclick="sortTeamTable(5)" style="cursor: pointer;">First Flight &#8597;</th>
                                <th onclick="sortTeamTable(6)" style="cursor: pointer;">Last Flight &#8597;</th>
                            </tr>
                        </thead>
                        <tbody id="teamTableBody"></tbody>
                    </table>
                </div>

                <h2 class="section-title">Detailed Team Assignments (Grouped by Team)</h2>
                <div style="margin-bottom: 15px; display: flex; gap: 10px; align-items: center;">
                    <select id="printTeamSelect" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; font-size: 1em; flex: 1;">
                        <option value="all">Print All Teams (1 per page)</option>
                    </select>
                    <button onclick="printTeamAssignments()" style="padding: 10px 20px; background: #3b82f6; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                        Print Selected
                    </button>
                </div>
                <div id="teamDetailedGroups"></div>

                <h2 class="section-title">‚úàÔ∏è All Flight Assignments (Chronological)</h2>
                <div class="table-container">
                    <table id="flightTable">
                        <thead>
                            <tr>
                                <th>Flight</th>
                                <th>Destination</th>
                                <th>Departure Time</th>
                                <th>Type</th>
                                <th>Assigned Team</th>
                                <th>Gate</th>
                            </tr>
                        </thead>
                        <tbody id="flightTableBody"></tbody>
                    </table>
                </div>

                <div id="unassignedSection" style="display: none;">
                    <h2 class="section-title">‚ö†Ô∏è Unassigned Flights</h2>
                    <div class="alert alert-warning" id="unassignedAlert"></div>
                    
                    <!-- Auto-Assign Control -->
                    <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <div>
                                <h3 style="margin: 0 0 5px 0; color: #856404;">ü§ñ Smart Assignment</h3>
                                <p style="margin: 0; color: #856404; font-size: 0.9em;">Automatically assign remaining flights using relaxed constraints</p>
                            </div>
                            <button onclick="autoAssignUnassigned()" 
                                    style="padding: 12px 24px; background: #28a745; color: white; border: none; border-radius: 6px; font-weight: 600; font-size: 1em; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                ü§ñ Auto-Assign All
                            </button>
                        </div>
                        <div id="autoAssignStatus" style="font-size: 0.85em; color: #856404;"></div>
                    </div>
                    
                    <div class="table-container">
                        <table id="unassignedTable">
                            <thead>
                                <tr>
                                    <th>Flight</th>
                                    <th>Origin</th>
                                    <th>Time</th>
                                    <th>Type</th>
                                    <th>üí° Suggested Team</th>
                                    <th>Manual Assignment</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="unassignedTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="content" style="display: none;">
            <!-- Step 2 upload section is permanently hidden - scheduling is automated -->
            <div class="upload-section" style="display: none;">
                <h2>üìä Step 2: Run Scheduler</h2>
                <p style="color: #666; margin-bottom: 20px;">Generate team assignments for the processed flight schedule</p>
                
                <div class="file-upload-group">
                    <label for="dayOfWeek">Schedule Day (Auto-Selected from Date)</label>
                    <select id="dayOfWeek" disabled style="width: 100%; padding: 12px; border: 2px solid #cbd5e0; border-radius: 6px; font-size: 1em; background: #f5f5f5; color: #333;">
                        <option value="" disabled selected style="color: #9ca3af;">Process flight data in Step 1 first</option>
                        <option value="Monday">Monday</option>
                        <option value="Tuesday">Tuesday</option>
                        <option value="Wednesday">Wednesday</option>
                        <option value="Thursday">Thursday</option>
                        <option value="Friday">Friday</option>
                        <option value="Saturday">Saturday</option>
                        <option value="Sunday">Sunday</option>
                    </select>
                    <div style="font-size: 0.85em; color: #666; margin-top: 8px;">
                        ‚ÑπÔ∏è Day of week is automatically set based on the date you selected in Step 1
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn-primary" id="generateBtn" disabled>
                        üöÄ Generate Schedule
                    </button>
                    <button class="btn-success" id="exportBtn" disabled>
                        üì• Export to Excel
                    </button>
                </div>
            </div>

            <!-- Live Update & Reallocation Module -->
            <div class="live-update-toggle" id="liveUpdateToggle">
                <h3>Live Flight Update & Reallocation</h3>
                <span class="toggle-icon" id="toggleIcon">&#9660;</span>
            </div>

            <div class="live-update-panel" id="liveUpdatePanel">
                <!-- Alert Summary Bar -->
                <div class="alert-summary-bar">
                    <div class="alert-badge critical">
                        <div>
                            <div class="alert-badge-label">Critical</div>
                            <div class="alert-badge-count" id="criticalCount">0</div>
                        </div>
                    </div>
                    <div class="alert-badge warning">
                        <div>
                            <div class="alert-badge-label">Needs Attention</div>
                            <div class="alert-badge-count" id="warningCount">0</div>
                        </div>
                    </div>
                    <div class="alert-badge success">
                        <div>
                            <div class="alert-badge-label">Resolved Today</div>
                            <div class="alert-badge-count" id="resolvedCount">0</div>
                        </div>
                    </div>
                </div>

                <!-- Main Grid: Entry Panel + Impact Analysis -->
                <div class="update-main-grid">
                    <!-- Left: Flight Update Entry -->
                    <div class="update-entry-panel">
                        <div class="panel-title">Update Flight Status</div>

                        <div class="flight-search-box">
                            <input type="text" id="flightSearchInput" placeholder="Search by flight number or destination...">
                            <span class="search-icon">&#128269;</span>
                        </div>

                        <!-- Flight Update Card (populated when flight selected) -->
                        <div id="flightUpdateCard" style="display: none;">
                            <div class="flight-update-card">
                                <div class="flight-card-header">
                                    <div class="flight-number-display" id="selectedFlightNumber">AA 1234</div>
                                    <div class="flight-type-badge" id="selectedFlightType">DOMESTIC</div>
                                </div>

                                <div class="flight-details-display">
                                    <div><strong>Destination:</strong> <span id="selectedDestination">DFW</span></div>
                                    <div><strong>Scheduled Departure (STD):</strong> <span id="selectedSTD">08:30</span></div>
                                    <div><strong>Assigned Team:</strong> <span id="selectedTeam">TM-015</span></div>
                                    <div><strong>Current Ops Load:</strong> <span id="selectedOpsLoad">5 flights</span></div>
                                </div>

                                <div class="update-form-fields">
                                    <div class="form-field-group">
                                        <label class="field-label">Scheduled Departure (STD)</label>
                                        <input type="time" class="field-input" id="stdInput" disabled>
                                    </div>

                                    <div class="form-field-group">
                                        <label class="field-label">New Estimated Departure (ETD)</label>
                                        <input type="time" class="field-input" id="etdInput">
                                    </div>

                                    <div class="form-field-group">
                                        <div class="delay-display" id="delayDisplay">
                                            <strong>Calculated Delay:</strong> <span id="delayAmount">+0 minutes</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="update-action-buttons">
                                    <button class="btn-analyze" id="analyzeBtn" onclick="window.testAnalyze()">Analyze Impact</button>
                                    <button class="btn-clear" id="clearBtn" onclick="window.testClear()">Clear</button>
                                    <button class="btn-cancel-flight" id="cancelFlightBtn" onclick="window.testCancel()">Cancel Flight</button>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Updates -->
                        <div class="recent-updates-section">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <div class="panel-title" style="font-size: 0.95em;">Recent Updates (Today)</div>
                                <button id="undoBtn" onclick="undoLastChange()" 
                                        style="padding: 6px 12px; background: #f59e0b; color: white; border: none; border-radius: 4px; 
                                               font-size: 0.85em; font-weight: 600; cursor: pointer; display: none;"
                                        title="Undo the most recent change">
                                    Undo Last
                                </button>
                            </div>
                            <div id="recentUpdatesList">
                                <div style="font-size: 0.85em; color: #94a3b8; padding: 10px; text-align: center;">
                                    No updates yet today
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Impact Analysis & Recommendations -->
                    <div class="impact-analysis-panel">
                        <div class="impact-panel-header">
                            <div class="panel-title" style="margin: 0;">Impact Analysis & Recommendations</div>
                            <div class="status-indicator" id="analysisStatus" style="display: none;">
                                <div class="status-dot"></div>
                                <span>Analyzing...</span>
                            </div>
                        </div>

                        <div id="impactContent">
                            <div style="text-align: center; padding: 40px; color: #94a3b8;">
                                
                                <p>Select a flight and click "Analyze Impact" to see<br>reallocation recommendations</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Generating optimized schedule...</p>
            </div>

            <div class="results-section" id="results" style="display: none;">
                <h2 class="section-title"> Schedule Summary</h2>
                <div class="stats-grid" id="statsGrid"></div>

                <h2 class="section-title">Team Assignments Summary</h2>
                <div style="margin-bottom: 15px;">
                    <input type="text" id="teamSearchInput" placeholder="&#128269; Search teams by ID, shift, or flights..." 
                           style="width: 100%; padding: 12px; border: 2px solid #cbd5e0; border-radius: 6px; font-size: 1em;">
                </div>
                <div class="table-container">
                    <table id="teamTable">
                        <thead>
                            <tr>
                                <th onclick="sortTeamTable(0)" style="cursor: pointer;">Team &#8597;</th>
                                <th onclick="sortTeamTable(1)" style="cursor: pointer;">Shift &#8597;</th>
                                <th onclick="sortTeamTable(2)" style="cursor: pointer;">Operations &#8597;</th>
                                <th>Workload</th>
                                <th>Flights</th>
                                <th onclick="sortTeamTable(5)" style="cursor: pointer;">First Flight &#8597;</th>
                                <th onclick="sortTeamTable(6)" style="cursor: pointer;">Last Flight &#8597;</th>
                            </tr>
                        </thead>
                        <tbody id="teamTableBody"></tbody>
                    </table>
                </div>

                <h2 class="section-title">Detailed Team Assignments (Grouped by Team)</h2>
                <div style="margin-bottom: 15px; display: flex; gap: 10px; align-items: center;">
                    <select id="printTeamSelect" style="padding: 10px; border: 2px solid #cbd5e0; border-radius: 6px; font-size: 1em; flex: 1;">
                        <option value="all">Print All Teams (1 per page)</option>
                    </select>
                    <button onclick="printTeamAssignments()" style="padding: 10px 20px; background: #3b82f6; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                        Print Selected
                    </button>
                </div>
                <div id="teamDetailedGroups"></div>

                <h2 class="section-title"> All Flight Assignments (Chronological)</h2>
                <div class="table-container">
                    <table id="flightTable">
                        <thead>
                            <tr>
                                <th>Flight</th>
                                <th>Destination</th>
                                <th>Departure Time</th>
                                <th>Type</th>
                                <th>Assigned Team</th>
                                <th>Gate</th>
                            </tr>
                        </thead>
                        <tbody id="flightTableBody"></tbody>
                    </table>
                </div>

                <div id="unassignedSection" style="display: none;">
                    <h2 class="section-title"> Unassigned Flights</h2>
                    <div class="alert alert-warning" id="unassignedAlert"></div>
                    <div class="table-container">
                        <table id="unassignedTable">
                            <thead>
                                <tr>
                                    <th>Flight</th>
                                    <th>Origin</th>
                                    <th>Time</th>
                                    <th>Type</th>
                                    <th>Reason</th>
                                </tr>
                            </thead>
                            <tbody id="unassignedTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

// ===== CSV PREPROCESSING VARIABLES & FUNCTIONS =====
let departuresData = null;
let arrivalsData = null;
let matchedScheduleData = null;
let selectedDate = null;

// Central scheduler configuration (keeps business rules out of assignment logic)
const SCHEDULER_CONFIG = {
    teams: {
        shiftHours: 8.5,
        prepMinutesStandard: 15,
        prepMinutesFlexible: 0,
        overtimeMinutesStandard: 120,
        overtimeMinutesFlexible: 240,
        workloadLimitStandard: 8,
        workloadLimitFlexible: 10,
        workloadLimitVeryFlexible: 12,
        firehouseReservedTeams: ['TM100', 'TM106']
    },
    flights: {
        serviceBufferDomestic: 40,
        serviceBufferInternational: 60
    },
    spacing: {
        standardMinGap: 30,
        standardIntlAfterDomesticGap: 60,
        standardIntlAfterIntlGap: 90,
        flexibleMinGap: 5,
        flexibleIntlGap: 10,
        veryFlexibleMinGap: 3
    }
};

function getServiceBufferMinutes(flightType) {
    return (flightType === 'Domestic') ?
        SCHEDULER_CONFIG.flights.serviceBufferDomestic :
        SCHEDULER_CONFIG.flights.serviceBufferInternational;
}

function toTimeMinutes(rawTime) {
    if (!rawTime) return null;
    const value = String(rawTime).includes(' ') ? String(rawTime).split(' ').pop() : String(rawTime);
    const minutes = timeToMinutes(value);
    return minutes > 0 ? minutes : null;
}

function addToMultiMap(map, key, value) {
    if (!map.has(key)) {
        map.set(key, []);
    }
    map.get(key).push(value);
}

// Initialize date selector with today's date
document.addEventListener('DOMContentLoaded', () => {
    const today = new Date().toISOString().split('T')[0];
    if (document.getElementById('scheduleDate')) {
        document.getElementById('scheduleDate').value = today;
    }
});

// Handle file upload
function handleFileUpload(input, type) {
    const file = input.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
        const csv = e.target.result;
        Papa.parse(csv, {
            header: true,
            skipEmptyLines: true,
            complete: function(results) {
                if (type === 'departures') {
                    departuresData = results.data;
                    document.getElementById('departuresBox').classList.add('has-file');
                    document.getElementById('departuresFileName').innerHTML = 
                        `<span class="file-name">‚úì ${file.name}</span>`;
                } else {
                    arrivalsData = results.data;
                    document.getElementById('arrivalsBox').classList.add('has-file');
                    document.getElementById('arrivalsFileName').innerHTML = 
                        `<span class="file-name">‚úì ${file.name}</span>`;
                }
                
                // Enable process button if both files are uploaded
                if (departuresData && arrivalsData) {
                    document.getElementById('processBtn').disabled = false;
                }
            }
        });
    };
    reader.readAsText(file);
}

// Process flight data and match turns
function processFlightData() {
    selectedDate = document.getElementById('scheduleDate').value;
    if (!selectedDate) {
        showStatus('Please select a schedule date', 'error');
        return;
    }

    if (!departuresData || !arrivalsData) {
        showStatus('Please upload both CSV files', 'error');
        return;
    }

    showStatus('Processing flight data...', 'info');
    const statusDiv = document.getElementById('processingStatus');
    statusDiv.classList.add('show');

    try {
        // Create maps for quick lookup (support multiple movements per nose)
        const departuresByNose = new Map();
        const arrivalsByNose = new Map();

        // Parse departures
        departuresData.forEach(dep => {
            const nose = dep['Nose #'];
            if (nose && nose.trim()) {
                addToMultiMap(departuresByNose, nose.trim(), dep);
            }
        });

        // Parse arrivals
        arrivalsData.forEach(arr => {
            const nose = arr['Nose #'];
            if (nose && nose.trim()) {
                addToMultiMap(arrivalsByNose, nose.trim(), arr);
            }
        });

        // Match and create schedule
        const matchedSchedule = [];

        // First pass: Create turns and terminators per nose using time-ordered queues
        arrivalsByNose.forEach((arrivalList, nose) => {
            const sortedArrivals = [...arrivalList].sort((a, b) => {
                const ta = toTimeMinutes(a.Arr_ETA || a.Arr_Scheduled || '');
                const tb = toTimeMinutes(b.Arr_ETA || b.Arr_Scheduled || '');
                return (ta ?? Number.MAX_SAFE_INTEGER) - (tb ?? Number.MAX_SAFE_INTEGER);
            });

            const depQueue = [...(departuresByNose.get(nose) || [])].sort((a, b) => {
                const ta = toTimeMinutes(a.Dep_Scheduled || '');
                const tb = toTimeMinutes(b.Dep_Scheduled || '');
                return (ta ?? Number.MAX_SAFE_INTEGER) - (tb ?? Number.MAX_SAFE_INTEGER);
            });

            sortedArrivals.forEach(arrival => {
                const arrTime = toTimeMinutes(arrival.Arr_ETA || arrival.Arr_Scheduled || '');
                const depIdx = depQueue.findIndex(dep => {
                    const depTime = toTimeMinutes(dep.Dep_Scheduled || '');
                    return depTime !== null && arrTime !== null && depTime >= arrTime;
                });

                if (depIdx >= 0) {
                    const departure = depQueue.splice(depIdx, 1)[0];
                    const turn = createTurnRecord(arrival, departure, selectedDate);
                    matchedSchedule.push(turn);
                } else {
                    const terminator = createTerminatorRecord(arrival, selectedDate, 'arrival');
                    matchedSchedule.push(terminator);
                }
            });

            // Any remaining departures for this nose are originators
            depQueue.forEach(departure => {
                const terminator = createTerminatorRecord(departure, selectedDate, 'departure');
                matchedSchedule.push(terminator);
            });

            departuresByNose.delete(nose);
        });

        // Second pass: Add departures for noses that had no arrivals
        departuresByNose.forEach((depList) => {
            depList.forEach(departure => {
                const terminator = createTerminatorRecord(departure, selectedDate, 'departure');
                matchedSchedule.push(terminator);
            });
        });

        // Sort by scheduled time
        matchedSchedule.sort((a, b) => {
            const timeA = a.TurnType === 'Terminator' ? 
                (a.Arr_Scheduled || a.Dep_Scheduled) : a.Arr_Scheduled;
            const timeB = b.TurnType === 'Terminator' ? 
                (b.Arr_Scheduled || b.Dep_Scheduled) : b.Arr_Scheduled;
            return timeA.localeCompare(timeB);
        });

        matchedScheduleData = matchedSchedule;

        showStatus('‚úì Flight data processed! Generating team assignments...', 'info');
        
        document.getElementById('downloadMatchedBtn').disabled = false;
        
        // Pass the FULL matched schedule data to the scheduler (not a simplified version)
        // The scheduler's processFlights() function expects the complete data structure
        flightsData = matchedSchedule;
        
        // Set the day of week based on the selected date
        const dateObj = new Date(selectedDate + 'T00:00:00');
        const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const dayOfWeek = days[dateObj.getDay()];
        
        // Set day of week for scheduler (even though it's hidden)
        const daySelector = document.getElementById('dayOfWeek');
        if (daySelector) {
            daySelector.value = dayOfWeek;
        }
        
        console.log(`‚úì Flight data ready for scheduler: ${flightsData.length} operations loaded`);
        
        // AUTOMATICALLY RUN THE SCHEDULER
        setTimeout(() => {
            try {
                showStatus('üöÄ Generating team assignments...', 'info');
                console.log('=== Auto-generating schedule ===');
                
                scheduleResult = createSchedule();
                
                // Show success message
                showStatus(`‚úÖ Schedule generated successfully! ${scheduleResult.stats.assigned} flights assigned to ${scheduleResult.stats.teamsDeployed} teams.`, 'success');
                
                // Enable export buttons
                document.getElementById('exportSchedulerBtn').style.display = 'inline-block';
                document.getElementById('exportSchedulerBtn').disabled = false;
                
                // Show the results  
                displayResults(scheduleResult);
                setupTeamSearch();
                populatePrintDropdown();
                
                // Make results visible in the visible container
                const resultsSection = document.getElementById('results');
                const resultsContainer = document.getElementById('resultsContainer');
                const contentDiv = document.querySelector('.content');
                
                if (resultsSection && resultsContainer) {
                    resultsSection.style.display = 'block';
                    resultsContainer.style.display = 'block';
                }
                
                // Show the content div to make Live Update module accessible
                if (contentDiv) {
                    contentDiv.style.display = 'block';
                }
                
                console.log('‚úì Schedule generation complete');
                
            } catch (error) {
                showStatus(`‚ùå Error generating schedule: ${error.message}`, 'error');
                console.error('Schedule generation error:', error);
            }
        }, 500); // Small delay to show the processing message

    } catch (error) {
        showStatus(`Error processing data: ${error.message}`, 'error');
        console.error('Processing error:', error);
    }
}

// Create a turn record (arrival + departure)
function createTurnRecord(arrival, departure, scheduleDate) {
    const arrTime = parseTime(arrival.Scheduled);
    const depTime = parseTime(departure.Scheduled);
    
    // Calculate ground time in minutes
    let groundTime = 0;
    if (arrTime && depTime) {
        const arrMinutes = arrTime.hours * 60 + arrTime.minutes;
        let depMinutes = depTime.hours * 60 + depTime.minutes;
        
        // Handle overnight flights
        if (depMinutes < arrMinutes) {
            depMinutes += 24 * 60;
        }
        
        groundTime = depMinutes - arrMinutes;
    }

    return {
        TurnType: 'Turn',
        'Nose #': arrival['Nose #'] || '',
        Arr_Carrier: arrival.Carrier || '',
        Arr_Flight: arrival.Flight || '',
        Arr_Origin: arrival.Origin || '',
        Arr_ETA: formatTime(arrival.Scheduled),
        Arr_Flight_Status: arrival['Flight Status'] || '',
        Arr_Equip: arrival['Equip.'] || '',
        Arr_Dest: arrival['Dest.'] || '',
        Arr_Terminal: arrival.Terminal || '',
        Arr_Gate: arrival.Gate || '',
        Arr_Total_Customers: arrival['Total Customers'] || '0',
        Arr_Connecting_Passengers: arrival['Connecting Passengers'] || '0',
        ArrDate: scheduleDate,
        STA: formatTimeOfDay(arrival.Scheduled),
        Arr_Type: arrival.Type || '',
        Dep_Right_Start: departure['Right Start'] || '',
        Arr_Scheduled: arrival.Scheduled || '',
        DepDate: scheduleDate,
        Dep_Flight: departure.Flight || '',
        Dep_Dest: departure['Dest.'] || '',
        Dep_ETD: formatTime(departure.Scheduled),
        Dep_Flight_Status: departure['Flight Status'] || '',
        Dep_Equip: departure['Equip.'] || '',
        Dep_Terminal: departure.Terminal || '',
        Dep_Gate: departure.Gate || '',
        Dep_Total_Customers: departure['Total Customers'] || '0',
        DepartureDateTime: departure.Scheduled || '',
        Dep_Booking_Factor: departure['Booking Factor'] || '0',
        Dep_Type: departure.Type || '',
        Column1: '',
        STD: formatTimeOfDay(departure.Scheduled),
        Dep_Scheduled: departure.Scheduled || '',
        GroundTime_Minutes: groundTime.toString(),
        Team: '', // Will be populated after scheduler runs
        __PowerAppsId__: generateGuid()
    };
}

// Create a terminator record (arrival OR departure only)
function createTerminatorRecord(flight, scheduleDate, type) {
    const record = {
        TurnType: 'Terminator',
        'Nose #': flight['Nose #'] || '',
        Arr_Carrier: '',
        Arr_Flight: '',
        Arr_Origin: '',
        Arr_ETA: '',
        Arr_Flight_Status: '',
        Arr_Equip: '',
        Arr_Dest: '',
        Arr_Terminal: '',
        Arr_Gate: '',
        Arr_Total_Customers: '0',
        Arr_Connecting_Passengers: '0',
        ArrDate: scheduleDate,
        STA: '',
        Arr_Type: '',
        Dep_Right_Start: '',
        Arr_Scheduled: '',
        DepDate: scheduleDate,
        Dep_Flight: '',
        Dep_Dest: '',
        Dep_ETD: '',
        Dep_Flight_Status: '',
        Dep_Equip: '',
        Dep_Terminal: '',
        Dep_Gate: '',
        Dep_Total_Customers: '0',
        DepartureDateTime: '',
        Dep_Booking_Factor: '0',
        Dep_Type: '',
        Column1: '',
        STD: '',
        Dep_Scheduled: '',
        GroundTime_Minutes: '0',
        Team: '', // Will be populated after scheduler runs
        __PowerAppsId__: generateGuid()
    };

    if (type === 'arrival') {
        // Populate arrival fields
        record.Arr_Carrier = flight.Carrier || '';
        record.Arr_Flight = flight.Flight || '';
        record.Arr_Origin = flight.Origin || '';
        record.Arr_ETA = formatTime(flight.Scheduled);
        record.Arr_Flight_Status = flight['Flight Status'] || '';
        record.Arr_Equip = flight['Equip.'] || '';
        record.Arr_Dest = flight['Dest.'] || '';
        record.Arr_Terminal = flight.Terminal || '';
        record.Arr_Gate = flight.Gate || '';
        record.Arr_Total_Customers = flight['Total Customers'] || '0';
        record.Arr_Connecting_Passengers = flight['Connecting Passengers'] || '0';
        record.STA = formatTimeOfDay(flight.Scheduled);
        record.Arr_Type = flight.Type || '';
        record.Arr_Scheduled = flight.Scheduled || '';
    } else {
        // Populate departure fields
        record.Dep_Right_Start = flight['Right Start'] || '';
        record.Dep_Flight = flight.Flight || '';
        record.Dep_Dest = flight['Dest.'] || '';
        record.Dep_ETD = formatTime(flight.Scheduled);
        record.Dep_Flight_Status = flight['Flight Status'] || '';
        record.Dep_Equip = flight['Equip.'] || '';
        record.Dep_Terminal = flight.Terminal || '';
        record.Dep_Gate = flight.Gate || '';
        record.Dep_Total_Customers = flight['Total Customers'] || '0';
        record.DepartureDateTime = flight.Scheduled || '';
        record.Dep_Booking_Factor = flight['Booking Factor'] || '0';
        record.Dep_Type = flight.Type || '';
        record.STD = formatTimeOfDay(flight.Scheduled);
        record.Dep_Scheduled = flight.Scheduled || '';
    }

    return record;
}

// Parse time string (HH:MM format)
function parseTime(timeStr) {
    if (!timeStr) return null;
    const parts = timeStr.split(':');
    if (parts.length !== 2) return null;
    return {
        hours: parseInt(parts[0]),
        minutes: parseInt(parts[1])
    };
}

// Format time for display (1/0/1900 HH:MM format for PowerApp compatibility)
function formatTime(timeStr) {
    if (!timeStr) return '';
    return `1/0/1900 ${timeStr}`;
}

// Format time of day (HH:MM:SS AM/PM format)
function formatTimeOfDay(timeStr) {
    if (!timeStr) return '';
    const parts = timeStr.split(':');
    if (parts.length !== 2) return '';
    
    let hours = parseInt(parts[0]);
    const minutes = parts[1];
    const ampm = hours >= 12 ? 'PM' : 'AM';
    
    hours = hours % 12;
    if (hours === 0) hours = 12;
    
    return `${hours}:${minutes}:00 ${ampm}`;
}

// Generate GUID for PowerApps
function generateGuid() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        const r = Math.random() * 16 | 0;
        const v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
    });
}

// Download matched schedule as Excel with Team assignments
function downloadMatchedExcel() {
    if (!matchedScheduleData || matchedScheduleData.length === 0) {
        showStatus('No data to download', 'error');
        return;
    }

    // If scheduler has been run, populate Team assignments
    if (scheduleResult && scheduleResult.assignments) {
        populateTeamAssignments();
    }

    console.log('Creating Excel file for PowerApps...');

    // Define column order to match PowerApp expectations
    const columns = [
        'TurnType', 'Nose #', 'Arr_Carrier', 'Arr_Flight', 'Arr_Origin', 'Arr_ETA',
        'Arr_Flight_Status', 'Arr_Equip', 'Arr_Dest', 'Arr_Terminal', 'Arr_Gate',
        'Arr_Total_Customers', 'Arr_Connecting_Passengers', 'ArrDate', 'STA', 'Arr_Type',
        'Dep_Right_Start', 'Arr_Scheduled', 'DepDate', 'Dep_Flight', 'Dep_Dest', 'Dep_ETD',
        'Dep_Flight_Status', 'Dep_Equip', 'Dep_Terminal', 'Dep_Gate', 'Dep_Total_Customers',
        'DepartureDateTime', 'Dep_Booking_Factor', 'Dep_Type', 'Column1', 'STD',
        'Dep_Scheduled', 'GroundTime_Minutes', 'Team', '__PowerAppsId__'
    ];

    // Create workbook
    const wb = XLSX.utils.book_new();
    
    // Create worksheet from JSON with proper column order
    const ws = XLSX.utils.json_to_sheet(matchedScheduleData, { 
        header: columns,
        skipHeader: false 
    });
    
    // Set column widths for readability
    ws['!cols'] = columns.map(() => ({ wch: 15 }));
    
    // Add worksheet to workbook with name "Table1"
    XLSX.utils.book_append_sheet(wb, ws, 'Table1');
    
    // Set workbook properties
    wb.Props = {
        Title: "PHL Matched Schedule",
        Subject: "Flight Schedule with Team Assignments",
        Author: "PHL Scheduler",
        CreatedDate: new Date()
    };

    // Generate filename
    const filename = `Matched_Schedule_${selectedDate.replace(/-/g, '')}_with_Teams.xlsx`;
    
    // Write workbook to array buffer
    const wbout = XLSX.write(wb, { 
        bookType: 'xlsx', 
        type: 'array',
        cellStyles: true,
        bookSST: false
    });
    
    // Create blob
    const blob = new Blob([wbout], { 
        type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' 
    });
    
    // Try modern File System Access API first (Chrome 86+, Edge 86+)
    if ('showSaveFilePicker' in window) {
        // Modern API - shows real save dialog
        console.log('Using File System Access API (modern save dialog)');
        
        window.showSaveFilePicker({
            suggestedName: filename,
            types: [{
                description: 'Excel Files',
                accept: {
                    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': ['.xlsx']
                }
            }]
        }).then(fileHandle => {
            return fileHandle.createWritable();
        }).then(writable => {
            writable.write(blob);
            return writable;
        }).then(writable => {
            writable.close();
            showStatus(`‚úì File saved successfully!`, 'success');
            console.log('File saved via File System Access API');
        }).catch(err => {
            if (err.name !== 'AbortError') {
                console.error('Save error:', err);
                showStatus('Save cancelled or error occurred', 'error');
            } else {
                console.log('User cancelled save dialog');
            }
        });
    } else {
        // Fallback for older browsers
        console.log('File System Access API not available, using fallback');
        console.log('Note: Browser will auto-download to Downloads folder');
        
        // Create download link
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = filename;
        link.style.display = 'none';
        document.body.appendChild(link);
        link.click();
        
        // Cleanup
        setTimeout(() => {
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }, 100);
        
        showStatus(`‚úì File downloading to your Downloads folder: ${filename}`, 'info');
        console.log('File downloaded via legacy method');
    }
    
    console.log('Excel file created successfully');
    console.log(`Sheet: Table1, Rows: ${matchedScheduleData.length}, Columns: ${columns.length}`);
    
    // Show instructions for table format
    setTimeout(() => {
        if (!document.getElementById('tableFormatHint')) {
            const hint = document.createElement('div');
            hint.id = 'tableFormatHint';
            hint.style.cssText = 'position: fixed; bottom: 20px; right: 20px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px; padding: 20px; max-width: 400px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 10000;';
            hint.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                    <strong style="color: #856404; font-size: 1.1em;">üìã PowerApps Import Tip</strong>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; font-size: 1.5em; cursor: pointer; color: #856404;">&times;</button>
                </div>
                <div style="color: #856404; font-size: 0.9em; line-height: 1.5;">
                    <p style="margin: 0 0 10px 0;"><strong>For PowerApps to recognize the file:</strong></p>
                    <ol style="margin: 0; padding-left: 20px;">
                        <li>Open the file in Excel</li>
                        <li>Click any data cell</li>
                        <li>Press <strong>Ctrl+T</strong></li>
                        <li>Click OK</li>
                        <li>Save and import to PowerApps</li>
                    </ol>
                    <p style="margin: 10px 0 0 0; font-size: 0.85em; font-style: italic;">This creates the Table1 format PowerApps needs.</p>
                </div>
            `;
            document.body.appendChild(hint);
            
            // Auto-remove after 15 seconds
            setTimeout(() => {
                if (hint.parentElement) {
                    hint.remove();
                }
            }, 15000);
        }
    }, 1000);
}

// Populate Team assignments from scheduler results into matched schedule
function populateTeamAssignments() {
    if (!scheduleResult || !scheduleResult.assignments) return;
    
    // Create a map of flight number to team assignment
    const teamMap = new Map();
    scheduleResult.assignments.forEach(assignment => {
        const flightNum = assignment.flight.flight.replace('AA ', '');
        teamMap.set(flightNum, assignment.team);
    });
    
    // Update matched schedule with team assignments
    matchedScheduleData.forEach(item => {
        if (item.Dep_Flight) {
            const team = teamMap.get(item.Dep_Flight);
            if (team) {
                item.Team = team;
            }
        }
    });
}

// Show status message
function showStatus(message, type) {
    const messagesDiv = document.getElementById('statusMessages');
    const statusDiv = document.createElement('div');
    statusDiv.className = `status-message ${type}`;
    statusDiv.textContent = message;
    messagesDiv.innerHTML = '';
    messagesDiv.appendChild(statusDiv);
}

// ===== END CSV PREPROCESSING FUNCTIONS =====


// EMBEDDED AGENT DATA - No need to upload CSVs
const EMBEDDED_FT_DATA = [
  {
    "AA ID": "921303",
    "Last Name": "Nunez",
    "First Name": "Abel",
    "LN#": "9254",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM211",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM211",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM212",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM212",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM220",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "76d75b4e-996e-4dfd-8a72-57ad2b82a337"
  },
  {
    "AA ID": "763881",
    "Last Name": "Amare",
    "First Name": "Abeselom",
    "LN#": "9342",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "f696d265-a420-4c83-ae95-aa776acc6651"
  },
  {
    "AA ID": "583128",
    "Last Name": "Dahn",
    "First Name": "Abraham",
    "LN#": "9210",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM204",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM204",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM204",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM204",
    "Friday": "0500-1330",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM204",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "80655a97-0ce9-4d7f-87d4-5e1e0a9edb69"
  },
  {
    "AA ID": "229132",
    "Last Name": "Branch",
    "First Name": "Acquil",
    "LN#": "9264",
    "LineType": "Regular",
    "Monday": "1400-2230",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM224",
    "Tuesday": "1400-2230",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM224",
    "Wednesday": "1400-2230",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM224",
    "Thursday": "1400-2230",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM224",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1400-2230",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM224",
    "__PowerAppsId__": "136c2c45-d218-4f67-b457-285b44d79393"
  },
  {
    "AA ID": "365469",
    "Last Name": "Bornstein",
    "First Name": "Adam",
    "LN#": "9303",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1430-2300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1430-2300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1430-2300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1430-2300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1430-2300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "2e23dd88-8034-4f0b-a611-d5c3068ed31f"
  },
  {
    "AA ID": "775639",
    "Last Name": "Adim",
    "First Name": "Adil",
    "LN#": "9348",
    "LineType": "Open Time",
    "Monday": "",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "66256606-ff06-4712-a772-1f6b2f03becf"
  },
  {
    "AA ID": "920915",
    "Last Name": "Brown",
    "First Name": "Alaysiah",
    "LN#": "9338",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "7110fd90-5345-4d30-bc21-a9b57e8c374f"
  },
  {
    "AA ID": "543150",
    "Last Name": "Jarquin-Monge",
    "First Name": "Alejandro",
    "LN#": "9206",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM202",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM202",
    "Friday": "0500-1330",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM202",
    "Saturday": "0500-1330",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM202",
    "Sunday": "0500-1330",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM202",
    "__PowerAppsId__": "aa6892db-7fc5-4452-b386-31749925b0d4"
  },
  {
    "AA ID": "920934",
    "Last Name": "Jones",
    "First Name": "Alexander",
    "LN#": "9230",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM211",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM211",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM211",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM211",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM211",
    "__PowerAppsId__": "c404b21a-d2ce-40a2-80c3-8cb87cc45d0d"
  },
  {
    "AA ID": "766458",
    "Last Name": "Sampson",
    "First Name": "Alexandro",
    "LN#": "9275",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0430-1300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0430-1300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0430-1300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0430-1300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0430-1300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "6f99bfdd-db16-4722-99a0-6df0af0cb3f9"
  },
  {
    "AA ID": "526624",
    "Last Name": "Raza",
    "First Name": "Ali",
    "LN#": "9292",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "65b2b45f-395f-4857-bcbe-f6e2cc772144"
  },
  {
    "AA ID": "108707",
    "Last Name": "Douglas",
    "First Name": "Amari",
    "LN#": "9297",
    "LineType": "Regular",
    "Monday": "2100-0530",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "2100-0530",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "2100-0530",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "2100-0530",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "2100-0530",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "cf8fecc5-8cfa-4d90-b95e-2e7e36227e57"
  },
  {
    "AA ID": "920919",
    "Last Name": "Alexander",
    "First Name": "Andrew",
    "LN#": "9244",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM219",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM219",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM219",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM219",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM219",
    "__PowerAppsId__": "8e9bdef8-a9c0-4d34-afab-4645b2cfe9f0"
  },
  {
    "AA ID": "469168",
    "Last Name": "Mosley",
    "First Name": "Andrew",
    "LN#": "9250",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM215",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM216",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM216",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM217",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM215",
    "__PowerAppsId__": "ffb26d17-d157-44a4-bf5f-718cc53b0bdb"
  },
  {
    "AA ID": "953237",
    "Last Name": "Jordan",
    "First Name": "Angel",
    "LN#": "9263",
    "LineType": "Regular",
    "Monday": "1400-2230",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM223",
    "Tuesday": "1400-2230",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM223",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1400-2230",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM224",
    "Saturday": "1400-2230",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM224",
    "Sunday": "1400-2230",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM224",
    "__PowerAppsId__": "8e473fa3-2179-4d9b-b9ef-6eafaf26674f"
  },
  {
    "AA ID": "208708",
    "Last Name": "Valcarcel",
    "First Name": "Angelo",
    "LN#": "9251",
    "LineType": "Variable",
    "Monday": "1200-2030",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM210",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM220",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM214",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM214",
    "Sunday": "1200-2030",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM210",
    "__PowerAppsId__": "510571e9-1919-4db4-af0a-b4ac8c62a7a3"
  },
  {
    "AA ID": "773255",
    "Last Name": "Baldwin",
    "First Name": "Anthony",
    "LN#": "9327",
    "LineType": "Regular",
    "Monday": "0400-1230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0400-1230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "0400-1230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0400-1230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0400-1230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "d4a4b7f6-6a8d-455d-9bab-a7d49137dffd"
  },
  {
    "AA ID": "100316",
    "Last Name": "Banks",
    "First Name": "Antonio",
    "LN#": "9213",
    "LineType": "Regular",
    "Monday": "0600-1430",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM206",
    "Tuesday": "0600-1430",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM206",
    "Wednesday": "0600-1430",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM206",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0600-1430",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM206",
    "Sunday": "0600-1430",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM206",
    "__PowerAppsId__": "5204a81f-a254-4c6d-ba55-e8e8e1a2ca56"
  },
  {
    "AA ID": "856584",
    "Last Name": "Ammishaddai",
    "First Name": "Asher",
    "LN#": "9232",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM212",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM212",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM212",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM212",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM212",
    "__PowerAppsId__": "112656af-7c51-477f-aa8c-ee070271ce3e"
  },
  {
    "AA ID": "148474",
    "Last Name": "Baiden",
    "First Name": "Bernard",
    "LN#": "9300",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "0500-1330",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0500-1330",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1330",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "785202a0-80ef-4d54-9640-d500849c685a"
  },
  {
    "AA ID": "920920",
    "Last Name": "Diana",
    "First Name": "Billy",
    "LN#": "9345",
    "LineType": "Regular",
    "Monday": "1400-2230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1400-2230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1400-2230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1400-2230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1400-2230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "420c957f-0026-42bb-a9d5-04be54350179"
  },
  {
    "AA ID": "956541",
    "Last Name": "Dick",
    "First Name": "Bradley",
    "LN#": "9343",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "f059215b-7865-4e13-a7cc-82fcdd0f08ab"
  },
  {
    "AA ID": "100939",
    "Last Name": "Barringer",
    "First Name": "Brian",
    "LN#": "9280",
    "LineType": "Regular",
    "Monday": "0430-1300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0430-1300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0430-1300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0430-1300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0430-1300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "d456457f-f7b1-4214-9590-18a36cb6fe11"
  },
  {
    "AA ID": "537843",
    "Last Name": "Boynes",
    "First Name": "Brian",
    "LN#": "9304",
    "LineType": "Regular",
    "Monday": "1400-2230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1400-2230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1400-2230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1400-2230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1400-2230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "756ba12a-cc82-4328-ab14-d86c58ca01fc"
  },
  {
    "AA ID": "773596",
    "Last Name": "Shultz",
    "First Name": "Brian",
    "LN#": "9325",
    "LineType": "Variable",
    "Monday": "1330-2200",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0500-1330",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1330-2200",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1330-2200",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "4e18985b-4163-43ed-a026-f37d2ecdee7b"
  },
  {
    "AA ID": "365066",
    "Last Name": "Nichols",
    "First Name": "Brian",
    "LN#": "9350",
    "LineType": "Open Time",
    "Monday": "",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "6b0d413a-b7e4-4b3d-973c-9a897201613b"
  },
  {
    "AA ID": "902769",
    "Last Name": "Sam",
    "First Name": "Bryan",
    "LN#": "9231",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM212",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM212",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM212",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM212",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM212",
    "__PowerAppsId__": "db331175-44a5-443f-b912-438299fa505f"
  },
  {
    "AA ID": "567990",
    "Last Name": "Paraninfo",
    "First Name": "Calogero",
    "LN#": "9314",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1430-2300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1430-2300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1430-2300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1430-2300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1430-2300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "a3b09f3f-ee91-4c9b-8693-382d14e3da6e"
  },
  {
    "AA ID": "540273",
    "Last Name": "Way",
    "First Name": "Carl",
    "LN#": "9328",
    "LineType": "Regular",
    "Monday": "0400-1230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0400-1230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0400-1230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0400-1230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0400-1230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "2fc79afe-7348-4689-bfa7-e6b5bf5fec98"
  },
  {
    "AA ID": "885159",
    "Last Name": "Pyatt",
    "First Name": "Chanel",
    "LN#": "9282",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "858e03f9-67ec-41ff-86c9-a947518888a2"
  },
  {
    "AA ID": "398972",
    "Last Name": "Andrews",
    "First Name": "Charles",
    "LN#": "9305",
    "LineType": "Variable",
    "Monday": "1430-2300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1400-2230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1400-2230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1200-2030",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1200-2030",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "055d36c7-16a1-46e6-9d52-808c2db288fe"
  },
  {
    "AA ID": "465452",
    "Last Name": "COLELLA",
    "First Name": "CHARLES",
    "LN#": "9307",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0600-1430",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0600-1430",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0600-1430",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0600-1430",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0600-1430",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "048d24db-29c5-402a-9360-11f48044b0ca"
  },
  {
    "AA ID": "377958",
    "Last Name": "Phung",
    "First Name": "Chris",
    "LN#": "9267",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0430-1300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0430-1300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0430-1300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0430-1300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0430-1300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "de2906b3-6d2e-4564-87a3-bbfeedea815b"
  },
  {
    "AA ID": "140196",
    "Last Name": "Palmer",
    "First Name": "Christopher",
    "LN#": "9216",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0700-1530",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM207",
    "Wednesday": "0700-1530",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM207",
    "Thursday": "0700-1530",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM207",
    "Friday": "0700-1530",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM207",
    "Saturday": "0700-1530",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM207",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "0e9d721d-f8cb-4888-b9fc-5db8d2bedd76"
  },
  {
    "AA ID": "420418",
    "Last Name": "King",
    "First Name": "Christopher",
    "LN#": "9315",
    "LineType": "Regular",
    "Monday": "1430-2300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1430-2300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1430-2300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1430-2300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1430-2300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "7628bcb7-c434-4427-869e-1dacb25f113f"
  },
  {
    "AA ID": "902755",
    "Last Name": "Thomas",
    "First Name": "Clarence",
    "LN#": "9252",
    "LineType": "Variable",
    "Monday": "1200-2030",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM210",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM220",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM214",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM214",
    "Sunday": "1200-2030",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM210",
    "__PowerAppsId__": "51d553f1-4261-4228-b7ad-8f4877ab0fc6"
  },
  {
    "AA ID": "145706",
    "Last Name": "Hill",
    "First Name": "Clarence",
    "LN#": "9261",
    "LineType": "Regular",
    "Monday": "1400-2230",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM223",
    "Tuesday": "1400-2230",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM223",
    "Wednesday": "1400-2230",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM223",
    "Thursday": "1400-2230",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM223",
    "Friday": "1400-2230",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM223",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "96452a80-910d-4c4a-bcbb-de1a28bfd215"
  },
  {
    "AA ID": "488601",
    "Last Name": "Rost",
    "First Name": "Clement",
    "LN#": "9313",
    "LineType": "Regular",
    "Monday": "1430-2300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1430-2300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1430-2300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1430-2300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1430-2300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "c72370ca-3855-4829-9bd5-df3e7dcc5bd2"
  },
  {
    "AA ID": "192872",
    "Last Name": "Nguyen",
    "First Name": "Daniel",
    "LN#": "9211",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0600-1430",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM205",
    "Thursday": "0600-1430",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM205",
    "Friday": "0600-1430",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM205",
    "Saturday": "0600-1430",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM205",
    "Sunday": "0600-1430",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM205",
    "__PowerAppsId__": "20852fcb-b23d-419c-b3e1-022c47df9aba"
  },
  {
    "AA ID": "774531",
    "Last Name": "Boyer",
    "First Name": "Darnell",
    "LN#": "9235",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM215",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM215",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM215",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM215",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM215",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "8fd2ad9e-0708-4695-95d5-e07f03c09287"
  },
  {
    "AA ID": "179596",
    "Last Name": "White",
    "First Name": "Darryl",
    "LN#": "9221",
    "LineType": "Variable",
    "Monday": "0600-1430",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM205",
    "Tuesday": "0600-1430",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM205",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM202",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM203",
    "Friday": "0500-1330",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM203",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "5103b608-d754-47a8-ba15-ec3420826c7b"
  },
  {
    "AA ID": "359698",
    "Last Name": "John",
    "First Name": "Darryl",
    "LN#": "9286",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "b3ad99ea-e350-40e9-9df8-72725ab2a5fa"
  },
  {
    "AA ID": "189135",
    "Last Name": "Saccone",
    "First Name": "David",
    "LN#": "9277",
    "LineType": "Regular",
    "Monday": "0430-1300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0430-1300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "0430-1300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0430-1300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0430-1300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "75c3eda2-6dcb-4684-a62c-e92d7c749dbd"
  },
  {
    "AA ID": "793726",
    "Last Name": "Robinson",
    "First Name": "Deborah",
    "LN#": "9276",
    "LineType": "Regular",
    "Monday": "0430-1300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0430-1300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0430-1300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0430-1300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0430-1300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "3e387196-04e2-46cb-84b7-054e329a99d7"
  },
  {
    "AA ID": "212615",
    "Last Name": "Carter",
    "First Name": "Deja",
    "LN#": "9228",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1200-2030",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM210",
    "Wednesday": "1200-2030",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM210",
    "Thursday": "1200-2030",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM210",
    "Friday": "1200-2030",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM210",
    "Saturday": "1200-2030",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM210",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "3792803b-6841-49ea-9ff7-f72966058e6e"
  },
  {
    "AA ID": "237067",
    "Last Name": "Hopson",
    "First Name": "Dennis",
    "LN#": "9249",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM215",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM216",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM216",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM217",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM215",
    "__PowerAppsId__": "deda8428-a4eb-447e-893d-46959e37756e"
  },
  {
    "AA ID": "220409",
    "Last Name": "Winfield-Riggs",
    "First Name": "Di'Asha",
    "LN#": "9269",
    "LineType": "Regular",
    "Monday": "0430-1300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0430-1300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0430-1300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0430-1300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0430-1300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "6a3f1eb9-ac17-48a9-9ce7-7bf021b12494"
  },
  {
    "AA ID": "846712",
    "Last Name": "Bernal-Santos",
    "First Name": "Dilia",
    "LN#": "9253",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM211",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM211",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM212",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM212",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM220",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "a0b4c245-70cb-4f31-b26e-2e0806fcef50"
  },
  {
    "AA ID": "920936",
    "Last Name": "Ruiz",
    "First Name": "Eduardo",
    "LN#": "9339",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "a5c70011-a0e9-4533-9379-de6985db9366"
  },
  {
    "AA ID": "354357",
    "Last Name": "Murph",
    "First Name": "Elisa",
    "LN#": "9326",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0400-1230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0400-1230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0400-1230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0400-1230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0400-1230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "584956bc-43c4-4a87-a2cf-b1c73fa01212"
  },
  {
    "AA ID": "101609",
    "Last Name": "Williams",
    "First Name": "Eric",
    "LN#": "9333",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0500-1330",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0500-1330",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1330",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "7487eb4c-1dff-4c55-8e50-b7110740f8d3"
  },
  {
    "AA ID": "771346",
    "Last Name": "Abdul",
    "First Name": "Fatao",
    "LN#": "9265",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1400-2230",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM224",
    "Wednesday": "1400-2230",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM224",
    "Thursday": "1400-2230",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM224",
    "Friday": "1400-2230",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM224",
    "Saturday": "1400-2230",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM224",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "52599af8-ab11-4fc3-b0af-ae71e69a8f62"
  },
  {
    "AA ID": "401312",
    "Last Name": "Rehman",
    "First Name": "Gohar",
    "LN#": "9217",
    "LineType": "Regular",
    "Monday": "0700-1530",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM208",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0700-1530",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM208",
    "Friday": "0700-1530",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM208",
    "Saturday": "0700-1530",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM208",
    "Sunday": "0700-1530",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM208",
    "__PowerAppsId__": "fb69af55-7333-4e14-a73a-c0e3e6187b67"
  },
  {
    "AA ID": "444097",
    "Last Name": "Bauereis",
    "First Name": "Gregory",
    "LN#": "9298",
    "LineType": "Regular",
    "Monday": "0400-1230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0400-1230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0400-1230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0400-1230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0400-1230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "8e18bd51-82b9-4f00-bd69-3b01bf4095a2"
  },
  {
    "AA ID": "920940",
    "Last Name": "HUA",
    "First Name": "HUMPHREY",
    "LN#": "9229",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM211",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM211",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM211",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM211",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM211",
    "__PowerAppsId__": "03ce72a7-405c-4e2a-b326-a522f0d7753f"
  },
  {
    "AA ID": "101115",
    "Last Name": "Destina",
    "First Name": "Ivencleef",
    "LN#": "9207",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM203",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM203",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM203",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0500-1330",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM203",
    "Sunday": "0500-1330",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM203",
    "__PowerAppsId__": "e90192f2-2530-43e8-b7ca-cbf5a9f5d865"
  },
  {
    "AA ID": "797089",
    "Last Name": "Everett",
    "First Name": "Jakara",
    "LN#": "9246",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM220",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM220",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM220",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM220",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM220",
    "__PowerAppsId__": "a641ae40-d8d0-47df-853c-032525ab6ca6"
  },
  {
    "AA ID": "101576",
    "Last Name": "Coulter",
    "First Name": "Jalil",
    "LN#": "9233",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM214",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM214",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM214",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM214",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM214",
    "__PowerAppsId__": "a062fb84-9fcf-42ef-b3a7-dc93c705328e"
  },
  {
    "AA ID": "540462",
    "Last Name": "West",
    "First Name": "Jamal",
    "LN#": "9225",
    "LineType": "Regular",
    "Monday": "0700-1530",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM207",
    "Tuesday": "0700-1530",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM208",
    "Wednesday": "0700-1530",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM208",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0700-1530",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0700-1530",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM207",
    "__PowerAppsId__": "3327d36e-f4f1-498e-a817-07e7931efc82"
  },
  {
    "AA ID": "296349",
    "Last Name": "Jackson",
    "First Name": "Jaquione",
    "LN#": "9242",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM218",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM218",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM218",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM218",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM218",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "d488ae0c-38e8-4f61-9ff2-fc0d14b23643"
  },
  {
    "AA ID": "467137",
    "Last Name": "Anderson",
    "First Name": "Jermele",
    "LN#": "9204",
    "LineType": "Regular",
    "Monday": "0400-1230",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM201",
    "Tuesday": "0400-1230",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM201",
    "Wednesday": "0400-1230",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM201",
    "Thursday": "0400-1230",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM201",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "0400-1230",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM201",
    "__PowerAppsId__": "9cd8900a-ac75-4646-ac32-c5447749fc83"
  },
  {
    "AA ID": "442863",
    "Last Name": "Austin",
    "First Name": "Jessica",
    "LN#": "9219",
    "LineType": "Variable",
    "Monday": "0300-1130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM200",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM202",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "0400-1230",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM201",
    "Saturday": "0400-1230",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM201",
    "Sunday": "0300-1130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM200",
    "__PowerAppsId__": "67b4ddce-0f61-4d9a-9217-c5966d66a0b7"
  },
  {
    "AA ID": "366688",
    "Last Name": "Taylor",
    "First Name": "Jessica",
    "LN#": "9268",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0430-1300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0430-1300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0430-1300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0430-1300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0430-1300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "173379be-016b-483e-950c-eec7381f3a64"
  },
  {
    "AA ID": "776106",
    "Last Name": "Reynolds",
    "First Name": "Jessica",
    "LN#": "9271",
    "LineType": "Regular",
    "Monday": "0430-1300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0430-1300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0430-1300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0430-1300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0430-1300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "b14319e4-121e-47b3-924e-9bf8d124232e"
  },
  {
    "AA ID": "597525",
    "Last Name": "Lewis-Wise",
    "First Name": "John",
    "LN#": "9220",
    "LineType": "Variable",
    "Monday": "0300-1130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM200",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM202",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "0400-1230",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM201",
    "Saturday": "0400-1230",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM201",
    "Sunday": "0300-1130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM200",
    "__PowerAppsId__": "906281e8-6e21-4744-b485-ac8dd4eb5cac"
  },
  {
    "AA ID": "383095",
    "Last Name": "Dawson",
    "First Name": "John",
    "LN#": "9321",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "3711b9d7-5e65-4723-9ccd-84c6e5e7bfd6"
  },
  {
    "AA ID": "400473",
    "Last Name": "Cephas",
    "First Name": "Joseph",
    "LN#": "9205",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM202",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM202",
    "Friday": "0500-1330",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM202",
    "Saturday": "0500-1330",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM202",
    "Sunday": "0500-1330",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM202",
    "__PowerAppsId__": "81dbf578-1e55-4877-979a-5e6faa123bb1"
  },
  {
    "AA ID": "529159",
    "Last Name": "Mcnamee",
    "First Name": "Joseph",
    "LN#": "9306",
    "LineType": "Regular",
    "Monday": "0600-1430",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0600-1430",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0600-1430",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0600-1430",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "0600-1430",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "3cef9bba-0c9b-40a8-a1b7-ccb0000c7cd8"
  },
  {
    "AA ID": "905333",
    "Last Name": "Bell",
    "First Name": "Joy",
    "LN#": "9283",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "2b257da8-a76c-47cb-bb15-b99c6ea914b7"
  },
  {
    "AA ID": "921081",
    "Last Name": "Jarquin",
    "First Name": "Justin",
    "LN#": "9240",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM217",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM217",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM217",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM217",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM217",
    "__PowerAppsId__": "ecb7695d-a567-4db7-9338-8fde6fd8d9b2"
  },
  {
    "AA ID": "921047",
    "Last Name": "Degale",
    "First Name": "Justin",
    "LN#": "9255",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1400-2230",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM221",
    "Thursday": "1400-2230",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM221",
    "Friday": "1400-2230",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM221",
    "Saturday": "1400-2230",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM221",
    "Sunday": "1400-2230",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM221",
    "__PowerAppsId__": "e32dfcc6-d704-4dec-85f0-d86b8e17488b"
  },
  {
    "AA ID": "394917",
    "Last Name": "Raza",
    "First Name": "Kazim",
    "LN#": "9322",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "8234537d-ca01-4493-b117-c99d0b1bbfe7"
  },
  {
    "AA ID": "562831",
    "Last Name": "Smith",
    "First Name": "Keith",
    "LN#": "9270",
    "LineType": "Regular",
    "Monday": "0430-1300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0430-1300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "0430-1300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0430-1300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0430-1300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "f2a9ac1c-1e50-4e98-b1bf-3dc930c61d1a"
  },
  {
    "AA ID": "331206",
    "Last Name": "Mitchell",
    "First Name": "Kendra",
    "LN#": "9226",
    "LineType": "Regular",
    "Monday": "0700-1530",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM207",
    "Tuesday": "0700-1530",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM208",
    "Wednesday": "0700-1530",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM208",
    "Thursday": "0700-1530",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "0700-1530",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM207",
    "__PowerAppsId__": "2ecadad1-6489-4ac9-8d90-b2cd61f41975"
  },
  {
    "AA ID": "921067",
    "Last Name": "Behlin",
    "First Name": "Kenneth",
    "LN#": "9238",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM216",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM216",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM216",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM216",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM216",
    "__PowerAppsId__": "3d73389e-f062-4cd4-9b75-c42a32ffa0b3"
  },
  {
    "AA ID": "395220",
    "Last Name": "Daughtry",
    "First Name": "Kevin",
    "LN#": "9301",
    "LineType": "Variable",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0500-1330",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0400-1230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0400-1230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "dcc1e01a-ee30-4bf4-9400-b1a567a70568"
  },
  {
    "AA ID": "921068",
    "Last Name": "DeJesus",
    "First Name": "Kevin",
    "LN#": "9347",
    "LineType": "Regular",
    "Monday": "1400-2230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1400-2230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1400-2230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1400-2230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1400-2230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "13454744-1ae5-440a-b831-06526a29940f"
  },
  {
    "AA ID": "73717",
    "Last Name": "Murray",
    "First Name": "Kevonna",
    "LN#": "9218",
    "LineType": "Regular",
    "Monday": "0700-1530",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM208",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0700-1530",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM208",
    "Friday": "0700-1530",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM208",
    "Saturday": "0700-1530",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM208",
    "Sunday": "0700-1530",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM208",
    "__PowerAppsId__": "7dddb9ae-2546-4ed0-8d8a-e80114b206af"
  },
  {
    "AA ID": "165561",
    "Last Name": "George",
    "First Name": "Krishna",
    "LN#": "9281",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "a4eaaff4-5d53-4b03-aec9-2db860133e00"
  },
  {
    "AA ID": "854651",
    "Last Name": "Boyd",
    "First Name": "Lamar",
    "LN#": "9245",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM220",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM220",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM220",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM220",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM220",
    "__PowerAppsId__": "907cca70-6458-4617-9890-d8724c7215a6"
  },
  {
    "AA ID": "404687",
    "Last Name": "Ryons",
    "First Name": "Lawrence",
    "LN#": "9222",
    "LineType": "Variable",
    "Monday": "0600-1430",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM205",
    "Tuesday": "0600-1430",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM205",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM202",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM203",
    "Friday": "0500-1330",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM203",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "8b440088-b3c8-4528-af33-fcff47c72df1"
  },
  {
    "AA ID": "709203",
    "Last Name": "Heard",
    "First Name": "Lawrence",
    "LN#": "9336",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "36a31105-0935-4dce-8bae-fe22dcb9bd81"
  },
  {
    "AA ID": "553882",
    "Last Name": "Valcarcel",
    "First Name": "Leonardo",
    "LN#": "9312",
    "LineType": "Regular",
    "Monday": "1430-2300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1430-2300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1430-2300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1430-2300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1430-2300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "a1f720d9-159e-4fce-b1ea-9fdd04b74289"
  },
  {
    "AA ID": "377077",
    "Last Name": "Johnson",
    "First Name": "Levern",
    "LN#": "9241",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM218",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM218",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM218",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM218",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM218",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "53192c23-99c1-43ca-b66c-912f20ffbc18"
  },
  {
    "AA ID": "129413",
    "Last Name": "Cherry",
    "First Name": "Luther",
    "LN#": "9224",
    "LineType": "Variable",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0600-1430",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0600-1430",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM206",
    "Friday": "0600-1430",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM206",
    "Saturday": "0500-1330",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM204",
    "Sunday": "0500-1330",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM204",
    "__PowerAppsId__": "48df5eef-af16-4d1b-8755-1cd8ef3deeca"
  },
  {
    "AA ID": "921082",
    "Last Name": "Maddox",
    "First Name": "Makai",
    "LN#": "9247",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM219",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM219",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM217",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM218",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM218",
    "__PowerAppsId__": "84db4785-1849-487d-a255-70d8bec2d30c"
  },
  {
    "AA ID": "532928",
    "Last Name": "Reeves",
    "First Name": "Marguerite",
    "LN#": "9311",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1430-2300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1430-2300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1430-2300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1430-2300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1430-2300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "1184bc6a-9d29-480f-a338-5a3b40f7557a"
  },
  {
    "AA ID": "290046",
    "Last Name": "White",
    "First Name": "Marnise",
    "LN#": "9236",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM215",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM215",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM215",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM215",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM215",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "f8d296d0-a853-42fa-a304-edeaf87df861"
  },
  {
    "AA ID": "189045",
    "Last Name": "Rosario",
    "First Name": "Marteus",
    "LN#": "9272",
    "LineType": "Regular",
    "Monday": "0430-1300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0430-1300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0430-1300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0430-1300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "0430-1300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "873e71e6-6ce9-416f-b935-860039102924"
  },
  {
    "AA ID": "520014",
    "Last Name": "Devine",
    "First Name": "Martin",
    "LN#": "9302",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0500-1330",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "649a882c-63aa-4079-8d59-b90fbfdf1f7e"
  },
  {
    "AA ID": "539936",
    "Last Name": "Ebron",
    "First Name": "Marvin",
    "LN#": "9331",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0500-1330",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1330",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "bea17d6c-b735-49c6-b86e-aec7d09d6cce"
  },
  {
    "AA ID": "525163",
    "Last Name": "Wisnewski",
    "First Name": "Matt",
    "LN#": "9310",
    "LineType": "Regular",
    "Monday": "1430-2300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1430-2300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1430-2300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1430-2300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1430-2300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "4d56cfee-14f4-4977-bc84-cca24a09ff02"
  },
  {
    "AA ID": "902780",
    "Last Name": "Powell",
    "First Name": "Matthew",
    "LN#": "9237",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM216",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM216",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM216",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM216",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM216",
    "__PowerAppsId__": "7e1cef6c-908c-4996-9532-bcf1ee1e6cef"
  },
  {
    "AA ID": "192876",
    "Last Name": "Grace",
    "First Name": "Michael",
    "LN#": "9209",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM204",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM204",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM204",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM204",
    "Friday": "0500-1330",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM204",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "11c511ed-78b5-481d-b2f3-23b5eb3b22c1"
  },
  {
    "AA ID": "372320",
    "Last Name": "Regan",
    "First Name": "Michael",
    "LN#": "9212",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0600-1430",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM205",
    "Thursday": "0600-1430",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM205",
    "Friday": "0600-1430",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM205",
    "Saturday": "0600-1430",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM205",
    "Sunday": "0600-1430",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM205",
    "__PowerAppsId__": "3105f705-ec09-437c-b8bb-3bb43d92d7c5"
  },
  {
    "AA ID": "921086",
    "Last Name": "Ropski",
    "First Name": "Michael",
    "LN#": "9260",
    "LineType": "Regular",
    "Monday": "1400-2230",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM222",
    "Tuesday": "1400-2230",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM222",
    "Wednesday": "1400-2230",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM222",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1400-2230",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM223",
    "Sunday": "1400-2230",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM223",
    "__PowerAppsId__": "f8b1add6-eba5-4e8d-86c4-576b25f5077a"
  },
  {
    "AA ID": "537796",
    "Last Name": "Coen",
    "First Name": "Michael",
    "LN#": "9299",
    "LineType": "Regular",
    "Monday": "1200-2030",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1200-2030",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1200-2030",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1200-2030",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1200-2030",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "158a8450-9878-43fd-904b-d158259928f5"
  },
  {
    "AA ID": "544354",
    "Last Name": "Quintana",
    "First Name": "Miguel",
    "LN#": "9309",
    "LineType": "Regular",
    "Monday": "0600-1430",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0600-1430",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0600-1430",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0600-1430",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0600-1430",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "3e32411c-edcc-49aa-aeeb-480f4ddfbed8"
  },
  {
    "AA ID": "796858",
    "Last Name": "Ifthekar",
    "First Name": "Mohammed",
    "LN#": "9288",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "929cf1e3-0d0f-4dea-bcd4-61f52cb6fb9a"
  },
  {
    "AA ID": "767374",
    "Last Name": "Fardi",
    "First Name": "Mohsen",
    "LN#": "9330",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0500-1330",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0500-1330",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1330",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "b6b0bbf4-863b-4efd-97ff-3e3045a74404"
  },
  {
    "AA ID": "192942",
    "Last Name": "Smith",
    "First Name": "Montrel",
    "LN#": "9329",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0500-1330",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0500-1330",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "0ecc1507-7893-4edf-b226-7e4a477177ca"
  },
  {
    "AA ID": "354292",
    "Last Name": "Karneh",
    "First Name": "Mustapha",
    "LN#": "9323",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0500-1330",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1330",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "c31e5ed9-760d-4e39-bda4-6139f8d08c9d"
  },
  {
    "AA ID": "921070",
    "Last Name": "Morris",
    "First Name": "Natasha",
    "LN#": "9243",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM219",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM219",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM219",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM219",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM219",
    "__PowerAppsId__": "5b311361-4cff-4be6-9bdc-7112c83c6422"
  },
  {
    "AA ID": "351691",
    "Last Name": "Lewis",
    "First Name": "Nathaniel",
    "LN#": "9214",
    "LineType": "Regular",
    "Monday": "0600-1430",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM206",
    "Tuesday": "0600-1430",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM206",
    "Wednesday": "0600-1430",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM206",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0600-1430",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM206",
    "Sunday": "0600-1430",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM206",
    "__PowerAppsId__": "48cb99a3-8b31-4fc5-a444-bb26de75ec04"
  },
  {
    "AA ID": "485053",
    "Last Name": "Clarke",
    "First Name": "Nyoka",
    "LN#": "9317",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0500-1330",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1330",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "715619f1-f226-4d10-8763-b2416a0b299a"
  },
  {
    "AA ID": "190212",
    "Last Name": "Henderson",
    "First Name": "Patrick",
    "LN#": "9215",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0700-1530",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM207",
    "Wednesday": "0700-1530",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM207",
    "Thursday": "0700-1530",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM207",
    "Friday": "0700-1530",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM207",
    "Saturday": "0700-1530",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM207",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "553eade8-1438-4889-af5c-5d1a0b6fc216"
  },
  {
    "AA ID": "372571",
    "Last Name": "Wieland",
    "First Name": "Patrick",
    "LN#": "9278",
    "LineType": "Regular",
    "Monday": "0430-1300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0430-1300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0430-1300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0430-1300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "0430-1300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "015a109e-cb4a-4499-be8d-202e8bab4413"
  },
  {
    "AA ID": "540384",
    "Last Name": "Fullman",
    "First Name": "Quanzel",
    "LN#": "9294",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "0e034783-1b4e-4310-ab2a-76697e0ff325"
  },
  {
    "AA ID": "405592",
    "Last Name": "Odrick",
    "First Name": "Quentin",
    "LN#": "9208",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM203",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM203",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM203",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0500-1330",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM203",
    "Sunday": "0500-1330",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM203",
    "__PowerAppsId__": "ac03a0a1-9e6f-4e1e-8d50-ff2ddf67e1b9"
  },
  {
    "AA ID": "921056",
    "Last Name": "Hilton",
    "First Name": "Rakim",
    "LN#": "9344",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "8cbcb467-b932-4301-b298-7fb30499f5e6"
  },
  {
    "AA ID": "946460",
    "Last Name": "Lam",
    "First Name": "Ramon",
    "LN#": "9340",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "b74728e9-2543-4ea4-b547-3af6be26a559"
  },
  {
    "AA ID": "101916",
    "Last Name": "Smith",
    "First Name": "Rashaan",
    "LN#": "9201",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0300-1130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM200",
    "Wednesday": "0300-1130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM200",
    "Thursday": "0300-1130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM200",
    "Friday": "0300-1130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM200",
    "Saturday": "0300-1130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM200",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "41aa2ee2-e0c3-4c37-a1c2-dc43e9a7a005"
  },
  {
    "AA ID": "921072",
    "Last Name": "Negron",
    "First Name": "Raul",
    "LN#": "9262",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1400-2230",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM223",
    "Thursday": "1400-2230",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM223",
    "Friday": "1400-2230",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM223",
    "Saturday": "1400-2230",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM223",
    "Sunday": "1400-2230",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM223",
    "__PowerAppsId__": "d59ce3bf-474e-4898-b053-451fb3b97da1"
  },
  {
    "AA ID": "802955",
    "Last Name": "Santana-Reyes",
    "First Name": "Raylin",
    "LN#": "9284",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "5a88b8ed-8970-4f4e-a28c-54d4ff4b83e7"
  },
  {
    "AA ID": "493431",
    "Last Name": "Carroll",
    "First Name": "Rodney",
    "LN#": "9318",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0500-1330",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0500-1330",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1330",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "01f30799-3e70-43c0-8aa5-fe3c200e5bc1"
  },
  {
    "AA ID": "357947",
    "Last Name": "Coleman",
    "First Name": "Ronald",
    "LN#": "9273",
    "LineType": "Regular",
    "Monday": "0430-1300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0430-1300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0430-1300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0430-1300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0430-1300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "a2b4fbc3-30f2-491d-8485-812c5f39ff15"
  },
  {
    "AA ID": "471230",
    "Last Name": "Hicks",
    "First Name": "Ross",
    "LN#": "9287",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "c2c6fc5c-48bb-44cf-91be-55980181641f"
  },
  {
    "AA ID": "193409",
    "Last Name": "Burrell",
    "First Name": "Samiro",
    "LN#": "9203",
    "LineType": "Regular",
    "Monday": "0400-1230",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM201",
    "Tuesday": "0400-1230",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM201",
    "Wednesday": "0400-1230",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM201",
    "Thursday": "0400-1230",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM201",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "0400-1230",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM201",
    "__PowerAppsId__": "0d2f5e64-a02d-4582-87ba-4a65920006b1"
  },
  {
    "AA ID": "903246",
    "Last Name": "Stewart",
    "First Name": "Sammy",
    "LN#": "9289",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "041e4dd2-b1d5-4199-8070-a95e2bbe2dfe"
  },
  {
    "AA ID": "552916",
    "Last Name": "Graham",
    "First Name": "Sandra",
    "LN#": "9324",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1330-2200",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1330-2200",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1330-2200",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1330-2200",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1330-2200",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "2027dbe4-2598-4ead-bf74-e9d004441217"
  },
  {
    "AA ID": "387898",
    "Last Name": "Grill",
    "First Name": "Scott",
    "LN#": "9319",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "0500-1330",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0500-1330",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1330",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "4b2f7600-0ad2-473e-8912-59b14b7e8a90"
  },
  {
    "AA ID": "543678",
    "Last Name": "Haggerty",
    "First Name": "Scott",
    "LN#": "9334",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "0500-1330",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0500-1330",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1330",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "a24d204d-1105-44eb-b300-dab849ace1ac"
  },
  {
    "AA ID": "921059",
    "Last Name": "Tucker",
    "First Name": "Semaj",
    "LN#": "9248",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM219",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM219",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1300-2130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM217",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM218",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM218",
    "__PowerAppsId__": "1dda92d3-26a3-47e2-a078-a42eb286b90e"
  },
  {
    "AA ID": "953236",
    "Last Name": "James",
    "First Name": "Shaquille",
    "LN#": "9266",
    "LineType": "Regular",
    "Monday": "1400-2230",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM224",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1400-2230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1400-2230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1400-2230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1400-2230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "bae1962b-f3d3-4a01-9441-fbae31c975d3"
  },
  {
    "AA ID": "142629",
    "Last Name": "Robinson",
    "First Name": "Shauntayah",
    "LN#": "9335",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "0500-1330",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "fc4c750c-97a9-4e34-aea7-4e8c7bd94396"
  },
  {
    "AA ID": "902888",
    "Last Name": "Hudson",
    "First Name": "Shawn",
    "LN#": "9285",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "8496129c-ca33-4127-8371-07638f5b633c"
  },
  {
    "AA ID": "921085",
    "Last Name": "Sem",
    "First Name": "Sokhar",
    "LN#": "9257",
    "LineType": "Regular",
    "Monday": "1400-2230",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM221",
    "Tuesday": "1400-2230",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM221",
    "Wednesday": "1400-2230",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM221",
    "Thursday": "1400-2230",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM221",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1400-2230",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM222",
    "__PowerAppsId__": "39c15eeb-adfb-463e-b7fc-9a68993a0783"
  },
  {
    "AA ID": "553858",
    "Last Name": "Groover",
    "First Name": "Steafon",
    "LN#": "9296",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "2100-0530",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "2100-0530",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "2100-0530",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "2100-0530",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "2100-0530",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "67a23fe0-b748-4dd6-a9ae-4dbeb578427d"
  },
  {
    "AA ID": "712289",
    "Last Name": "George",
    "First Name": "Sunny",
    "LN#": "9202",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0300-1130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM200",
    "Wednesday": "0300-1130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM200",
    "Thursday": "0300-1130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM200",
    "Friday": "0300-1130",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM200",
    "Saturday": "0300-1130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM200",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "f7c56c2e-e032-4183-8bb2-053a67a822a3"
  },
  {
    "AA ID": "921052",
    "Last Name": "Su",
    "First Name": "Tac",
    "LN#": "9346",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1400-2230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1400-2230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1400-2230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1400-2230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1400-2230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "888fc06b-8a0d-4381-a8d1-bb621b16e40a"
  },
  {
    "AA ID": "217725",
    "Last Name": "Alkhalidi",
    "First Name": "Tahir",
    "LN#": "9349",
    "LineType": "Open Time",
    "Monday": "",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "e94b415d-8924-4e27-a168-55db71b4c0fc"
  },
  {
    "AA ID": "921074",
    "Last Name": "Eberhardt",
    "First Name": "Tameer",
    "LN#": "9234",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM214",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM214",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM214",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM214",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM214",
    "__PowerAppsId__": "c851208c-6cc5-4672-8c7d-3f3673fe8d59"
  },
  {
    "AA ID": "921090",
    "Last Name": "Davis-Simmons",
    "First Name": "Themene",
    "LN#": "9337",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "1ff4e546-4a6e-486e-b400-9bda6d47d1f1"
  },
  {
    "AA ID": "497739",
    "Last Name": "Jones",
    "First Name": "Timothy",
    "LN#": "9227",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1200-2030",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM210",
    "Wednesday": "1200-2030",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM210",
    "Thursday": "1200-2030",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM210",
    "Friday": "1200-2030",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM210",
    "Saturday": "1200-2030",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM210",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "8f0bbf3b-1db5-4d5d-839e-db201313dfb8"
  },
  {
    "AA ID": "341315",
    "Last Name": "Truong",
    "First Name": "Tony",
    "LN#": "9332",
    "LineType": "Regular",
    "Monday": "0500-1330",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0500-1330",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0500-1330",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0500-1330",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0500-1330",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "ead71ea4-b20b-4d63-a81e-60ebc672caef"
  },
  {
    "AA ID": "151095",
    "Last Name": "Rivera",
    "First Name": "Travelle",
    "LN#": "9320",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "874c113e-c0bf-44c2-8663-ad03c74aac52"
  },
  {
    "AA ID": "956540",
    "Last Name": "Newman",
    "First Name": "Tykeir",
    "LN#": "9256",
    "LineType": "Regular",
    "Monday": "1400-2230",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM221",
    "Tuesday": "1400-2230",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM221",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1400-2230",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM221",
    "Saturday": "1400-2230",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM221",
    "Sunday": "1400-2230",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM221",
    "__PowerAppsId__": "ed3878d9-774d-4d79-ac53-9fc499ddf21a"
  },
  {
    "AA ID": "150418",
    "Last Name": "Black",
    "First Name": "Tylill",
    "LN#": "9316",
    "LineType": "Regular",
    "Monday": "1430-2300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1430-2300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1430-2300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1430-2300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1430-2300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "8aaa95f2-44ab-40f5-bbdc-5258a13881e9"
  },
  {
    "AA ID": "921053",
    "Last Name": "Nelson",
    "First Name": "Unique",
    "LN#": "9239",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM217",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM217",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM217",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1300-2130",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM217",
    "Sunday": "1300-2130",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM217",
    "__PowerAppsId__": "0b48dcba-4625-4d93-9134-da8beebab9bf"
  },
  {
    "AA ID": "420239",
    "Last Name": "Thompson-Nelson",
    "First Name": "Veronica",
    "LN#": "9293",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "b8fa3f8e-eee6-40c9-b582-cadc46a98526"
  },
  {
    "AA ID": "786398",
    "Last Name": "Antwi",
    "First Name": "Victor",
    "LN#": "9258",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1400-2230",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM222",
    "Wednesday": "1400-2230",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM222",
    "Thursday": "1400-2230",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM222",
    "Friday": "1400-2230",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM222",
    "Saturday": "1400-2230",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM222",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "63888de4-65b0-438d-b3db-b0beb580de92"
  },
  {
    "AA ID": "166884",
    "Last Name": "D'alessandro",
    "First Name": "Victor",
    "LN#": "9308",
    "LineType": "Regular",
    "Monday": "0600-1430",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0600-1430",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0600-1430",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0600-1430",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0600-1430",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "b21b19cd-1678-41c0-90fb-88ad0d97d98c"
  },
  {
    "AA ID": "777030",
    "Last Name": "Doloson",
    "First Name": "Wellington",
    "LN#": "9223",
    "LineType": "Variable",
    "Monday": "0600-1430",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0600-1430",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM206",
    "Friday": "0600-1430",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM206",
    "Saturday": "0500-1330",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM204",
    "Sunday": "0500-1330",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM204",
    "__PowerAppsId__": "ab1b1a6b-dbb6-402e-88a6-21f1f9b3863b"
  },
  {
    "AA ID": "432752",
    "Last Name": "Thompson",
    "First Name": "Wilbert",
    "LN#": "9295",
    "LineType": "Regular",
    "Monday": "2100-0530",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "2100-0530",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "2100-0530",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "2100-0530",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "2100-0530",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "3744556b-b255-4d29-b8ed-c8f0b155e527"
  },
  {
    "AA ID": "771155",
    "Last Name": "Kessler",
    "First Name": "William",
    "LN#": "9279",
    "LineType": "Regular",
    "Monday": "0430-1300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0430-1300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0430-1300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0430-1300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0430-1300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "b6cb1fd3-4149-4b78-9d09-eae501198b88"
  },
  {
    "AA ID": "921050",
    "Last Name": "McLaughlin",
    "First Name": "Wynter",
    "LN#": "9341",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1300-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "dff13604-a644-4069-ab07-0c4ad3993f96"
  },
  {
    "AA ID": "790025",
    "Last Name": "Young",
    "First Name": "YaKiera",
    "LN#": "9291",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1300-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "68adf782-fbae-4fb9-833e-90deb885ade1"
  },
  {
    "AA ID": "132940",
    "Last Name": "Young",
    "First Name": "Yvette",
    "LN#": "9274",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0430-1300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0430-1300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0430-1300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0430-1300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0430-1300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "581c9b61-65d1-48ac-b9a3-3119a69f1e2e"
  },
  {
    "AA ID": "433608",
    "Last Name": "Thomas",
    "First Name": "Yvette",
    "LN#": "9290",
    "LineType": "Regular",
    "Monday": "1300-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1300-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1300-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1300-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1300-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "02c57e1f-8b04-449e-9c39-8bd4f02a3d87"
  }
];

const EMBEDDED_PT_DATA = [
  {
    "AA ID": "804352",
    "Last Name": "Byrd",
    "First Name": "Juwan",
    "LN #": "9501",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0500-1100",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM100",
    "Thursday": "0500-1100",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM100",
    "Friday": "0500-1100",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM100",
    "Saturday": "0500-1100",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM100",
    "Sunday": "0500-1100",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM100",
    "__PowerAppsId__": "b0fec253-3e78-4ebf-bc9f-25458ab0af44"
  },
  {
    "AA ID": "384846",
    "Last Name": "Hardnett",
    "First Name": "Charlene",
    "LN #": "9502",
    "LineType": "Regular",
    "Monday": "0500-1100",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM100",
    "Tuesday": "0500-1100",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM100",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "0500-1100",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM100",
    "Saturday": "0500-1100",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM100",
    "Sunday": "0500-1100",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM100",
    "__PowerAppsId__": "20eed17c-a43f-4f54-a4dd-ebf55ecdaff5"
  },
  {
    "AA ID": "569593",
    "Last Name": "Stevens",
    "First Name": "Michael",
    "LN #": "9503",
    "LineType": "Regular",
    "Monday": "0500-1100",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM100",
    "Tuesday": "0500-1100",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM100",
    "Wednesday": "0500-1100",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM100",
    "Thursday": "0500-1100",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM100",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "0500-1100",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM101",
    "__PowerAppsId__": "41da075c-e422-4059-beb7-1e2a3083314c"
  },
  {
    "AA ID": "216865",
    "Last Name": "Whitfield",
    "First Name": "Jasmine",
    "LN #": "9504",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0500-1100",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM101",
    "Wednesday": "0500-1100",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM101",
    "Thursday": "0500-1100",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM101",
    "Friday": "0500-1100",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM101",
    "Saturday": "0500-1100",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM101",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "cb64762b-9150-47ae-acd0-9d73f516f633"
  },
  {
    "AA ID": "803931",
    "Last Name": "Williams",
    "First Name": "Tenille",
    "LN #": "9505",
    "LineType": "Regular",
    "Monday": "0500-1100",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM101",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0500-1100",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM101",
    "Friday": "0500-1100",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM101",
    "Saturday": "0500-1100",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM101",
    "Sunday": "0500-1100",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM101",
    "__PowerAppsId__": "52c0c52d-9c0e-4c84-bc49-2a0be476ee49"
  },
  {
    "AA ID": "296353",
    "Last Name": "Marchetti-Mercer",
    "First Name": "Samantha",
    "LN #": "9506",
    "LineType": "Regular",
    "Monday": "0500-1100",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM101",
    "Tuesday": "0500-1100",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM101",
    "Wednesday": "0500-1100",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM101",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0500-1100",
    "Sat Department": "U00 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1100",
    "Sun Department": "U00 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "434d2a9c-866b-4c23-9c9d-0f6bb72ed8f4"
  },
  {
    "AA ID": "646638",
    "Last Name": "Ellison",
    "First Name": "Christopher",
    "LN #": "9507",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0800-1400",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM102",
    "Thursday": "0800-1400",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM102",
    "Friday": "0800-1400",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM102",
    "Saturday": "0800-1400",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM102",
    "Sunday": "0800-1400",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM102",
    "__PowerAppsId__": "e413c651-a1a7-43bb-ae07-8090fe6a503f"
  },
  {
    "AA ID": "282697",
    "Last Name": "Johnson",
    "First Name": "Stephen",
    "LN #": "9508",
    "LineType": "Regular",
    "Monday": "0800-1400",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM102",
    "Tuesday": "0800-1400",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM102",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "0800-1400",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM102",
    "Saturday": "0800-1400",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM102",
    "Sunday": "0800-1400",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM102",
    "__PowerAppsId__": "3198fed5-9605-420a-974d-d5527f321400"
  },
  {
    "AA ID": "241546",
    "Last Name": "Atkinson",
    "First Name": "Adrian",
    "LN #": "9509",
    "LineType": "Regular",
    "Monday": "0800-1400",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM102",
    "Tuesday": "0800-1400",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM102",
    "Wednesday": "0800-1400",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM102",
    "Thursday": "0800-1400",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM102",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "0800-1400",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM103",
    "__PowerAppsId__": "0058857b-b4f7-413d-8d8f-d0fcf4cb4c8a"
  },
  {
    "AA ID": "562349",
    "Last Name": "Gomez",
    "First Name": "Kimberly",
    "LN #": "9510",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0800-1400",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM103",
    "Wednesday": "0800-1400",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM103",
    "Thursday": "0800-1400",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM103",
    "Friday": "0800-1400",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM103",
    "Saturday": "0800-1400",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM103",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "6ec44e7d-80b9-4841-beda-556661e66afe"
  },
  {
    "AA ID": "952387",
    "Last Name": "McIntosh",
    "First Name": "Abegale",
    "LN #": "9511",
    "LineType": "Regular",
    "Monday": "0800-1400",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM103",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0800-1400",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM103",
    "Friday": "0800-1400",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM103",
    "Saturday": "0800-1400",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM103",
    "Sunday": "0800-1400",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM103",
    "__PowerAppsId__": "fc46e45e-0fff-4813-b424-17f0cf1c054f"
  },
  {
    "AA ID": "296945",
    "Last Name": "Howard",
    "First Name": "Katrina",
    "LN #": "9512",
    "LineType": "Regular",
    "Monday": "0800-1400",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM103",
    "Tuesday": "0800-1400",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM103",
    "Wednesday": "0800-1400",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM103",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0800-1400",
    "Sat Department": "U00 CAT",
    "Sat Team": "FSA",
    "Sunday": "0800-1400",
    "Sun Department": "U00 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "6774ea08-5418-4d13-9d24-69a9062f0fdc"
  },
  {
    "AA ID": "297908",
    "Last Name": "Williams",
    "First Name": "Asia",
    "LN #": "9513",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1400-2000",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM104",
    "Wednesday": "1400-2000",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM104",
    "Thursday": "1400-2000",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM104",
    "Friday": "1400-2000",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM104",
    "Saturday": "1400-2000",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM104",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "e3d52d9d-b9d7-423c-a71d-ee49c9128c77"
  },
  {
    "AA ID": "271553",
    "Last Name": "Gilliard",
    "First Name": "Curtis",
    "LN #": "9514",
    "LineType": "Regular",
    "Monday": "1400-2000",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM104",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1400-2000",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM104",
    "Friday": "1400-2000",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM104",
    "Saturday": "1400-2000",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM104",
    "Sunday": "1400-2000",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM104",
    "__PowerAppsId__": "509b1002-21c2-47b6-9b25-424cc61fea98"
  },
  {
    "AA ID": "956545",
    "Last Name": "Porter",
    "First Name": "Brandon",
    "LN #": "9515",
    "LineType": "Regular",
    "Monday": "1400-2000",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM104",
    "Tuesday": "1400-2000",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM104",
    "Wednesday": "1400-2000",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM104",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1400-2000",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM105",
    "Sunday": "1400-2000",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM104",
    "__PowerAppsId__": "760523ed-7b04-45d2-8ab4-82872bb4ba5d"
  },
  {
    "AA ID": "956560",
    "Last Name": "Chambers",
    "First Name": "Richard",
    "LN #": "9516",
    "LineType": "Regular",
    "Monday": "1400-2000",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM105",
    "Tuesday": "1400-2000",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM105",
    "Wednesday": "1400-2000",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM105",
    "Thursday": "1400-2000",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM105",
    "Friday": "1400-2000",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM105",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "dabd5fc4-81c1-42c1-a233-b88b5faac086"
  },
  {
    "AA ID": "956551",
    "Last Name": "Bost",
    "First Name": "Lahmar",
    "LN #": "9517",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1400-2000",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM105",
    "Thursday": "1400-2000",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM105",
    "Friday": "1400-2000",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM105",
    "Saturday": "1400-2000",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM105",
    "Sunday": "1400-2000",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM105",
    "__PowerAppsId__": "5e8a2339-aef6-4ab1-9fd5-195fcba454a4"
  },
  {
    "AA ID": "955304",
    "Last Name": "Wells",
    "First Name": "Reginald",
    "LN #": "9518",
    "LineType": "Regular",
    "Monday": "1400-2000",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM105",
    "Tuesday": "1400-2000",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM105",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1400-2000",
    "Fri Department": "U00 CAT",
    "Fri Team": "FSA",
    "Saturday": "1400-2000",
    "Sat Department": "U00 CAT",
    "Sat Team": "FSA",
    "Sunday": "1400-2000",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM105",
    "__PowerAppsId__": "068df0ab-e8a3-4b72-97cf-a2e7a624e6ec"
  },
  {
    "AA ID": "956559",
    "Last Name": "Chamaq",
    "First Name": "Soulaimane",
    "LN #": "9520",
    "LineType": "Regular",
    "Monday": "1500-2100",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM106",
    "Tuesday": "1500-2100",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM106",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1500-2100",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM106",
    "Saturday": "1500-2100",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM106",
    "Sunday": "1500-2100",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM106",
    "__PowerAppsId__": "68ef0c7f-be2c-44f9-99ba-2758f13526ea"
  },
  {
    "AA ID": "595289",
    "Last Name": "Hayes",
    "First Name": "Amanda",
    "LN #": "9521",
    "LineType": "Regular",
    "Monday": "1500-2100",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM106",
    "Tuesday": "1500-2100",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM106",
    "Wednesday": "1500-2100",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM106",
    "Thursday": "1500-2100",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM106",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1500-2100",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM107",
    "__PowerAppsId__": "f5c74cc2-15e9-4a7a-bfac-cf3413136cdd"
  },
  {
    "AA ID": "956543",
    "Last Name": "Wagenblast",
    "First Name": "Alanna",
    "LN #": "9522",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1500-2100",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM107",
    "Wednesday": "1500-2100",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM107",
    "Thursday": "1500-2100",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM107",
    "Friday": "1500-2100",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM107",
    "Saturday": "1500-2100",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM107",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "648a9048-b299-4d67-a91c-ac44fbd12637"
  },
  {
    "AA ID": "952396",
    "Last Name": "Ross",
    "First Name": "Kenesha",
    "LN #": "9524",
    "LineType": "Regular",
    "Monday": "1500-2100",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM107",
    "Tuesday": "1500-2100",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM107",
    "Wednesday": "1500-2100",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM107",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1500-2100",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1500-2100",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "baed2bab-8e1d-419c-b121-5b1dd6ed4336"
  },
  {
    "AA ID": "955300",
    "Last Name": "Morris",
    "First Name": "Naya",
    "LN #": "9525",
    "LineType": "Regular",
    "Monday": "1500-2100",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM108",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1500-2100",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM108",
    "Friday": "1500-2100",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM108",
    "Saturday": "1500-2100",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM108",
    "Sunday": "1500-2100",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM108",
    "__PowerAppsId__": "a195fd32-51cd-44c2-9d27-3f62c59d51ed"
  },
  {
    "AA ID": "899217",
    "Last Name": "Simms",
    "First Name": "Ellis",
    "LN #": "9526",
    "LineType": "Regular",
    "Monday": "1500-2100",
    "Mon Department": "U30 TRK",
    "Mon Team": "TM108",
    "Tuesday": "1500-2100",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM108",
    "Wednesday": "1500-2100",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM108",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1500-2100",
    "Sat Department": "U30 TRK",
    "Sat Team": "TM108",
    "Sunday": "1500-2100",
    "Sun Department": "U30 TRK",
    "Sun Team": "TM108",
    "__PowerAppsId__": "12234f6d-b8f8-4a73-8ae1-ea4f584915cf"
  },
  {
    "AA ID": "956548",
    "Last Name": "Debose",
    "First Name": "Zakhi",
    "LN #": "9527",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1500-2100",
    "Tues Department": "U30 TRK",
    "Tues Team": "TM108",
    "Wednesday": "1500-2100",
    "Wed Department": "U30 TRK",
    "Wed Team": "TM108",
    "Thursday": "1500-2100",
    "Thurs Department": "U30 TRK",
    "Thurs Team": "TM108",
    "Friday": "1500-2100",
    "Fri Department": "U30 TRK",
    "Fri Team": "TM108",
    "Saturday": "1500-2100",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "bf2a6941-6ca2-4179-8f35-9965af4fadab"
  },
  {
    "AA ID": "474390",
    "Last Name": "Lewis",
    "First Name": "Tamika",
    "LN #": "9528",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "2300-0500",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM110",
    "Wednesday": "2300-0500",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM110",
    "Thursday": "2300-0500",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM110",
    "Friday": "2300-0500",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM110",
    "Saturday": "2300-0500",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM110",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "77568e95-a925-4deb-9759-1a7e7d26c513"
  },
  {
    "AA ID": "466100",
    "Last Name": "Powell",
    "First Name": "Joseph",
    "LN #": "9529",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "2300-0500",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM110",
    "Wednesday": "2300-0500",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM110",
    "Thursday": "2300-0500",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM110",
    "Friday": "2300-0500",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM110",
    "Saturday": "2300-0500",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM110",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "f22382f7-7fb0-47e5-8b17-328559175231"
  },
  {
    "AA ID": "563820",
    "Last Name": "Boyle",
    "First Name": "Hugh",
    "LN #": "9530",
    "LineType": "Regular",
    "Monday": "2300-0500",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM111",
    "Tuesday": "2300-0500",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM111",
    "Wednesday": "2300-0500",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM111",
    "Thursday": "2300-0500",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM111",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "2300-0500",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM111",
    "__PowerAppsId__": "7f5b8bce-26c6-4da3-bae0-72394076eb7c"
  },
  {
    "AA ID": "464032",
    "Last Name": "Mcbride",
    "First Name": "Joseph",
    "LN #": "9531",
    "LineType": "Regular",
    "Monday": "2300-0500",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM111",
    "Tuesday": "2300-0500",
    "Tues Department": "U00 TRK",
    "Tues Team": "TM111",
    "Wednesday": "2300-0500",
    "Wed Department": "U00 TRK",
    "Wed Team": "TM111",
    "Thursday": "2300-0500",
    "Thurs Department": "U00 TRK",
    "Thurs Team": "TM111",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "2300-0500",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM111",
    "__PowerAppsId__": "e68d3790-bbd6-4be0-a486-252a2dfcd7d8"
  },
  {
    "AA ID": "955502",
    "Last Name": "Jackson",
    "First Name": "Kevin",
    "LN #": "9532",
    "LineType": "Regular",
    "Monday": "2300-0500",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM110",
    "Tuesday": "2300-0500",
    "Tues Department": "U00 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "2300-0500",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM111",
    "Saturday": "2300-0500",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM111",
    "Sunday": "2300-0500",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM110",
    "__PowerAppsId__": "d16b45bb-b682-44f2-a413-db037e1d8608"
  },
  {
    "AA ID": "539638",
    "Last Name": "Valcarcel",
    "First Name": "Angel",
    "LN #": "9533",
    "LineType": "Regular",
    "Monday": "2300-0500",
    "Mon Department": "U00 TRK",
    "Mon Team": "TM110",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "2300-0500",
    "Thurs Department": "U00 CAT",
    "Thurs Team": "FSA",
    "Friday": "2300-0500",
    "Fri Department": "U00 TRK",
    "Fri Team": "TM111",
    "Saturday": "2300-0500",
    "Sat Department": "U00 TRK",
    "Sat Team": "TM111",
    "Sunday": "2300-0500",
    "Sun Department": "U00 TRK",
    "Sun Team": "TM111",
    "__PowerAppsId__": "8c432993-13a5-4563-b552-cdd13bbe1a0e"
  },
  {
    "AA ID": "766925",
    "Last Name": "Colburn",
    "First Name": "Shante",
    "LN #": "9534",
    "LineType": "Regular",
    "Monday": "0600-1200",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0600-1200",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "0600-1200",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0600-1200",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0600-1200",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "f308886a-5023-47f3-9533-ee237493d7a6"
  },
  {
    "AA ID": "546097",
    "Last Name": "Anderson",
    "First Name": "Chelsey",
    "LN #": "9535",
    "LineType": "Regular",
    "Monday": "0600-1200",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0600-1200",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0600-1200",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0600-1200",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "0600-1200",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "cbf616d5-6e71-49a4-861e-447f2efc1bc5"
  },
  {
    "AA ID": "774349",
    "Last Name": "Brown",
    "First Name": "Jeffrey",
    "LN #": "9536",
    "LineType": "Variable",
    "Monday": "0900-1500",
    "Mon Department": "U00 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0900-1500",
    "Tues Department": "U00 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0600-1200",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "0600-1200",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0600-1200",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "fe911cc8-f0d2-46a6-ae70-2f6290cdc72a"
  },
  {
    "AA ID": "184578",
    "Last Name": "Smith",
    "First Name": "Lennox",
    "LN #": "9537",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0600-1200",
    "Tues Department": "U00 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0600-1200",
    "Wed Department": "U00 CAT",
    "Wed Team": "FSA",
    "Thursday": "0600-1200",
    "Thurs Department": "U00 CAT",
    "Thurs Team": "FSA",
    "Friday": "0600-1200",
    "Fri Department": "U00 CAT",
    "Fri Team": "FSA",
    "Saturday": "0600-1200",
    "Sat Department": "U00 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "8ca154de-8360-4231-a7c6-b92b78fcbc08"
  },
  {
    "AA ID": "774880",
    "Last Name": "Bryant",
    "First Name": "Aisha",
    "LN #": "9538",
    "LineType": "Regular",
    "Monday": "0600-1200",
    "Mon Department": "U00 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0600-1200",
    "Thurs Department": "U00 CAT",
    "Thurs Team": "FSA",
    "Friday": "0600-1200",
    "Fri Department": "U00 CAT",
    "Fri Team": "FSA",
    "Saturday": "0600-1200",
    "Sat Department": "U00 CAT",
    "Sat Team": "FSA",
    "Sunday": "0600-1200",
    "Sun Department": "U00 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "cb4be1b1-7c9c-417a-b6dd-b07d7a88d98f"
  },
  {
    "AA ID": "472302",
    "Last Name": "Robinson",
    "First Name": "William",
    "LN #": "9539",
    "LineType": "Regular",
    "Monday": "0600-1200",
    "Mon Department": "U00 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0600-1200",
    "Tues Department": "U00 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0600-1200",
    "Wed Department": "U00 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0600-1200",
    "Sat Department": "U00 CAT",
    "Sat Team": "FSA",
    "Sunday": "0600-1200",
    "Sun Department": "U00 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "a78b1870-6a51-481b-8c67-cde0f8a0caa2"
  },
  {
    "AA ID": "777450",
    "Last Name": "Robinson",
    "First Name": "Julius",
    "LN #": "9540",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "0900-1500",
    "Wed Department": "U00 CAT",
    "Wed Team": "FSA",
    "Thursday": "0900-1500",
    "Thurs Department": "U00 CAT",
    "Thurs Team": "FSA",
    "Friday": "0900-1500",
    "Fri Department": "U00 CAT",
    "Fri Team": "FSA",
    "Saturday": "0900-1500",
    "Sat Department": "U00 CAT",
    "Sat Team": "FSA",
    "Sunday": "0900-1500",
    "Sun Department": "U00 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "06465fda-35dd-4331-ba38-2a6ecd330da6"
  },
  {
    "AA ID": "763361",
    "Last Name": "Wright",
    "First Name": "Julius",
    "LN #": "9541",
    "LineType": "Regular",
    "Monday": "1530-2130",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1530-2130",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1530-2130",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1530-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "1530-2130",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "42bf8045-5809-4896-bf49-7611d886e601"
  },
  {
    "AA ID": "956546",
    "Last Name": "Yudo",
    "First Name": "Satrio",
    "LN #": "9542",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1700-2300",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1700-2300",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1700-2300",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1700-2300",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1700-2300",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "5ce84974-e5a8-4ca8-b50a-88f43b83f27f"
  },
  {
    "AA ID": "251124",
    "Last Name": "Cherkas",
    "First Name": "Robert",
    "LN #": "9543",
    "LineType": "Regular",
    "Monday": "1400-2000",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1400-2000",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1400-2000",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1400-2000",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1400-2000",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "676de637-df81-4f59-b6b1-c6667a2214e6"
  },
  {
    "AA ID": "384720",
    "Last Name": "Coleman",
    "First Name": "Jerron",
    "LN #": "9544",
    "LineType": "Regular",
    "Monday": "1400-2000",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1400-2000",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1400-2000",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "1400-2000",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1400-2000",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "faceb90e-55f2-4237-95b4-9717dabd2df5"
  },
  {
    "AA ID": "730605",
    "Last Name": "Douglas-Edwards",
    "First Name": "Monica",
    "LN #": "9545",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "1400-2000",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "1400-2000",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1400-2000",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1400-2000",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1400-2000",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "d88c3588-45db-4afc-8aca-82b9439b9687"
  },
  {
    "AA ID": "956544",
    "Last Name": "Finney",
    "First Name": "Lathon",
    "LN #": "9546",
    "LineType": "Variable",
    "Monday": "1700-2300",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "1530-2130",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1530-2130",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1530-2130",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1700-2300",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "8f1db944-00d4-41c5-8abc-d59c27dca156"
  },
  {
    "AA ID": "398036",
    "Last Name": "Crump",
    "First Name": "Naomi",
    "LN #": "9547",
    "LineType": "Regular",
    "Monday": "0500-1100",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0500-1100",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0500-1100",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0500-1100",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1100",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "3436c5dd-58b0-45d6-945d-9a2939742825"
  },
  {
    "AA ID": "765679",
    "Last Name": "Augusta",
    "First Name": "Jasmine",
    "LN #": "9548",
    "LineType": "Regular",
    "Monday": "0500-1100",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0500-1100",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "0500-1100",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "0500-1100",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1100",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "532be8d5-c0e0-4ab2-8e01-1e1595b938e4"
  },
  {
    "AA ID": "951079",
    "Last Name": "Carson",
    "First Name": "Merecedes",
    "LN #": "9549",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "1400-2000",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "1400-2000",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "1400-2000",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1400-2000",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1400-2000",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "13e6e199-882c-42fc-9d48-a763ffb69611"
  },
  {
    "AA ID": "209825",
    "Last Name": "Houston",
    "First Name": "Sonora",
    "LN #": "9550",
    "LineType": "Regular",
    "Monday": "1400-2000",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "1400-2000",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "1400-2000",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "1400-2000",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "1400-2000",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "2c70b332-c72d-4795-bd03-21344a90a596"
  },
  {
    "AA ID": "392805",
    "Last Name": "Stevenson",
    "First Name": "Morris",
    "LN #": "9551",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "0500-1100",
    "Tues Department": "U00 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0500-1100",
    "Wed Department": "U00 CAT",
    "Wed Team": "FSA",
    "Thursday": "0500-1100",
    "Thurs Department": "U00 CAT",
    "Thurs Team": "FSA",
    "Friday": "0500-1100",
    "Fri Department": "U00 CAT",
    "Fri Team": "FSA",
    "Saturday": "0500-1100",
    "Sat Department": "U00 CAT",
    "Sat Team": "FSA",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "22390c82-3aa6-441a-a69d-6bd84b435826"
  },
  {
    "AA ID": "220577",
    "Last Name": "Merritt",
    "First Name": "Charles",
    "LN #": "9552",
    "LineType": "Regular",
    "Monday": "0500-1100",
    "Mon Department": "U00 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "0500-1100",
    "Thurs Department": "U00 CAT",
    "Thurs Team": "FSA",
    "Friday": "0500-1100",
    "Fri Department": "U00 CAT",
    "Fri Team": "FSA",
    "Saturday": "0500-1100",
    "Sat Department": "U00 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1100",
    "Sun Department": "U00 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "6ef80eb5-963b-4f38-8a0c-57769c52c9dc"
  },
  {
    "AA ID": "802047",
    "Last Name": "Kiros",
    "First Name": "Robel",
    "LN #": "9553",
    "LineType": "Regular",
    "Monday": "0500-1100",
    "Mon Department": "U00 CAT",
    "Mon Team": "FSA",
    "Tuesday": "0500-1100",
    "Tues Department": "U00 CAT",
    "Tues Team": "FSA",
    "Wednesday": "0500-1100",
    "Wed Department": "U00 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "0500-1100",
    "Sat Department": "U00 CAT",
    "Sat Team": "FSA",
    "Sunday": "0500-1100",
    "Sun Department": "U00 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "49f5297d-5d99-4696-a128-bdc7bda85616"
  },
  {
    "AA ID": "715177",
    "Last Name": "Martin",
    "First Name": "Marcellious",
    "LN #": "9554",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "2130-0230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "2130-0230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "2130-0230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "2130-0230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "2130-0230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "c699879c-5b2c-4f33-98ee-31f762894982"
  },
  {
    "AA ID": "767107",
    "Last Name": "Davenport",
    "First Name": "Isaiah",
    "LN #": "9555",
    "LineType": "Regular",
    "Monday": "2130-0230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "2130-0230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "2130-0230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "2130-0230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "2130-0230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "f3981c53-e96c-4629-bd63-62e639383397"
  },
  {
    "AA ID": "316110",
    "Last Name": "Mattison",
    "First Name": "Aharon",
    "LN #": "9556",
    "LineType": "Regular",
    "Monday": "2130-0230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "2130-0230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "2130-0230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "2130-0230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "2130-0230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "67dc0709-a483-408b-8f4c-5346c68f47ec"
  },
  {
    "AA ID": "376309",
    "Last Name": "Fosque",
    "First Name": "Terrance",
    "LN #": "9557",
    "LineType": "Regular",
    "Monday": "2130-0230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "2130-0230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "2130-0230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "2130-0230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "2130-0230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "bf2e24e1-5cf3-4737-a7a2-72be51ca5fde"
  },
  {
    "AA ID": "722887",
    "Last Name": "Oxendine",
    "First Name": "Brianna",
    "LN #": "9558",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "2130-0230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "2130-0230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "2130-0230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "2130-0230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "2130-0230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "2150e4dc-917f-4dd1-9b36-bfb27e8f6ac1"
  },
  {
    "AA ID": "268217",
    "Last Name": "Derrell",
    "First Name": "Sophia",
    "LN #": "9559",
    "LineType": "Regular",
    "Monday": "2130-0230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "2130-0230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "2130-0230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "2130-0230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "2130-0230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "6461f0ea-90d5-4629-a231-979d5acfb61b"
  },
  {
    "AA ID": "774945",
    "Last Name": "Brooks",
    "First Name": "Lamar",
    "LN #": "9560",
    "LineType": "Regular",
    "Monday": "2130-0230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "2130-0230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "2130-0230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "2130-0230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "2130-0230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "c73cde0e-c2a3-4b08-b1fe-66aee7fc09c0"
  },
  {
    "AA ID": "773597",
    "Last Name": "Mcdaniel",
    "First Name": "Ryan",
    "LN #": "9561",
    "LineType": "Regular",
    "Monday": "2130-0230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "2130-0230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "2130-0230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "2130-0230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "2130-0230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "Off",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "58cd4acb-128b-4a1b-a07f-890989804662"
  },
  {
    "AA ID": "610798",
    "Last Name": "Mirza",
    "First Name": "Sharaf",
    "LN #": "9562",
    "LineType": "Regular",
    "Monday": "Off",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "Off",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "2130-0230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "2130-0230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "2130-0230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "2130-0230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "2130-0230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "ab00f004-a856-4a2a-8788-aaf061f9ac58"
  },
  {
    "AA ID": "730060",
    "Last Name": "Pearson",
    "First Name": "Latia",
    "LN #": "9563",
    "LineType": "Regular",
    "Monday": "2130-0230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "2130-0230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "Off",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "Off",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "2130-0230",
    "Fri Department": "U30 CAT",
    "Fri Team": "FSA",
    "Saturday": "2130-0230",
    "Sat Department": "U30 CAT",
    "Sat Team": "FSA",
    "Sunday": "2130-0230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "03a6d9e1-7a11-4ea4-b2d4-db6315f67561"
  },
  {
    "AA ID": "709076",
    "Last Name": "Fisher",
    "First Name": "Jenaya",
    "LN #": "9564",
    "LineType": "Regular",
    "Monday": "2130-0230",
    "Mon Department": "U30 CAT",
    "Mon Team": "FSA",
    "Tuesday": "2130-0230",
    "Tues Department": "U30 CAT",
    "Tues Team": "FSA",
    "Wednesday": "2130-0230",
    "Wed Department": "U30 CAT",
    "Wed Team": "FSA",
    "Thursday": "2130-0230",
    "Thurs Department": "U30 CAT",
    "Thurs Team": "FSA",
    "Friday": "Off",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "Off",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "2130-0230",
    "Sun Department": "U30 CAT",
    "Sun Team": "FSA",
    "__PowerAppsId__": "11ba226e-31e9-4446-ace7-f2ed1fbcbb7d"
  },
  {
    "AA ID": "952393",
    "Last Name": "McDaniels",
    "First Name": "Vania",
    "LN #": "9565",
    "LineType": "Open Time",
    "Monday": "",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "65fd6176-9596-42b3-8050-700951351146"
  },
  {
    "AA ID": "956562",
    "Last Name": "Burton",
    "First Name": "Ricardo",
    "LN #": "9566",
    "LineType": "Open Time",
    "Monday": "",
    "Mon Department": "",
    "Mon Team": "",
    "Tuesday": "",
    "Tues Department": "",
    "Tues Team": "",
    "Wednesday": "",
    "Wed Department": "",
    "Wed Team": "",
    "Thursday": "",
    "Thurs Department": "",
    "Thurs Team": "",
    "Friday": "",
    "Fri Department": "",
    "Fri Team": "",
    "Saturday": "",
    "Sat Department": "",
    "Sat Team": "",
    "Sunday": "",
    "Sun Department": "",
    "Sun Team": "",
    "__PowerAppsId__": "55b84db5-5bde-42cb-aa35-dcae46490f7d"
  }
];


        // Global data storage
        let ftAgentsData = null;
        let ptAgentsData = null;
        let flightsData = null;
        let scheduleResult = null;

        // Auto-load embedded agent data
        ftAgentsData = EMBEDDED_FT_DATA;
        ptAgentsData = EMBEDDED_PT_DATA;
        console.log(`‚úì Loaded ${ftAgentsData.length} FT agents and ${ptAgentsData.length} PT agents from embedded data`);
        
        // NOTE: Flight data is now loaded from CSV preprocessing in Step 1
        // No manual flight CSV upload needed
        
        // Day of week change handler
        document.getElementById('dayOfWeek').addEventListener('change', () => {
            checkReadyToGenerate();
            console.log('‚úì Day of week selected:', document.getElementById('dayOfWeek').value);
        });

        // OLD FILE UPLOAD HANDLER REMOVED - Now using CSV preprocessing
        // Flight data comes from processFlightData() in Step 1

        function checkReadyToGenerate() {
            const daySelected = document.getElementById('dayOfWeek').value !== '';
            const ready = ftAgentsData && ptAgentsData && flightsData && daySelected;
            document.getElementById('generateBtn').disabled = !ready;
            
            // Show ready status
            if (ftAgentsData && ptAgentsData && !flightsData) {
                console.log('‚úì Agent data loaded. Waiting for flight schedule from Step 1...');
            }
            if (ftAgentsData && ptAgentsData && flightsData && !daySelected) {
                console.log('‚úì Data loaded. Please select a day of week...');
            }
        }
        
        // Auto-check on load and setup event listeners
        window.addEventListener('DOMContentLoaded', () => {
            checkReadyToGenerate();
            
            // Set up generate button listener
            const generateBtn = document.getElementById('generateBtn');
            if (generateBtn) {
                generateBtn.addEventListener('click', generateSchedule);
                console.log('‚úì Generate button listener attached');
            } else {
                console.error('Generate button not found!');
            }
            
            // Set up export button listener
            const exportBtn = document.getElementById('exportBtn');
            if (exportBtn) {
                exportBtn.addEventListener('click', exportToExcel);
                console.log('‚úì Export button listener attached');
            } else {
                console.error('Export button not found!');
            }
        });

        function generateSchedule() {
            console.log('=== Generate Schedule Clicked ===');
            
            // Validate that we have all required data
            if (!flightsData || flightsData.length === 0) {
                alert('‚ö†Ô∏è No flight data loaded. Please process flight data in Step 1 first.');
                console.error('Cannot generate schedule: No flight data');
                return;
            }
            
            if (!ftAgentsData || !ptAgentsData) {
                alert('‚ö†Ô∏è Agent data not loaded. This should be automatic - please refresh the page.');
                console.error('Cannot generate schedule: Missing agent data');
                return;
            }
            
            const dayOfWeek = document.getElementById('dayOfWeek').value;
            if (!dayOfWeek) {
                alert('‚ö†Ô∏è Please select a day of week');
                console.error('Cannot generate schedule: No day selected');
                return;
            }
            
            console.log(`‚úì Starting schedule generation for ${dayOfWeek} with ${flightsData.length} flight operations`);
            
            document.getElementById('loading').classList.add('active');
            document.getElementById('results').style.display = 'none';

            // Simulate processing time for better UX
            setTimeout(() => {
                try {
                    scheduleResult = createSchedule();
                    displayResults(scheduleResult);
                    setupTeamSearch();
                    populatePrintDropdown();
                    document.getElementById('loading').classList.remove('active');
                    document.getElementById('results').style.display = 'block';
                    document.getElementById('exportBtn').disabled = false;
                    
                    // If matched schedule data exists, remind user they can download with team assignments
                    if (matchedScheduleData && matchedScheduleData.length > 0) {
                        showToast('Schedule Complete!', 
                                'Team assignments are now available. You can download the Matched Schedule with Teams using the button in Step 1.', 
                                'success');
                    }
                } catch (error) {
                    alert('Error generating schedule: ' + error.message);
                    console.error('Schedule generation error:', error);
                    document.getElementById('loading').classList.remove('active');
                }
            }, 1000);
        }

        function createSchedule() {
            console.log('=== Starting Schedule Generation ===');
            
            // Get selected day of week
            const dayOfWeek = document.getElementById('dayOfWeek').value;
            console.log(`Scheduling for: ${dayOfWeek}`);
            
            const teams = extractTeams(ftAgentsData, ptAgentsData, dayOfWeek);
            console.log(`Teams extracted: ${teams.length}`);
            
            if (teams.length === 0) {
                throw new Error(`No teams found for ${dayOfWeek}. Check that your agent CSV files have ${dayOfWeek} data.`);
            }
            
            // Log team shift distribution
            const shiftDistribution = {};
            teams.forEach(team => {
                const hour = Math.floor(team.startMinutes / 60);
                shiftDistribution[hour] = (shiftDistribution[hour] || 0) + 1;
            });
            console.log('Team shift distribution:', shiftDistribution);
            
            const flights = processFlights(flightsData);
            console.log(`Flights processed: ${flights.length}`);
            
            if (flights.length === 0) {
                throw new Error('No valid flights found. Check that your flight CSV has departure times.');
            }

            // Analyze flight timing distribution
            const flightsByHour = {};
            flights.forEach(f => {
                const hour = Math.floor(f.timeMinutes / 60);
                if (!flightsByHour[hour]) flightsByHour[hour] = [];
                flightsByHour[hour].push(f);
            });
            console.log('Flights by hour:', Object.keys(flightsByHour).sort().map(h => `${h}:00=${flightsByHour[h].length}`).join(', '));

            // Phase-based assignment
            const assignments = [];
            const unassigned = [];
            const teamWorkload = {};

            teams.forEach(team => {
                teamWorkload[team.id] = {
                    team: team,
                    operations: [],
                    count: 0
                };
            });

            console.log('Starting phase-based assignment...');

            // **PHASE 0: OVERNIGHT Team - Terminators + 2x 05:00 Departures**
            // OVERNIGHT works 23:00-05:00: Strip terminators, then load 2x 05:00 departures only
            const overnight0500 = flights
                .filter(f => f.type === 'Domestic' && f.timeMinutes === 300)  // Only 05:00 flights
                .slice(0, 2);  // Only 2 flights
            
            console.log(`Phase 0 - OVERNIGHT: ${overnight0500.length} departures (05:00 only)`);
            console.log(`  NOTE: OVERNIGHT also strips terminators 23:00-05:00 before departure loads`);
            overnight0500.forEach(flight => {
                assignments.push({
                    flight: flight,
                    team: 'OVERNIGHT',
                    phase: 'overnight_serviced'
                });
                console.log(`  [OK] ${flight.flight} (${flight.time}) -> OVERNIGHT`);
            });
            
            const veryEarlyDomestic = overnight0500;  // For backward compatibility

            // **PHASE 0.5: Very Early Departures (05:30-07:00) - Prioritize TM200/TM201**
            // TM200 (03:00) and TM201 (04:00) should handle flights right after OVERNIGHT
            const veryEarlyFlights = flights.filter(f =>
                f.type === 'Domestic' &&
                f.timeMinutes > 300 && f.timeMinutes < 420 &&  // After 05:00, before 07:00
                !assignments.some(a => a.flight === f)
            );
            
            // Get earliest FT teams (TM200, TM201, TM202, etc.)
            const earlyFTTeams = teams
                .filter(t => t.type === 'FT' && t.startMinutes < 360)  // Start before 06:00
                .sort((a, b) => a.startMinutes - b.startMinutes);
            
            console.log(`Phase 0.5 - Very Early Domestic (TM200/TM201 priority): ${veryEarlyFlights.length} flights`);
            assignFlightsFlexible(veryEarlyFlights, earlyFTTeams, assignments, unassigned, teamWorkload, 'very_early_domestic');

            // **PHASE 1: Early domestic flights (before 07:00) - PRIORITIZE COVERAGE**
            const earlyDomestic = flights.filter(f => 
                f.type === 'Domestic' && 
                f.timeMinutes < 420 &&
                !assignments.some(a => a.flight === f)
            );
            console.log(`Phase 1 - Early Domestic: ${earlyDomestic.length} flights`);
            assignFlightsFlexible(earlyDomestic, teams, assignments, unassigned, teamWorkload, 'early_domestic');

            // **PHASE 2: Morning international bank (07:00-10:00)**
            const morningIntl = flights.filter(f => 
                (f.type === 'International' || f.type === 'Precleared') && 
                f.timeMinutes >= 420 && f.timeMinutes < 600 &&
                !assignments.some(a => a.flight === f)
            );
            console.log(`Phase 2 - Morning International: ${morningIntl.length} flights`);
            assignFlightsFlexible(morningIntl, teams, assignments, unassigned, teamWorkload, 'morning_intl');

            // **PHASE 3: Mid-day domestic (07:00-18:00)**
            const middayDomestic = flights.filter(f => 
                f.type === 'Domestic' && 
                f.timeMinutes >= 420 && f.timeMinutes < 1080 &&
                !assignments.some(a => a.flight === f)
            );
            console.log(`Phase 3 - Midday Domestic: ${middayDomestic.length} flights`);
            assignFlightsFlexible(middayDomestic, teams, assignments, unassigned, teamWorkload, 'midday_domestic');

            // **PHASE 4: Evening international bank (18:00-22:00)**
            const eveningIntl = flights.filter(f => 
                (f.type === 'International' || f.type === 'Precleared') && 
                f.timeMinutes >= 1080 && f.timeMinutes < 1320 &&
                !assignments.some(a => a.flight === f)
            );
            console.log(`Phase 4 - Evening International: ${eveningIntl.length} flights`);
            assignFlightsFlexible(eveningIntl, teams, assignments, unassigned, teamWorkload, 'evening_intl');

            // **PHASE 5: Late domestic (after 18:00)**
            const lateDomestic = flights.filter(f => 
                f.type === 'Domestic' && 
                f.timeMinutes >= 1080 &&
                !assignments.some(a => a.flight === f)
            );
            console.log(`Phase 5 - Late Domestic: ${lateDomestic.length} flights`);
            assignFlightsFlexible(lateDomestic, teams, assignments, unassigned, teamWorkload, 'late_domestic');

            // **PHASE 6: Final sweep - try to assign remaining with relaxed constraints**
            const stillUnassigned = flights.filter(f => 
                !assignments.some(a => a.flight === f)
            );
            if (stillUnassigned.length > 0) {
                console.log(`Phase 6 - Final Sweep: ${stillUnassigned.length} flights remaining`);
                assignFlightsVeryFlexible(stillUnassigned, teams, assignments, unassigned, teamWorkload, 'final_sweep');
            }

            console.log(`=== Schedule Complete ===`);
            console.log(`Assigned: ${assignments.length}, Unassigned: ${unassigned.length}`);
            console.log(`Coverage: ${Math.round((assignments.length / flights.length) * 100)}%`);

            // Analyze coverage gaps
            const unassignedByTime = {};
            unassigned.forEach(u => {
                const hour = Math.floor(u.flight.timeMinutes / 60);
                if (!unassignedByTime[hour]) unassignedByTime[hour] = [];
                unassignedByTime[hour].push(u.flight.flight);
            });
            if (Object.keys(unassignedByTime).length > 0) {
                console.log('Coverage gaps by hour:', unassignedByTime);
            }

            return {
                assignments,
                unassigned,
                teamWorkload: Object.values(teamWorkload),
                stats: calculateStats(assignments, unassigned, Object.values(teamWorkload)),
                overnightCount: veryEarlyDomestic.length,
                dayOfWeek: dayOfWeek,
                coverageGaps: unassignedByTime
            };
        }

        function extractTeams(ftData, ptData, dayOfWeek) {
            const teams = [];
            
            // FIREHOUSE STANDBY TEAMS - Reserved for IROPS (not assigned in automated schedule)
            // Option 2: Morning + Evening coverage (12 hours total)
            const FIREHOUSE_TEAMS = SCHEDULER_CONFIG.teams.firehouseReservedTeams;
            
            console.log('[FH] FIREHOUSE Standby Teams Reserved:', FIREHOUSE_TEAMS.join(', '));
            
            // Column names for Thursday
            const shiftCol = 'Thursday';
            const deptCol = 'Thurs Department';
            const teamCol = 'Thurs Team';

            console.log('Extracting teams for Thursday');
            console.log('Sample FT agent:', ftData[0]);
            console.log('Sample PT agent:', ptData[0]);

            // Process full-time agents
            ftData.forEach(agent => {
                const shift = agent[shiftCol];
                const dept = agent[deptCol];
                const team = agent[teamCol];

                if (shift && shift !== 'Off' && shift !== '' && dept && dept.includes('TRK') && team) {
                    // Parse shift start time (format: "0500-1330" or "1300-2130")
                    const startTime = shift.split('-')[0];
                    const startMinutes = timeToMinutes(startTime);
                    
                    teams.push({
                        id: team,
                        department: dept,
                        shift: shift,
                        startMinutes: startMinutes,
                        type: 'FT',
                        name: `${agent['First Name']} ${agent['Last Name']}`
                    });
                }
            });

            // Process part-time agents
            ptData.forEach(agent => {
                const shift = agent[shiftCol];
                const dept = agent[deptCol];
                const team = agent[teamCol];

                if (shift && shift !== 'Off' && shift !== '' && dept && dept.includes('TRK') && team) {
                    
                    // Skip FIREHOUSE standby teams - reserved for IROPS duty
                    if (FIREHOUSE_TEAMS.includes(team)) {
                        console.log(`  [FH] Reserving ${team} for FIREHOUSE standby duty (${shift})`);
                        return;  // Don't add to scheduled teams
                    }
                    
                    // Parse shift start time (format: "0500-1330" or "1300-2130")
                    const startTime = shift.split('-')[0];
                    const startMinutes = timeToMinutes(startTime);
                    
                    teams.push({
                        id: team,
                        department: dept,
                        shift: shift,
                        startMinutes: startMinutes,
                        type: 'PT',
                        name: `${agent['First Name']} ${agent['Last Name']}`
                    });
                }
            });

            console.log(`Extracted ${teams.length} teams`);
            if (teams.length > 0) {
                console.log('Sample team:', teams[0]);
                console.log(`Team ${teams[0].id} starts at ${teams[0].startMinutes} minutes (${minutesToTime(teams[0].startMinutes)})`);
            }
            return teams;
        }

        function processFlights(flightData) {
            console.log('Processing flights, total rows:', flightData.length);
            if (flightData.length > 0) {
                console.log('Sample flight data:', flightData[0]);
            }
            
            const processed = flightData
                .filter(f => {
                    // Filter based on departure scheduled time
                    if (!f.Dep_Scheduled || f.Dep_Scheduled === '') return false;
                    if (!f.Dep_Flight || f.Dep_Flight === '') return false;
                    return true;
                })
                .map(f => {
                    // Parse the time from Dep_Scheduled
                    let timeStr = f.Dep_Scheduled;
                    
                    // Extract time portion if it's a full datetime
                    if (timeStr.includes(' ')) {
                        const parts = timeStr.split(' ');
                        // Get the time part (should be index 1)
                        timeStr = parts[parts.length - 1];
                    }
                    
                    // Parse arrival time if exists
                    let arrTimeStr = '';
                    if (f.Arr_ETA) {
                        arrTimeStr = f.Arr_ETA;
                        if (arrTimeStr.includes(' ')) {
                            const parts = arrTimeStr.split(' ');
                            arrTimeStr = parts[parts.length - 1];
                        }
                    }
                    
                    const timeMinutes = timeToMinutes(timeStr);
                    
                    return {
                        flight: f.Dep_Flight,
                        origin: f.Arr_Origin || 'N/A',
                        destination: f.Dep_Dest || 'N/A',
                        time: timeStr,
                        timeMinutes: timeMinutes,
                        type: f.Dep_Type || 'Domestic',
                        gate: f.Dep_Gate || f.Arr_Gate || 'TBD',
                        passengers: parseInt(f.Dep_Total_Customers) || parseInt(f.Arr_Total_Customers) || 0,
                        equipment: f.Dep_Equip || f.Arr_Equip,
                        turnType: f.TurnType,
                        // Full arrival information
                        noseNumber: f['Nose #'] || '',
                        arrFlight: f.Arr_Flight || '',
                        arrOrigin: f.Arr_Origin || '',
                        arrTime: arrTimeStr,
                        arrGate: f.Arr_Gate || '',
                        arrEquipment: f.Arr_Equip || '',
                        arrPassengers: parseInt(f.Arr_Total_Customers) || '',
                        arrivalFlight: f.Arr_Flight || '',
                        arrivalTime: f.Arr_ETA || ''
                    };
                })
                .filter(f => f.timeMinutes > 0 && f.timeMinutes < 1440) // Valid times only (0-24 hours)
                .sort((a, b) => a.timeMinutes - b.timeMinutes);
            
            console.log('Processed flights:', processed.length);
            if (processed.length > 0) {
                console.log('First flight:', processed[0]);
                console.log('Last flight:', processed[processed.length - 1]);
            }
            
            return processed;
        }

        function assignFlights(flights, teams, assignments, unassigned, teamWorkload, phase) {
            console.log(`\n--- Assigning ${flights.length} flights in phase: ${phase} ---`);
            
            if (flights.length === 0) {
                console.log('No flights to assign in this phase');
                return;
            }
            
            flights.forEach((flight, index) => {
                let assigned = false;
                let bestTeam = null;
                let minWorkload = Infinity;
                let rejectionReasons = [];

                // Find best available team (with least workload)
                for (let team of teams) {
                    const workload = teamWorkload[team.id];
                    
                    // Check if team can handle this flight
                    if (canAssignFlight(team, flight, workload)) {
                        if (workload.count < minWorkload) {
                            minWorkload = workload.count;
                            bestTeam = team;
                        }
                    } else {
                        // Track why we couldn't assign
                        const serviceStart = flight.timeMinutes - getServiceBufferMinutes(flight.type);
                        const teamReady = team.startMinutes + SCHEDULER_CONFIG.teams.prepMinutesStandard;
                        if (serviceStart < teamReady) {
                            rejectionReasons.push(`${team.id}: too early (service ${serviceStart} < team ready ${teamReady})`);
                        } else if (workload.count >= SCHEDULER_CONFIG.teams.workloadLimitStandard) {
                            rejectionReasons.push(`${team.id}: full (${workload.count} ops)`);
                        }
                    }
                }

                if (bestTeam) {
                    const workload = teamWorkload[bestTeam.id];
                    assignments.push({
                        flight: flight,
                        team: bestTeam.id,
                        phase: phase
                    });
                    workload.operations.push(flight);
                    workload.count++;
                    assigned = true;
                    
                    if (index < 3) { // Log first few assignments
                        console.log(` ${flight.flight} (${flight.time})  ${bestTeam.id}`);
                    }
                } else {
                    unassigned.push({
                        flight: flight,
                        reason: 'No available team matching timing and operational constraints'
                    });
                    
                    if (index < 3) { // Log first few failures
                        console.log(` ${flight.flight} (${flight.time}) - ${rejectionReasons.slice(0, 2).join(', ')}`);
                    }
                }
            });
            
            console.log(`Phase complete: ${flights.filter((f, i) => assignments.some(a => a.flight === f)).length} assigned, ${flights.filter((f, i) => unassigned.some(u => u.flight === f)).length} unassigned`);
        }
        
        // More flexible assignment - reduces time gaps and increases workload limits
        function assignFlightsFlexible(flights, teams, assignments, unassigned, teamWorkload, phase) {
            flights.forEach((flight, index) => {
                let assigned = false;
                let bestTeam = null;
                let minWorkload = Infinity;

                for (let team of teams) {
                    const workload = teamWorkload[team.id];
                    
                    if (canAssignFlightFlexible(team, flight, workload)) {
                        if (workload.count < minWorkload) {
                            minWorkload = workload.count;
                            bestTeam = team;
                        }
                    }
                }

                if (bestTeam) {
                    const workload = teamWorkload[bestTeam.id];
                    assignments.push({
                        flight: flight,
                        team: bestTeam.id,
                        phase: phase
                    });
                    workload.operations.push(flight);
                    workload.count++;
                    assigned = true;
                } else {
                    // Don't add to unassigned yet - let other phases try
                }
            });
        }
        
        // Very flexible assignment for final sweep - maximum coverage
        function assignFlightsVeryFlexible(flights, teams, assignments, unassigned, teamWorkload, phase) {
            flights.forEach((flight, index) => {
                let assigned = false;
                let bestTeam = null;
                let minWorkload = Infinity;

                for (let team of teams) {
                    const workload = teamWorkload[team.id];
                    
                    if (canAssignFlightVeryFlexible(team, flight, workload)) {
                        if (workload.count < minWorkload) {
                            minWorkload = workload.count;
                            bestTeam = team;
                        }
                    }
                }

                if (bestTeam) {
                    const workload = teamWorkload[bestTeam.id];
                    assignments.push({
                        flight: flight,
                        team: bestTeam.id,
                        phase: phase
                    });
                    workload.operations.push(flight);
                    workload.count++;
                    assigned = true;
                    console.log(` Final sweep: ${flight.flight} (${flight.time})  ${bestTeam.id}`);
                } else {
                    unassigned.push({
                        flight: flight,
                        reason: 'No team available even with relaxed constraints'
                    });
                    console.log(` Cannot assign: ${flight.flight} (${flight.time})`);
                }
            });
        }
        

        function hasOperationConflict(workload, flight, mode) {
            if (!workload.operations || workload.operations.length === 0) return false;

            const serviceStartTime = flight.timeMinutes - getServiceBufferMinutes(flight.type);
            const minGap = mode === 'veryFlexible' ? SCHEDULER_CONFIG.spacing.veryFlexibleMinGap :
                mode === 'flexible' ? SCHEDULER_CONFIG.spacing.flexibleMinGap :
                SCHEDULER_CONFIG.spacing.standardMinGap;

            for (const op of workload.operations) {
                const existingServiceStart = op.timeMinutes - getServiceBufferMinutes(op.type);
                const departureGap = Math.abs(flight.timeMinutes - op.timeMinutes);
                const serviceGap = Math.abs(serviceStartTime - existingServiceStart);
                if (departureGap < minGap || serviceGap < minGap) {
                    return true;
                }

                if (mode !== 'veryFlexible') {
                    if ((flight.type === 'International' || flight.type === 'Precleared') && op.type === 'Domestic' && departureGap < SCHEDULER_CONFIG.spacing.standardIntlAfterDomesticGap) {
                        return true;
                    }
                    if ((flight.type === 'International' || flight.type === 'Precleared') && (op.type === 'International' || op.type === 'Precleared') && departureGap < SCHEDULER_CONFIG.spacing.standardIntlAfterIntlGap) {
                        return true;
                    }
                }
            }

            return false;
        }

        function canAssignFlightFlexible(team, flight, workload) {
            // FLEXIBLE MODE - Based on live schedule patterns
            // Live data: 0-5 min gaps common, early starts standard
            
            // Calculate when service must start based on flight type
            const serviceBuffer = getServiceBufferMinutes(flight.type);
            const serviceStartTime = flight.timeMinutes - serviceBuffer;
            
            // Flexible: Allow team to be ready right at shift start (no prep time buffer)
            const teamReadyTime = team.startMinutes; 
            if (serviceStartTime < teamReadyTime) return false;
            
            const shiftEnd = team.startMinutes + (SCHEDULER_CONFIG.teams.shiftHours * 60);
            const maxTime = shiftEnd + SCHEDULER_CONFIG.teams.overtimeMinutesFlexible;
            if (flight.timeMinutes > maxTime) return false;

            if (workload.count >= SCHEDULER_CONFIG.teams.workloadLimitFlexible) return false;

            if (hasOperationConflict(workload, flight, 'flexible')) return false;

            return true;
        }
        
        function canAssignFlightVeryFlexible(team, flight, workload) {
            // FINAL SWEEP - Maximum coverage like live schedule
            // Live showed: 0-3 min gaps acceptable, simultaneous operations work
            
            // Calculate when service must start based on flight type
            const serviceBuffer = getServiceBufferMinutes(flight.type);
            const serviceStartTime = flight.timeMinutes - serviceBuffer;
            
            // Maximum flexibility: Team ready right at shift start
            const teamReadyTime = team.startMinutes;
            if (serviceStartTime < teamReadyTime) return false;
            
            const shiftEnd = team.startMinutes + (SCHEDULER_CONFIG.teams.shiftHours * 60);
            const maxTime = shiftEnd + SCHEDULER_CONFIG.teams.overtimeMinutesFlexible;
            if (flight.timeMinutes > maxTime) return false;

            if (workload.count >= SCHEDULER_CONFIG.teams.workloadLimitVeryFlexible) return false;

            if (hasOperationConflict(workload, flight, 'veryFlexible')) return false;

            return true;
        }

        function canAssignFlight(team, flight, workload) {
            // Calculate when service must start based on flight type
            // Domestic: 40 min before departure, International: 60 min before departure
            const serviceBuffer = getServiceBufferMinutes(flight.type);
            const serviceStartTime = flight.timeMinutes - serviceBuffer;
            
            // Team is ready 15 minutes AFTER shift start (clock in, get truck, receive assignments)
            const teamReadyTime = team.startMinutes + SCHEDULER_CONFIG.teams.prepMinutesStandard;
            if (serviceStartTime < teamReadyTime) {
                return false;
            }
            
            // Check if flight is too late (after shift end + 2 hours overtime potential)
            const shiftEnd = team.startMinutes + (SCHEDULER_CONFIG.teams.shiftHours * 60); // 8.5 hour shift
            const maxTime = shiftEnd + SCHEDULER_CONFIG.teams.overtimeMinutesStandard;
            if (flight.timeMinutes > maxTime) {
                return false;
            }

            // Check workload limit (max 8 operations to be more flexible)
            if (workload.count >= SCHEDULER_CONFIG.teams.workloadLimitStandard) {
                return false;
            }

            if (hasOperationConflict(workload, flight, 'standard')) {
                return false;
            }

            return true;
        }

        function calculateStats(assignments, unassigned, teamWorkload) {
            const domestic = assignments.filter(a => a.flight.type === 'Domestic').length;
            const international = assignments.filter(a => a.flight.type === 'International').length;

            // Count only teams that actually have assignments
            const teamsWithWork = teamWorkload.filter(tw => tw.count > 0).length;

            return {
                totalFlights: assignments.length + unassigned.length,
                assigned: assignments.length,
                unassigned: unassigned.length,
                domestic: domestic,
                international: international,
                teamsDeployed: teamsWithWork,
                coveragePercent: Math.round((assignments.length / (assignments.length + unassigned.length)) * 100)
            };
        }

        function timeToMinutes(timeStr) {
            if (!timeStr || timeStr === '') return 0;
            
            // Remove any whitespace
            timeStr = timeStr.trim();
            
            // Handle full datetime format like "1/0/1900 23:55"
            if (timeStr.includes('/')) {
                const parts = timeStr.split(' ');
                if (parts.length > 1) {
                    timeStr = parts[1]; // Get the time part
                } else {
                    return 0; // Invalid format
                }
            }
            
            // Handle time with AM/PM
            if (timeStr.includes('AM') || timeStr.includes('PM')) {
                const isPM = timeStr.includes('PM');
                timeStr = timeStr.replace(/AM|PM/g, '').trim();
                const parts = timeStr.split(':');
                let hours = parseInt(parts[0]);
                const mins = parseInt(parts[1] || 0);
                
                if (isPM && hours !== 12) hours += 12;
                if (!isPM && hours === 12) hours = 0;
                
                return hours * 60 + mins;
            }
            
            // Handle 24-hour format with colon (HH:MM or H:MM)
            if (timeStr.includes(':')) {
                const parts = timeStr.split(':');
                const hours = parseInt(parts[0]);
                const mins = parseInt(parts[1] || 0);
                
                if (isNaN(hours) || isNaN(mins)) return 0;
                return hours * 60 + mins;
            }
            
            // Handle 4-digit format without colon (HHMM like "0500" or "1330")
            if (timeStr.length === 4 && !isNaN(timeStr)) {
                const hours = parseInt(timeStr.substring(0, 2));
                const mins = parseInt(timeStr.substring(2, 4));
                
                if (isNaN(hours) || isNaN(mins)) return 0;
                return hours * 60 + mins;
            }
            
            // Handle 3-digit format (HMM like "500" for 5:00)
            if (timeStr.length === 3 && !isNaN(timeStr)) {
                const hours = parseInt(timeStr.substring(0, 1));
                const mins = parseInt(timeStr.substring(1, 3));
                
                if (isNaN(hours) || isNaN(mins)) return 0;
                return hours * 60 + mins;
            }
            
            // Handle 1 or 2 digit format (just hours)
            if ((timeStr.length === 1 || timeStr.length === 2) && !isNaN(timeStr)) {
                const hours = parseInt(timeStr);
                if (isNaN(hours)) return 0;
                return hours * 60;
            }
            
            console.warn(`Unable to parse time: "${timeStr}"`);
            return 0;
        }

        // =====================================================================
        // TEAM SUMMARY TABLE: SEARCH AND SORT FUNCTIONS
        // =====================================================================
        
        // Search/filter team table
        function setupTeamSearch() {
            const searchInput = document.getElementById('teamSearchInput');
            if (searchInput) {
                searchInput.addEventListener('keyup', function() {
                    const filter = this.value.toLowerCase();
                    const rows = document.querySelectorAll('#teamTableBody tr');
                    
                    rows.forEach(row => {
                        const text = row.textContent.toLowerCase();
                        row.style.display = text.includes(filter) ? '' : 'none';
                    });
                });
            }
        }

        // Sort team table by column
        let teamSortDirection = {};
        function sortTeamTable(columnIndex) {
            const table = document.getElementById('teamTable');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            
            // Toggle sort direction
            teamSortDirection[columnIndex] = !teamSortDirection[columnIndex];
            const ascending = teamSortDirection[columnIndex];
            
            rows.sort((a, b) => {
                let aVal = a.cells[columnIndex].textContent.trim();
                let bVal = b.cells[columnIndex].textContent.trim();
                
                // Handle numeric columns
                if (columnIndex === 2) { // Operations column
                    aVal = parseInt(aVal) || 0;
                    bVal = parseInt(bVal) || 0;
                }
                
                // Handle time columns
                if (columnIndex === 5 || columnIndex === 6) {
                    if (aVal === '-') aVal = '99:99';
                    if (bVal === '-') bVal = '99:99';
                }
                
                if (aVal < bVal) return ascending ? -1 : 1;
                if (aVal > bVal) return ascending ? 1 : -1;
                return 0;
            });
            
            // Re-append sorted rows
            rows.forEach(row => tbody.appendChild(row));
        }

        // =====================================================================
        // TEAM ASSIGNMENT PRINT FUNCTIONS
        // =====================================================================
        
        // Populate print dropdown with team options
        function populatePrintDropdown() {
            const select = document.getElementById('printTeamSelect');
            if (!select || !scheduleResult) return;
            
            // Keep "Print All" option
            select.innerHTML = '<option value="all">Print All Teams (1 per page)</option>';
            
            // Add individual team options
            scheduleResult.teamWorkload.forEach(tw => {
                const option = document.createElement('option');
                option.value = tw.team.id;
                option.textContent = `Print ${tw.team.id} only`;
                select.appendChild(option);
            });
            
            // Add OVERNIGHT if exists
            const overnightFlights = scheduleResult.assignments.filter(a => a.team === 'OVERNIGHT');
            if (overnightFlights.length > 0) {
                const option = document.createElement('option');
                option.value = 'OVERNIGHT';
                option.textContent = 'Print OVERNIGHT only';
                select.appendChild(option);
            }
        }

        // Print team assignments
        function printTeamAssignments() {
            const selectedValue = document.getElementById('printTeamSelect').value;
            
            if (!scheduleResult) {
                alert('No schedule to print. Please generate a schedule first.');
                return;
            }
            
            // Create print window
            const printWindow = window.open('', '_blank');
            
            // Check if window opened successfully (popup blocker may prevent this)
            if (!printWindow) {
                alert('Unable to open print window. Please allow popups for this site or use the Excel export instead.');
                return;
            }
            
            printWindow.document.write('<html><head><title>Team Assignments - PHL Scheduler</title>');
            printWindow.document.write(`
                <style>
                    @media print {
                        .team-page {
                            page-break-after: always;
                            page-break-inside: avoid;
                        }
                        .team-page:last-child {
                            page-break-after: auto;
                        }
                    }
                    body {
                        font-family: Arial, sans-serif;
                        padding: 20px;
                    }
                    .team-page {
                        margin-bottom: 40px;
                    }
                    .team-header {
                        background: #1e3c72;
                        color: white;
                        padding: 15px;
                        border-radius: 8px 8px 0 0;
                    }
                    .team-title {
                        font-size: 1.8em;
                        font-weight: bold;
                        margin-bottom: 5px;
                    }
                    .team-info {
                        display: flex;
                        gap: 30px;
                        font-size: 0.9em;
                    }
                    table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-top: 0;
                    }
                    th, td {
                        border: 1px solid #ddd;
                        padding: 10px;
                        text-align: left;
                    }
                    th {
                        background: #f0f0f0;
                        font-weight: bold;
                    }
                    tr:nth-child(even) {
                        background: #f9f9f9;
                    }
                    .domestic {
                        background: #d1fae5;
                    }
                    .international {
                        background: #fef3c7;
                    }
                    .print-footer {
                        margin-top: 20px;
                        text-align: center;
                        font-size: 0.8em;
                        color: #666;
                    }
                </style>
            `);
            printWindow.document.write('</head><body>');
            
            // Generate content based on selection
            if (selectedValue === 'all') {
                // Print all teams
                scheduleResult.teamWorkload.forEach(tw => {
                    printWindow.document.write(generateTeamPrintHTML(tw));
                });
                
                // Add OVERNIGHT if exists
                const overnightFlights = scheduleResult.assignments.filter(a => a.team === 'OVERNIGHT');
                if (overnightFlights.length > 0) {
                    printWindow.document.write(generateOvernightPrintHTML(overnightFlights));
                }
            } else {
                // Print single team
                if (selectedValue === 'OVERNIGHT') {
                    const overnightFlights = scheduleResult.assignments.filter(a => a.team === 'OVERNIGHT');
                    printWindow.document.write(generateOvernightPrintHTML(overnightFlights));
                } else {
                    const teamData = scheduleResult.teamWorkload.find(tw => tw.team.id === selectedValue);
                    if (teamData) {
                        printWindow.document.write(generateTeamPrintHTML(teamData));
                    }
                }
            }
            
            printWindow.document.write('<div class="print-footer">Generated: ' + new Date().toLocaleString() + '</div>');
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            
            // Trigger print dialog
            setTimeout(() => {
                printWindow.print();
            }, 250);
        }

        // Generate HTML for team print page
        function generateTeamPrintHTML(teamData) {
            const firstFlight = teamData.operations[0];
            const lastFlight = teamData.operations[teamData.operations.length - 1];
            
            let html = '<div class="team-page">';
            html += '<div class="team-header">';
            html += `<div class="team-title">${teamData.team.id}</div>`;
            html += '<div class="team-info">';
            html += `<span>Shift: ${teamData.team.shift}</span>`;
            html += `<span>Operations: ${teamData.count}</span>`;
            html += `<span>First Flight: ${firstFlight ? firstFlight.time : '-'}</span>`;
            html += `<span>Last Flight: ${lastFlight ? lastFlight.time : '-'}</span>`;
            html += '</div></div>';
            
            html += '<table>';
            html += '<thead><tr>';
            html += '<th>#</th><th>Flight</th><th>Destination</th><th>STD</th><th>Type</th><th>Gate</th><th>PAX</th><th>Equipment</th>';
            html += '</tr></thead><tbody>';
            
            teamData.operations.forEach((flight, index) => {
                const rowClass = flight.type === 'Domestic' ? 'domestic' : 'international';
                html += `<tr class="${rowClass}">`;
                html += `<td>${index + 1}</td>`;
                html += `<td><strong>${flight.flight}</strong></td>`;
                html += `<td>${flight.destination}</td>`;
                html += `<td>${flight.time}</td>`;
                html += `<td>${flight.type}</td>`;
                html += `<td>${flight.gate || '-'}</td>`;
                html += `<td>${flight.passengers || '-'}</td>`;
                html += `<td>${flight.equipment || '-'}</td>`;
                html += '</tr>';
            });
            
            html += '</tbody></table></div>';
            return html;
        }

        // Generate HTML for OVERNIGHT print page
        function generateOvernightPrintHTML(flights) {
            let html = '<div class="team-page">';
            html += '<div class="team-header">';
            html += '<div class="team-title">OVERNIGHT</div>';
            html += '<div class="team-info">';
            html += `<span>Shift: Previous Day</span>`;
            html += `<span>Operations: ${flights.length}</span>`;
            html += '</div></div>';
            
            html += '<table>';
            html += '<thead><tr>';
            html += '<th>#</th><th>Flight</th><th>Destination</th><th>STD</th><th>Type</th><th>Gate</th><th>PAX</th><th>Equipment</th>';
            html += '</tr></thead><tbody>';
            
            flights.forEach((assignment, index) => {
                const flight = assignment.flight;
                const rowClass = flight.type === 'Domestic' ? 'domestic' : 'international';
                html += `<tr class="${rowClass}">`;
                html += `<td>${index + 1}</td>`;
                html += `<td><strong>${flight.flight}</strong></td>`;
                html += `<td>${flight.destination}</td>`;
                html += `<td>${flight.time}</td>`;
                html += `<td>${flight.type}</td>`;
                html += `<td>${flight.gate || '-'}</td>`;
                html += `<td>${flight.passengers || '-'}</td>`;
                html += `<td>${flight.equipment || '-'}</td>`;
                html += '</tr>';
            });
            
            html += '</tbody></table></div>';
            return html;
        }

        function minutesToTime(minutes) {
            const hours = Math.floor(minutes / 60);
            const mins = minutes % 60;
            return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;
        }

        // Display results
        function displayResults(result) {
            console.log('displayResults called:', {
                totalFlights: result.stats.totalFlights,
                assigned: result.stats.assigned,
                unassigned: result.unassigned.length,
                assignments: result.assignments.length
            });
            
            // Display header with day of week
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = `
                <div class="stat-card" style="grid-column: span 2; background: linear-gradient(135deg, #0078D2 0%, #005BA1 100%); color: white;">
                    <h3 style="color: rgba(255,255,255,0.9);">Scheduling Day</h3>
                    <div class="value" style="color: white;">${result.dayOfWeek}</div>
                </div>
                <div class="stat-card">
                    <h3>Total Flights</h3>
                    <div class="value">${result.stats.totalFlights}</div>
                </div>
                <div class="stat-card">
                    <h3>Assigned</h3>
                    <div class="value" style="color: #28a745;">${result.stats.assigned}</div>
                </div>
                <div class="stat-card">
                    <h3>Coverage</h3>
                    <div class="value">${result.stats.coveragePercent}%</div>
                </div>
                <div class="stat-card">
                    <h3>Domestic</h3>
                    <div class="value">${result.stats.domestic}</div>
                </div>
                <div class="stat-card">
                    <h3>International</h3>
                    <div class="value">${result.stats.international}</div>
                </div>
                <div class="stat-card">
                    <h3>Teams Deployed</h3>
                    <div class="value">${result.stats.teamsDeployed}</div>
                </div>
                <div class="stat-card">
                    <h3>Avg per Team</h3>
                    <div class="value">${(result.stats.assigned / result.stats.teamsDeployed).toFixed(1)}</div>
                </div>
            `;
            
            // Show coverage gap alert if exists
            if (result.coverageGaps && Object.keys(result.coverageGaps).length > 0) {
                const gapHours = Object.keys(result.coverageGaps).sort((a,b) => a-b);
                const gapSummary = gapHours.map(h => `${h}:00 (${result.coverageGaps[h].length})`).join(', ');
                statsGrid.innerHTML += `
                    <div class="stat-card" style="grid-column: span 4; background: #fff3cd; border-left: 4px solid #ffc107;">
                        <h3 style="color: #856404;">Coverage Gaps by Hour</h3>
                        <div style="font-size: 0.9em; color: #856404; margin-top: 8px;">${gapSummary}</div>
                    </div>
                `;
            }

            // Display team workload
            const teamTableBody = document.getElementById('teamTableBody');
            teamTableBody.innerHTML = '';
            result.teamWorkload.forEach(tw => {
                const firstFlight = tw.operations[0];
                const lastFlight = tw.operations[tw.operations.length - 1];
                const flightNumbers = tw.operations.map(op => op.flight).join(', ');
                
                // Calculate shift utilization
                const shiftStart = tw.team.startMinutes;
                const shiftEnd = shiftStart + (SCHEDULER_CONFIG.teams.shiftHours * 60);
                const actualStart = firstFlight ? firstFlight.timeMinutes : shiftStart;
                const actualEnd = lastFlight ? lastFlight.timeMinutes : shiftStart;
                const utilization = tw.count > 0 ? Math.round(((actualEnd - actualStart) / (SCHEDULER_CONFIG.teams.shiftHours * 60)) * 100) : 0;
                
                const row = `
                    <tr>
                        <td><strong>${tw.team.id}</strong></td>
                        <td>${tw.team.shift}</td>
                        <td>${tw.count}</td>
                        <td>
                            <div class="workload-bar">
                                <div class="workload-fill" style="width: ${(tw.count / 6) * 100}%"></div>
                            </div>
                        </td>
                        <td style="font-size: 0.85em; max-width: 300px; overflow-x: auto;">${flightNumbers || '-'}</td>
                        <td>${firstFlight ? firstFlight.time : '-'}</td>
                        <td>${lastFlight ? lastFlight.time : '-'}</td>
                    </tr>
                `;
                teamTableBody.innerHTML += row;
            });
            
            // Add OVERNIGHT row if there are overnight assignments
            const overnightFlights = result.assignments.filter(a => a.team === 'OVERNIGHT');
            if (overnightFlights.length > 0) {
                const overnightNumbers = overnightFlights.map(a => a.flight.flight).join(', ');
                const firstOvernight = overnightFlights[0].flight;
                const lastOvernight = overnightFlights[overnightFlights.length - 1].flight;
                const row = `
                    <tr style="background: #fff3cd;">
                        <td><strong>OVERNIGHT</strong></td>
                        <td>Previous Day</td>
                        <td>${overnightFlights.length}</td>
                        <td>
                            <div class="workload-bar">
                                <div class="workload-fill" style="width: ${(overnightFlights.length / 6) * 100}%; background: #ffc107;"></div>
                            </div>
                        </td>
                        <td style="font-size: 0.85em;">${overnightNumbers}</td>
                        <td>${firstOvernight.time}</td>
                        <td>${lastOvernight.time}</td>
                    </tr>
                `;
                teamTableBody.innerHTML = row + teamTableBody.innerHTML; // Add at top
            }
            
            // Generate detailed team groupings
            generateTeamDetailedView(result);

            // Display flight assignments with editable team assignments
            const flightTableBody = document.getElementById('flightTableBody');
            flightTableBody.innerHTML = '';
            
            // Get list of all teams for dropdown
            const allTeams = [...new Set(result.teamWorkload.map(tw => tw.team.id))].sort();
            allTeams.unshift('OVERNIGHT'); // Add overnight option
            
            result.assignments.forEach((a, index) => {
                const teamDropdown = allTeams.map(teamId => 
                    `<option value="${teamId}" ${teamId === a.team ? 'selected' : ''}>${teamId}</option>`
                ).join('');
                
                const row = `
                    <tr data-assignment-index="${index}">
                        <td><strong>${a.flight.flight}</strong></td>
                        <td>${a.flight.destination}</td>
                        <td>${a.flight.time}</td>
                        <td><span class="status-badge status-${a.flight.type.toLowerCase()}">${a.flight.type}</span></td>
                        <td>
                            <select class="team-selector" onchange="updateAssignment(${index}, this.value)">
                                ${teamDropdown}
                            </select>
                        </td>
                        <td>${a.flight.gate}</td>
                    </tr>
                `;
                flightTableBody.innerHTML += row;
            });

            // Display unassigned flights
            if (result.unassigned && result.unassigned.length > 0) {
                document.getElementById('unassignedSection').style.display = 'block';
                document.getElementById('unassignedAlert').textContent = 
                    `${result.unassigned.length} flight${result.unassigned.length > 1 ? 's' : ''} could not be assigned. Use Auto-Assign or manually assign below.`;
                
                const unassignedTableBody = document.getElementById('unassignedTableBody');
                unassignedTableBody.innerHTML = '';
                
                result.unassigned.forEach((u, idx) => {
                    // Find best team suggestion for this flight
                    const suggestion = findBestTeamForFlight(u.flight, result.teamWorkload);
                    
                    // Generate team dropdown
                    const teamOptions = result.teamWorkload.map(tw => 
                        `<option value="${tw.team.id}">${tw.team.id} (${tw.count} ops)</option>`
                    ).join('');
                    
                    const row = `
                        <tr id="unassigned-row-${idx}">
                            <td><strong>${u.flight.flight}</strong></td>
                            <td>${u.flight.origin || u.flight.destination}</td>
                            <td>${u.flight.time}</td>
                            <td><span class="status-badge status-${u.flight.type.toLowerCase()}">${u.flight.type}</span></td>
                            <td>
                                ${suggestion ? `
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <strong style="color: #28a745;">${suggestion.team}</strong>
                                        <span style="font-size: 0.85em; color: #666;">${suggestion.reason}</span>
                                        <button onclick="assignFlightToTeam(${idx}, '${suggestion.team}')" 
                                                style="padding: 4px 12px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.85em;">
                                            ‚úì Accept
                                        </button>
                                    </div>
                                ` : '<span style="color: #999;">No suggestion</span>'}
                            </td>
                            <td>
                                <select id="manual-team-${idx}" class="team-selector" style="padding: 6px; font-size: 0.9em;">
                                    <option value="">Select team...</option>
                                    ${teamOptions}
                                </select>
                            </td>
                            <td>
                                <button onclick="manualAssignFlight(${idx})" 
                                        style="padding: 6px 16px; background: #0078D2; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 0.9em;">
                                    Assign
                                </button>
                            </td>
                        </tr>
                    `;
                    unassignedTableBody.innerHTML += row;
                });
            } else {
                // Hide unassigned section if no unassigned flights
                document.getElementById('unassignedSection').style.display = 'none';
            }
        }

        // === UNASSIGNED FLIGHT REASSIGNMENT FUNCTIONS ===
        
        function findBestTeamForFlight(flight, teamWorkload) {
            // Find best team suggestion for unassigned flight with relaxed constraints
            let bestTeam = null;
            let bestScore = -1;
            
            teamWorkload.forEach(tw => {
                // Skip if team is overloaded (>6 ops)
                if (tw.count >= (SCHEDULER_CONFIG.teams.workloadLimitStandard - 1)) return;
                
                // Check if team is working during flight time
                const flightTime = flight.timeMinutes;
                const teamStart = tw.team.startMinutes;
                const teamEnd = teamStart + (SCHEDULER_CONFIG.teams.shiftHours * 60);
                
                // Relaxed constraint: flight within team shift + 60min buffer
                if (flightTime < teamStart - 60 || flightTime > teamEnd + SCHEDULER_CONFIG.teams.overtimeMinutesStandard) return;
                
                // Calculate score based on:
                // - Current workload (prefer less loaded teams)
                // - Time fit (prefer teams with better time match)
                // - Capacity remaining
                
                const capacityScore = ((SCHEDULER_CONFIG.teams.workloadLimitStandard - 1) - tw.count) / (SCHEDULER_CONFIG.teams.workloadLimitStandard - 1); // 0-1, higher is better
                const timeFit = Math.max(0, 1 - Math.abs(flightTime - (teamStart + 4*60)) / (8*60)); // Prefer middle of shift
                const score = (capacityScore * 0.6) + (timeFit * 0.4);
                
                if (score > bestScore) {
                    bestScore = score;
                    bestTeam = {
                        team: tw.team.id,
                        reason: `${tw.count} ops, ${capacityScore > 0.5 ? 'good' : 'tight'} capacity`,
                        score: score
                    };
                }
            });
            
            return bestTeam;
        }
        
        function autoAssignUnassigned() {
            if (!scheduleResult || !scheduleResult.unassigned || scheduleResult.unassigned.length === 0) {
                alert('No unassigned flights to assign');
                return;
            }
            
            const statusDiv = document.getElementById('autoAssignStatus');
            statusDiv.innerHTML = '<strong>‚è≥ Processing...</strong>';
            
            let assigned = 0;
            let failed = 0;
            const assignments = [];
            
            // Try to assign each unassigned flight
            // Important: Work backwards to avoid index shifting issues
            for (let idx = scheduleResult.unassigned.length - 1; idx >= 0; idx--) {
                const u = scheduleResult.unassigned[idx];
                const suggestion = findBestTeamForFlight(u.flight, scheduleResult.teamWorkload);
                if (suggestion) {
                    assignments.push({ idx, flight: u.flight, team: suggestion.team });
                    assigned++;
                } else {
                    failed++;
                }
            }
            
            if (assigned === 0) {
                statusDiv.innerHTML = '<strong style="color: #dc2626;">‚ùå Could not auto-assign any flights - all teams at capacity or outside shift times</strong>';
                return;
            }
            
            // Confirm with user
            const confirm = window.confirm(
                `Auto-Assign Summary:\n\n` +
                `‚úì ${assigned} flights can be assigned\n` +
                `‚úó ${failed} flights still cannot be assigned\n\n` +
                `Continue with assignments?`
            );
            
            if (!confirm) {
                statusDiv.innerHTML = '';
                return;
            }
            
            // Apply assignments (already ordered from high to low index to avoid shifting)
            assignments.forEach(a => {
                const unassignedFlight = scheduleResult.unassigned[a.idx];
                const flight = unassignedFlight.flight;
                
                // Add to assignments
                scheduleResult.assignments.push({
                    flight: flight,
                    team: a.team,
                    phase: 'auto_assignment'
                });
                
                // Update team workload
                const teamWorkload = scheduleResult.teamWorkload.find(tw => tw.team.id === a.team);
                if (teamWorkload) {
                    teamWorkload.operations.push(flight);
                    teamWorkload.count++;
                    teamWorkload.operations.sort((a, b) => a.timeMinutes - b.timeMinutes);
                }
                
                // Update matched schedule data
                if (matchedScheduleData) {
                    const matchedFlight = matchedScheduleData.find(item => item.Dep_Flight === flight.flight.replace('AA ', ''));
                    if (matchedFlight) {
                        matchedFlight.Team = a.team;
                    }
                }
                
                // Remove from unassigned (working backwards so indices don't shift)
                scheduleResult.unassigned.splice(a.idx, 1);
            });
            
            // Update stats
            scheduleResult.stats.assigned += assigned;
            scheduleResult.stats.unassigned = scheduleResult.unassigned.length;
            scheduleResult.stats.coveragePercent = Math.round((scheduleResult.stats.assigned / scheduleResult.stats.totalFlights) * 100);
            
            statusDiv.innerHTML = `<strong style="color: #28a745;">‚úì Successfully assigned ${assigned} flights!</strong> ${failed > 0 ? `<span style="color: #dc2626;">${failed} flights still unassigned.</span>` : ''}`;
            
            // Refresh display immediately
            displayResults(scheduleResult);
            setupTeamSearch();
            populatePrintDropdown();
            
            // Scroll to show results
            setTimeout(() => {
                const resultsSection = document.querySelector('.section-title');
                if (resultsSection) {
                    resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }, 100);
        }
        
        function assignFlightToTeam(unassignedIdx, teamId) {
            if (!scheduleResult || !scheduleResult.unassigned[unassignedIdx]) {
                alert('Error: Flight not found');
                return;
            }
            
            const unassignedFlight = scheduleResult.unassigned[unassignedIdx];
            const flight = unassignedFlight.flight;
            
            console.log(`Assigning ${flight.flight} to ${teamId}`);
            
            // Add to assignments
            scheduleResult.assignments.push({
                flight: flight,
                team: teamId,
                phase: 'manual_assignment'
            });
            
            // Update team workload
            const teamWorkload = scheduleResult.teamWorkload.find(tw => tw.team.id === teamId);
            if (teamWorkload) {
                teamWorkload.operations.push(flight);
                teamWorkload.count++;
                
                // Re-sort operations by time
                teamWorkload.operations.sort((a, b) => a.timeMinutes - b.timeMinutes);
            }
            
            // Remove from unassigned
            scheduleResult.unassigned.splice(unassignedIdx, 1);
            
            // Update stats
            scheduleResult.stats.assigned++;
            scheduleResult.stats.unassigned = scheduleResult.unassigned.length;
            scheduleResult.stats.coveragePercent = Math.round((scheduleResult.stats.assigned / scheduleResult.stats.totalFlights) * 100);
            
            // Update matched schedule data with team assignment
            if (matchedScheduleData) {
                const matchedFlight = matchedScheduleData.find(item => item.Dep_Flight === flight.flight.replace('AA ', ''));
                if (matchedFlight) {
                    matchedFlight.Team = teamId;
                }
            }
            
            // Hide unassigned section if no more unassigned flights
            if (scheduleResult.unassigned.length === 0) {
                document.getElementById('unassignedSection').style.display = 'none';
            }
            
            // Show success message
            showToast('Flight Assigned', `${flight.flight} assigned to ${teamId}`, 'success');
            
            // Force complete refresh of all displays
            console.log('Refreshing all displays...');
            displayResults(scheduleResult);
            setupTeamSearch();
            populatePrintDropdown();
            
            // Scroll to team assignments section to show the update
            setTimeout(() => {
                const resultsSection = document.querySelector('.section-title');
                if (resultsSection) {
                    resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }, 100);
            
            console.log(`Assignment complete. Unassigned remaining: ${scheduleResult.unassigned.length}`);
        }
        
        function manualAssignFlight(unassignedIdx) {
            const selectElement = document.getElementById(`manual-team-${unassignedIdx}`);
            if (!selectElement) {
                alert('Error: Could not find team selector');
                return;
            }
            
            const teamId = selectElement.value;
            if (!teamId) {
                alert('Please select a team first');
                return;
            }
            
            assignFlightToTeam(unassignedIdx, teamId);
        }

        // === END REASSIGNMENT FUNCTIONS ===
        
        function updateAssignment(index, newTeam) {
            if (!scheduleResult) return;
            
            const assignment = scheduleResult.assignments[index];
            const oldTeam = assignment.team;
            
            // Update the assignment
            assignment.team = newTeam;
            
            // Recalculate team workloads
            scheduleResult.teamWorkload.forEach(tw => {
                // Remove from old team
                if (tw.team.id === oldTeam) {
                    tw.operations = tw.operations.filter(op => op !== assignment.flight);
                    tw.count = tw.operations.length;
                }
                // Add to new team (only if it's not OVERNIGHT)
                if (tw.team.id === newTeam) {
                    tw.operations.push(assignment.flight);
                    tw.operations.sort((a, b) => a.timeMinutes - b.timeMinutes);
                    tw.count = tw.operations.length;
                }
            });
            
            // Refresh the team workload display
            updateTeamWorkloadDisplay();
            
            console.log(`Updated: ${assignment.flight.flight} from ${oldTeam} to ${newTeam}`);
        }
        
        function generateTeamDetailedView(result) {
            const container = document.getElementById('teamDetailedGroups');
            container.innerHTML = '';
            
            // First add OVERNIGHT if it exists
            const overnightFlights = result.assignments.filter(a => a.team === 'OVERNIGHT');
            if (overnightFlights.length > 0) {
                const overnightCard = createTeamDetailCard('OVERNIGHT', 'Previous Day (23:00-05:00)', overnightFlights, true);
                container.innerHTML += overnightCard;
            }
            
            // Then add all regular teams sorted by shift start time
            const sortedTeams = [...result.teamWorkload].sort((a, b) => a.team.startMinutes - b.team.startMinutes);
            
            sortedTeams.forEach(tw => {
                if (tw.count > 0) {
                    const teamAssignments = result.assignments.filter(a => a.team === tw.team.id);
                    const teamCard = createTeamDetailCard(tw.team.id, tw.team.shift, teamAssignments, false);
                    container.innerHTML += teamCard;
                }
            });
        }
        
        function createTeamDetailCard(teamId, shift, assignments, isOvernight) {
            const flights = assignments.map(a => a.flight).sort((a, b) => a.timeMinutes - b.timeMinutes);
            const firstFlight = flights[0];
            const lastFlight = flights[flights.length - 1];
            
            // Calculate timing details
            const totalSpan = lastFlight ? ((lastFlight.timeMinutes - firstFlight.timeMinutes) / 60).toFixed(1) : '0';
            const avgGap = flights.length > 1 ? 
                ((lastFlight.timeMinutes - firstFlight.timeMinutes) / (flights.length - 1)).toFixed(0) : 'N/A';
            
            // Calculate buffers between flights
            const buffers = [];
            for (let i = 1; i < flights.length; i++) {
                const gap = flights[i].timeMinutes - flights[i-1].timeMinutes;
                buffers.push(gap);
            }
            const avgBuffer = buffers.length > 0 ? (buffers.reduce((a,b) => a+b, 0) / buffers.length).toFixed(0) : 'N/A';
            const minBuffer = buffers.length > 0 ? Math.min(...buffers) : 'N/A';
            
            const flightRows = flights.map((flight, idx) => {
                const buffer = idx > 0 ? `${flights[idx].timeMinutes - flights[idx-1].timeMinutes} min` : '-';
                return `
                    <tr>
                        <td>${idx + 1}</td>
                        <td><strong>${flight.flight}</strong></td>
                        <td>${flight.destination}</td>
                        <td><strong>${flight.time}</strong></td>
                        <td><span class="status-badge status-${flight.type.toLowerCase()}">${flight.type}</span></td>
                        <td>${flight.gate}</td>
                        <td>${flight.passengers || 'N/A'}</td>
                        <td>${flight.equipment || 'N/A'}</td>
                        <td>${flight.noseNumber || 'N/A'}</td>
                        <td>${flight.arrTime || 'N/A'}</td>
                        <td>${buffer}</td>
                    </tr>
                `;
            }).join('');
            
            return `
                <div class="team-detail-card ${isOvernight ? 'overnight-card' : ''}">
                    <div class="team-detail-header">
                        <div>
                            <h3>${teamId}</h3>
                            <div style="opacity: 0.9; margin-top: 5px;">Shift: ${shift}</div>
                        </div>
                        <div class="team-detail-info">
                            <div class="team-detail-info-item">
                                <label>Operations</label>
                                <value>${flights.length}</value>
                            </div>
                            <div class="team-detail-info-item">
                                <label>Time Span</label>
                                <value>${totalSpan} hrs</value>
                            </div>
                            <div class="team-detail-info-item">
                                <label>Avg Buffer</label>
                                <value>${avgBuffer} min</value>
                            </div>
                            <div class="team-detail-info-item">
                                <label>Min Buffer</label>
                                <value>${minBuffer} min</value>
                            </div>
                            <div class="team-detail-info-item">
                                <label>First Flight</label>
                                <value>${firstFlight.time}</value>
                            </div>
                            <div class="team-detail-info-item">
                                <label>Last Flight</label>
                                <value>${lastFlight.time}</value>
                            </div>
                        </div>
                    </div>
                    <table class="team-flights-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Flight</th>
                                <th>Destination</th>
                                <th>STD</th>
                                <th>Type</th>
                                <th>Gate</th>
                                <th>PAX</th>
                                <th>Equipment</th>
                                <th>Tail #</th>
                                <th>STA</th>
                                <th>Buffer</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${flightRows}
                        </tbody>
                    </table>
                </div>
            `;
        }
        
        function updateTeamWorkloadDisplay() {
            const teamTableBody = document.getElementById('teamTableBody');
            teamTableBody.innerHTML = '';
            
            scheduleResult.teamWorkload.forEach(tw => {
                const firstFlight = tw.operations[0];
                const lastFlight = tw.operations[tw.operations.length - 1];
                const flightNumbers = tw.operations.map(op => op.flight).join(', ');
                const row = `
                    <tr>
                        <td><strong>${tw.team.id}</strong></td>
                        <td>${tw.team.shift}</td>
                        <td>${tw.count}</td>
                        <td>
                            <div class="workload-bar">
                                <div class="workload-fill" style="width: ${(tw.count / 6) * 100}%"></div>
                            </div>
                        </td>
                        <td style="font-size: 0.85em;">${flightNumbers || '-'}</td>
                        <td>${firstFlight ? firstFlight.time : '-'}</td>
                        <td>${lastFlight ? lastFlight.time : '-'}</td>
                    </tr>
                `;
                teamTableBody.innerHTML += row;
            });
            
            // Add OVERNIGHT row
            const overnightFlights = scheduleResult.assignments.filter(a => a.team === 'OVERNIGHT');
            if (overnightFlights.length > 0) {
                const overnightNumbers = overnightFlights.map(a => a.flight.flight).join(', ');
                const firstOvernight = overnightFlights[0].flight;
                const lastOvernight = overnightFlights[overnightFlights.length - 1].flight;
                const row = `
                    <tr style="background: #fff3cd;">
                        <td><strong>OVERNIGHT</strong></td>
                        <td>Previous Day</td>
                        <td>${overnightFlights.length}</td>
                        <td>
                            <div class="workload-bar">
                                <div class="workload-fill" style="width: ${(overnightFlights.length / 6) * 100}%; background: #ffc107;"></div>
                            </div>
                        </td>
                        <td style="font-size: 0.85em;">${overnightNumbers}</td>
                        <td>${firstOvernight.time}</td>
                        <td>${lastOvernight.time}</td>
                    </tr>
                `;
                teamTableBody.innerHTML = row + teamTableBody.innerHTML;
            }
            
            // Also update the team detail cards
            generateTeamDetailedView(scheduleResult);
        }
        
        // Make updateAssignment globally available
        window.updateAssignment = updateAssignment;
        
        // AI Chat Assistant
        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            if (!scheduleResult) {
                addChatMessage('Please generate a schedule first!', 'error');
                return;
            }
            
            // Clear input and disable button
            input.value = '';
            const sendBtn = document.getElementById('sendChatBtn');
            sendBtn.disabled = true;
            sendBtn.textContent = ' Thinking...';
            
            // Show user message
            addChatMessage(message, 'user');
            
            try {
                // Process the request locally using pattern matching
                const result = await processScheduleRequest(message);
                
                if (result.success) {
                    addChatMessage(result.message, 'success');
                    
                    // Apply changes if any
                    if (result.changes && result.changes.length > 0) {
                        result.changes.forEach(change => {
                            updateAssignment(change.index, change.newTeam);
                        });
                    }
                    
                    // Refresh display
                    displayResults(scheduleResult);
                } else {
                    addChatMessage(result.message, 'assistant');
                }
            } catch (error) {
                addChatMessage('Sorry, I encountered an error: ' + error.message, 'error');
            }
            
            // Re-enable button
            sendBtn.disabled = false;
            sendBtn.textContent = ' Send Request';
        }
        
        function addChatMessage(text, type) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${type}`;
            messageDiv.textContent = text;
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }
        
        async function processScheduleRequest(message) {
            const lowerMessage = message.toLowerCase();
            
            // Pattern 1: Move specific flight to team
            const movePattern = /move.*flight\s+(\d+).*to\s+(tm\d+|overnight)/i;
            const moveMatch = message.match(movePattern);
            
            if (moveMatch) {
                const flightNum = moveMatch[1];
                const targetTeam = moveMatch[2].toUpperCase();
                
                const assignmentIndex = scheduleResult.assignments.findIndex(a => 
                    a.flight.flight.includes(flightNum)
                );
                
                if (assignmentIndex === -1) {
                    return {
                        success: false,
                        message: `Flight ${flightNum} not found in current assignments. It may be unassigned.`
                    };
                }
                
                const assignment = scheduleResult.assignments[assignmentIndex];
                const oldTeam = assignment.team;
                
                return {
                    success: true,
                    message: ` Moved flight ${flightNum} from ${oldTeam} to ${targetTeam}`,
                    changes: [{ index: assignmentIndex, newTeam: targetTeam }]
                };
            }
            
            // Pattern 2: Show overloaded teams
            if (lowerMessage.includes('overload') || lowerMessage.includes('too many')) {
                const overloaded = scheduleResult.teamWorkload
                    .filter(tw => tw.count > 6)
                    .map(tw => `${tw.team.id}: ${tw.count} operations`)
                    .join(', ');
                
                if (overloaded) {
                    return {
                        success: false,
                        message: `Overloaded teams (>6 ops): ${overloaded}`
                    };
                } else {
                    return {
                        success: false,
                        message: 'No teams are currently overloaded (all have 6 operations)'
                    };
                }
            }
            
            // Pattern 3: Show underutilized teams
            if (lowerMessage.includes('underutilized') || lowerMessage.includes('under')) {
                const underutilized = scheduleResult.teamWorkload
                    .filter(tw => tw.count < 3 && tw.count > 0)
                    .map(tw => `${tw.team.id}: ${tw.count} operations`)
                    .join(', ');
                
                if (underutilized) {
                    return {
                        success: false,
                        message: `Underutilized teams (<3 ops): ${underutilized}`
                    };
                } else {
                    return {
                        success: false,
                        message: 'All teams have adequate workload (3 operations)'
                    };
                }
            }
            
            // Pattern 4: Balance workload
            if (lowerMessage.includes('balance')) {
                // Find most overloaded and least loaded teams
                const sorted = [...scheduleResult.teamWorkload].sort((a, b) => b.count - a.count);
                const mostLoaded = sorted[0];
                const leastLoaded = sorted[sorted.length - 1];
                
                if (mostLoaded.count - leastLoaded.count <= 2) {
                    return {
                        success: false,
                        message: 'Schedule is already well balanced. Max difference is 2 operations.'
                    };
                }
                
                return {
                    success: false,
                    message: `Workload spread: ${mostLoaded.team.id} has ${mostLoaded.count} ops, ${leastLoaded.team.id} has ${leastLoaded.count} ops. Consider manually moving flights between them.`
                };
            }
            
            // Pattern 5: Reassign all flights from one team to another
            const reassignPattern = /reassign.*from\s+(tm\d+).*to\s+(tm\d+)/i;
            const reassignMatch = message.match(reassignPattern);
            
            if (reassignMatch) {
                const fromTeam = reassignMatch[1].toUpperCase();
                const toTeam = reassignMatch[2].toUpperCase();
                
                const changes = [];
                scheduleResult.assignments.forEach((a, index) => {
                    if (a.team === fromTeam) {
                        changes.push({ index, newTeam: toTeam });
                    }
                });
                
                if (changes.length === 0) {
                    return {
                        success: false,
                        message: `No flights found assigned to ${fromTeam}`
                    };
                }
                
                return {
                    success: true,
                    message: ` Reassigned ${changes.length} flights from ${fromTeam} to ${toTeam}`,
                    changes: changes
                };
            }
            
            // Pattern 6: Show team details
            const teamPattern = /show.*team\s+(tm\d+|overnight)/i;
            const teamMatch = message.match(teamPattern);
            
            if (teamMatch) {
                const teamId = teamMatch[1].toUpperCase();
                const teamWorkload = scheduleResult.teamWorkload.find(tw => tw.team.id === teamId);
                
                if (!teamWorkload) {
                    const overnightFlights = scheduleResult.assignments.filter(a => a.team === 'OVERNIGHT');
                    if (teamId === 'OVERNIGHT' && overnightFlights.length > 0) {
                        const flights = overnightFlights.map(a => 
                            `${a.flight.flight} (${a.flight.time} to ${a.flight.destination})`
                        ).join(', ');
                        return {
                            success: false,
                            message: `OVERNIGHT: ${overnightFlights.length} flights - ${flights}`
                        };
                    }
                    return {
                        success: false,
                        message: `Team ${teamId} not found`
                    };
                }
                
                const flights = teamWorkload.operations.map(op => 
                    `${op.flight} (${op.time} to ${op.destination})`
                ).join(', ');
                
                return {
                    success: false,
                    message: `${teamId}: ${teamWorkload.count} operations - ${flights}`
                };
            }
            
            // Default response
            return {
                success: false,
                message: "I can help you with:\n Move flight [number] to [team]\n Show team [team]\n Show overloaded/underutilized teams\n Reassign flights from [team] to [team]\n Balance workload"
            };
        }
        
        // Allow Enter key to send message
        document.addEventListener('DOMContentLoaded', () => {
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendChatMessage();
                    }
                });
            }
        });
        
        window.sendChatMessage = sendChatMessage;

        function exportToExcel() {
            console.log('========== EXPORT FUNCTION CALLED ==========');
            
            if (!scheduleResult) {
                console.error('No scheduleResult');
                return;
            }
            console.log('[OK] Schedule exists');
            
            if (typeof XLSX === 'undefined') {
                console.error('XLSX library not loaded - export cancelled');
                console.error('XLSX library not loaded');
                return;
            }
            console.log('[OK] XLSX library loaded');

            const wb = XLSX.utils.book_new();
            const dayOfWeek = scheduleResult.dayOfWeek || 'Thursday';

            // TAB 1: Summary Statistics
            const summaryData = [
                ['PHL Catering Operations Schedule'],
                ['Day of Week', dayOfWeek],
                ['Generated', new Date().toLocaleString()],
                [''],
                ['Coverage Statistics'],
                ['Total Flights', scheduleResult.stats.totalFlights],
                ['Assigned Flights', scheduleResult.stats.assigned],
                ['Unassigned Flights', scheduleResult.stats.unassigned],
                ['Coverage Percentage', scheduleResult.stats.coveragePercent + '%'],
                [''],
                ['Flight Types'],
                ['Domestic Flights', scheduleResult.stats.domestic],
                ['International Flights', scheduleResult.stats.international],
                [''],
                ['Team Utilization'],
                ['Scheduled Teams', scheduleResult.stats.teamsDeployed],
                ['FIREHOUSE Standby Teams', 2],
                ['Total Teams Deployed', scheduleResult.stats.teamsDeployed + 2],
                ['Average Ops per Team', (scheduleResult.stats.assigned / scheduleResult.stats.teamsDeployed).toFixed(2)],
                ['Overnight Operations', scheduleResult.overnightCount || 0],
                [''],
                ['Early Morning Details'],
                ['OVERNIGHT (23:00-05:00)', 'Terminators + 2x 05:00 departures'],
                ['TM200 (03:00 start)', 'Very early departures (05:51-07:00)'],
                ['TM201 (04:00 start)', 'Early departures (06:48 onward)'],
                [''],
                ['FIREHOUSE Standby'],
                ['Morning (TM100)', '05:00-11:00 Peak'],
                ['Evening (TM106)', '15:00-21:00 Peak']
            ];
            const summarySheet = XLSX.utils.aoa_to_sheet(summaryData);
            XLSX.utils.book_append_sheet(wb, summarySheet, 'Summary');

            // TAB 2: Team Summary
            const teamSummaryData = scheduleResult.teamWorkload.map(tw => ({
                'Team': tw.team.id,
                'Department': tw.team.department,
                'Shift': tw.team.shift,
                'Team Type': tw.team.type,
                'Operations': tw.count,
                'First Flight': tw.operations[0] ? tw.operations[0].time : '',
                'Last Flight': tw.operations[tw.operations.length - 1] ? tw.operations[tw.operations.length - 1].time : '',
                'Span (hours)': tw.operations.length > 0 ? 
                    ((tw.operations[tw.operations.length - 1].timeMinutes - tw.operations[0].timeMinutes) / 60).toFixed(1) : '0'
            }));
            
            // Add OVERNIGHT if exists
            const overnightFlights = scheduleResult.assignments.filter(a => a.team === 'OVERNIGHT');
            if (overnightFlights.length > 0) {
                teamSummaryData.unshift({
                    'Team': 'OVERNIGHT',
                    'Department': 'Previous Day',
                    'Shift': '23:00-05:00',
                    'Team Type': 'OVN',
                    'Operations': overnightFlights.length,
                    'First Flight': overnightFlights[0].flight.time,
                    'Last Flight': overnightFlights[overnightFlights.length - 1].flight.time,
                    'Span (hours)': 'N/A'
                });
            }
            
            // Add FIREHOUSE standby teams to Team Summary (at the end)
            teamSummaryData.push({
                'Team': 'TM100 [FH]',
                'Department': 'U00 TRK',
                'Shift': '05:00-11:00',
                'Team Type': 'PT - FIREHOUSE',
                'Operations': 'STANDBY',
                'First Flight': 'IROPS Coverage',
                'Last Flight': 'Morning Peak',
                'Span (hours)': '06:00-10:00'
            });
            
            teamSummaryData.push({
                'Team': 'TM106 [FH]',
                'Department': 'U30 TRK',
                'Shift': '15:00-21:00',
                'Team Type': 'PT - FIREHOUSE',
                'Operations': 'STANDBY',
                'First Flight': 'IROPS Coverage',
                'Last Flight': 'Evening Peak',
                'Span (hours)': '18:00-22:00'
            });
            
            const teamSummarySheet = XLSX.utils.json_to_sheet(teamSummaryData);
            XLSX.utils.book_append_sheet(wb, teamSummarySheet, 'Team Summary');

            // TAB 3: Detailed Team Assignments (one row per flight with arrival info)
            const detailedAssignments = [];
            scheduleResult.teamWorkload.forEach(tw => {
                tw.operations.forEach((op, idx) => {
                    detailedAssignments.push({
                        'Team': tw.team.id,
                        'Shift': tw.team.shift,
                        'Sequence': idx + 1,
                        'Nose #': op.noseNumber || '',
                        'Turn Type': op.turnType || 'Overnight',
                        // Arrival Information
                        'Arr Flight': op.arrFlight || '',
                        'Arr Origin': op.arrOrigin || '',
                        'Arr Time': op.arrTime || '',
                        'Arr Gate': op.arrGate || '',
                        'Arr Equipment': op.arrEquipment || '',
                        'Arr PAX': op.arrPassengers || '',
                        // Departure Information
                        'Dep Flight': op.flight,
                        'Dep Destination': op.destination,
                        'Dep Time': op.time,
                        'Dep Gate': op.gate,
                        'Dep Equipment': op.equipment || '',
                        'Dep PAX': op.passengers || '',
                        'Dep Type': op.type
                    });
                });
            });
            
            // Add overnight
            overnightFlights.forEach((a, idx) => {
                detailedAssignments.unshift({
                    'Team': 'OVERNIGHT',
                    'Shift': 'Previous Day',
                    'Sequence': idx + 1,
                    'Nose #': a.flight.noseNumber || '',
                    'Turn Type': a.flight.turnType || 'Overnight',
                    // Arrival Information (overnight = no arrival)
                    'Arr Flight': '',
                    'Arr Origin': '',
                    'Arr Time': '',
                    'Arr Gate': '',
                    'Arr Equipment': '',
                    'Arr PAX': '',
                    // Departure Information
                    'Dep Flight': a.flight.flight,
                    'Dep Destination': a.flight.destination,
                    'Dep Time': a.flight.time,
                    'Dep Gate': a.flight.gate,
                    'Dep Equipment': a.flight.equipment || '',
                    'Dep PAX': a.flight.passengers || '',
                    'Dep Type': a.flight.type
                });
            });
            
            const detailedSheet = XLSX.utils.json_to_sheet(detailedAssignments);
            XLSX.utils.book_append_sheet(wb, detailedSheet, 'Detailed Assignments');

            // TAB 4: Chronological Flight List
            const chronologicalData = scheduleResult.assignments
                .sort((a, b) => a.flight.timeMinutes - b.flight.timeMinutes)
                .map(a => ({
                    'Time': a.flight.time,
                    'Flight': a.flight.flight,
                    'Destination': a.flight.destination,
                    'Type': a.flight.type,
                    'Team': a.team,
                    'Gate': a.flight.gate,
                    'Passengers': a.flight.passengers || '',
                    'Equipment': a.flight.equipment || '',
                    'Origin': a.flight.origin || ''
                }));
            const chronoSheet = XLSX.utils.json_to_sheet(chronologicalData);
            XLSX.utils.book_append_sheet(wb, chronoSheet, 'Chronological');

            // TAB 5: Domestic Flights Only
            const domesticData = scheduleResult.assignments
                .filter(a => a.flight.type === 'Domestic')
                .sort((a, b) => a.flight.timeMinutes - b.flight.timeMinutes)
                .map(a => ({
                    'Time': a.flight.time,
                    'Flight': a.flight.flight,
                    'Destination': a.flight.destination,
                    'Team': a.team,
                    'Gate': a.flight.gate,
                    'Passengers': a.flight.passengers || ''
                }));
            const domesticSheet = XLSX.utils.json_to_sheet(domesticData);
            XLSX.utils.book_append_sheet(wb, domesticSheet, 'Domestic');

            // TAB 6: International Flights Only
            const intlData = scheduleResult.assignments
                .filter(a => a.flight.type === 'International' || a.flight.type === 'Precleared')
                .sort((a, b) => a.flight.timeMinutes - b.flight.timeMinutes)
                .map(a => ({
                    'Time': a.flight.time,
                    'Flight': a.flight.flight,
                    'Destination': a.flight.destination,
                    'Type': a.flight.type,
                    'Team': a.team,
                    'Gate': a.flight.gate,
                    'Passengers': a.flight.passengers || ''
                }));
            const intlSheet = XLSX.utils.json_to_sheet(intlData);
            XLSX.utils.book_append_sheet(wb, intlSheet, 'International');

            // TAB 7: Team Workload Analysis
            const workloadData = scheduleResult.teamWorkload.map(tw => {
                const ops = tw.operations;
                const gaps = [];
                for (let i = 1; i < ops.length; i++) {
                    gaps.push(ops[i].timeMinutes - ops[i-1].timeMinutes);
                }
                
                return {
                    'Team': tw.team.id,
                    'Operations': tw.count,
                    'Avg Gap (min)': gaps.length > 0 ? (gaps.reduce((a,b) => a+b, 0) / gaps.length).toFixed(0) : 'N/A',
                    'Min Gap (min)': gaps.length > 0 ? Math.min(...gaps) : 'N/A',
                    'Max Gap (min)': gaps.length > 0 ? Math.max(...gaps) : 'N/A',
                    'Span (hours)': ops.length > 0 ? ((ops[ops.length-1].timeMinutes - ops[0].timeMinutes) / 60).toFixed(1) : '0',
                    'Domestic': ops.filter(o => o.type === 'Domestic').length,
                    'International': ops.filter(o => o.type === 'International' || o.type === 'Precleared').length
                };
            });
            const workloadSheet = XLSX.utils.json_to_sheet(workloadData);
            XLSX.utils.book_append_sheet(wb, workloadSheet, 'Workload Analysis');

            // TAB 8: Unassigned Flights
            if (scheduleResult.unassigned.length > 0) {
                const unassignedData = scheduleResult.unassigned.map(u => ({
                    'Time': u.flight.time,
                    'Flight': u.flight.flight,
                    'Destination': u.flight.destination,
                    'Type': u.flight.type,
                    'Gate': u.flight.gate,
                    'Passengers': u.flight.passengers || '',
                    'Reason': u.reason
                }));
                const unassignedSheet = XLSX.utils.json_to_sheet(unassignedData);
                XLSX.utils.book_append_sheet(wb, unassignedSheet, 'Unassigned');
            }

            // TAB 9: Coverage Gaps Analysis
            if (scheduleResult.coverageGaps && Object.keys(scheduleResult.coverageGaps).length > 0) {
                const gapData = [];
                Object.keys(scheduleResult.coverageGaps).sort((a,b) => a-b).forEach(hour => {
                    const flights = scheduleResult.coverageGaps[hour];
                    gapData.push({
                        'Hour': hour + ':00',
                        'Unassigned Count': flights.length,
                        'Flights': flights.join(', ')
                    });
                });
                const gapSheet = XLSX.utils.json_to_sheet(gapData);
                XLSX.utils.book_append_sheet(wb, gapSheet, 'Coverage Gaps');
            }

            // Save file with day of week in filename
            const date = new Date().toISOString().split('T')[0];
            const filename = `PHL_Schedule_${dayOfWeek}_${date}.xlsx`;
            
            console.log('[OK] All tabs created successfully');
            console.log('Attempting to save file:', filename);
            
            try {
                // Write workbook to array buffer
                const wbout = XLSX.write(wb, { 
                    bookType: 'xlsx', 
                    type: 'array',
                    bookSST: false
                });
                
                // Create blob
                const blob = new Blob([wbout], { 
                    type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' 
                });
                
                // Try modern File System Access API first (Chrome 86+, Edge 86+)
                if ('showSaveFilePicker' in window) {
                    // Modern API - shows real save dialog
                    console.log('Using File System Access API (modern save dialog)');
                    
                    window.showSaveFilePicker({
                        suggestedName: filename,
                        types: [{
                            description: 'Excel Files',
                            accept: {
                                'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': ['.xlsx']
                            }
                        }]
                    }).then(fileHandle => {
                        return fileHandle.createWritable();
                    }).then(writable => {
                        writable.write(blob);
                        return writable;
                    }).then(writable => {
                        writable.close();
                        console.log('========== EXPORT COMPLETED ==========');
                        console.log('File saved successfully via File System Access API');
                    }).catch(err => {
                        if (err.name !== 'AbortError') {
                            console.error('Save error:', err);
                            alert('Save error: ' + err.message);
                        } else {
                            console.log('User cancelled save dialog');
                        }
                    });
                } else {
                    // Fallback for older browsers
                    console.log('File System Access API not available, using fallback');
                    console.log('Note: Browser will auto-download to Downloads folder');
                    
                    // Create download link
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = filename;
                    link.style.display = 'none';
                    document.body.appendChild(link);
                    link.click();
                    
                    // Cleanup
                    setTimeout(() => {
                        document.body.removeChild(link);
                        URL.revokeObjectURL(url);
                    }, 100);
                    
                    console.log('========== EXPORT COMPLETED ==========');
                    console.log('File downloaded to Downloads folder');
                }
            } catch (error) {
                console.error('========== EXPORT FAILED ==========');
                console.error('Error:', error);
                console.error('Export failed:', error.message);
                alert('Export failed: ' + error.message);
            }
        }

        // =====================================================================
        // TOAST NOTIFICATION SYSTEM (replaces alert/confirm)
        // =====================================================================

        function showToast(title, message, type = 'info') {
            const container = document.getElementById('toastContainer');
            
            const icons = {
                success: 'Success',
                error: '[X]',
                info: '[i]',
                warning: '[!]'
            };
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-icon">${icons[type]}</div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
            `;
            
            container.appendChild(toast);
            
            // Auto-remove after 4 seconds
            setTimeout(() => {
                toast.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => toast.remove(), 300);
            }, 4000);
            
            console.log(`[${type.toUpperCase()}] ${title}: ${message}`);
        }

        // =====================================================================
        // LIVE UPDATE & REALLOCATION MODULE
        // =====================================================================

        // State management for Live Update module
        let liveUpdateState = {
            selectedFlight: null,
            selectedFlightData: null,
            currentScheduleSnapshot: null,
            currentReallocationOptions: [],
            recentUpdates: [],
            alertCounts: { critical: 0, warning: 0, resolved: 0 },
            modifications: {
                flights: {}, // flightNumber: { oldTeam, newTeam, oldTime, newTime }
                hasChanges: false
            },
            undoHistory: [] // Stack of changes for undo functionality
        };

        // Toggle Live Update Panel
        document.getElementById('liveUpdateToggle').addEventListener('click', () => {
            const panel = document.getElementById('liveUpdatePanel');
            const icon = document.getElementById('toggleIcon');
            
            if (panel.classList.contains('expanded')) {
                panel.classList.remove('expanded');
                icon.classList.remove('expanded');
            } else {
                panel.classList.add('expanded');
                icon.classList.add('expanded');
                
                // Take a snapshot of current schedule if not already done
                if (!liveUpdateState.currentScheduleSnapshot && scheduleResult) {
                    liveUpdateState.currentScheduleSnapshot = JSON.parse(JSON.stringify(scheduleResult));
                    console.log('[OK] Schedule snapshot created for live updates');
                }
            }
        });

        // Flight Search Functionality with dropdown suggestions
        document.getElementById('flightSearchInput').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase().trim();
            
            if (searchTerm.length < 2) {
                document.getElementById('flightUpdateCard').style.display = 'none';
                hideSearchDropdown();
                return;
            }

            // Check if schedule exists
            if (!scheduleResult || !scheduleResult.assignments) {
                console.log('[!] No schedule generated yet - please generate schedule first');
                console.log('scheduleResult:', scheduleResult);
                showSearchMessage('Please generate a schedule first before searching flights');
                return;
            }

            console.log(`Searching for: "${searchTerm}" in ${scheduleResult.assignments.length} flights`);

            // Search through all assigned flights
            const matches = scheduleResult.assignments.filter(assignment => {
                const flightNum = (assignment.flight.flight || '').toLowerCase();
                const dest = (assignment.flight.destination || '').toLowerCase();
                const match = flightNum.includes(searchTerm) || dest.includes(searchTerm);
                if (match) {
                    console.log(`[OK] Match found: ${assignment.flight.flight} to ${assignment.flight.destination}`);
                }
                return match;
            });

            console.log(`Found ${matches.length} matches`);

            if (matches.length > 0) {
                showSearchDropdown(matches, searchTerm);
            } else {
                showSearchMessage(`No flights found matching "${searchTerm}"`);
            }
        });

        function showSearchDropdown(matches, searchTerm) {
            // Remove existing dropdown if any
            hideSearchDropdown();
            
            // Create dropdown
            const dropdown = document.createElement('div');
            dropdown.id = 'searchDropdown';
            dropdown.style.cssText = `
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                border: 2px solid #3b82f6;
                border-top: none;
                border-radius: 0 0 6px 6px;
                max-height: 300px;
                overflow-y: auto;
                z-index: 1000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            `;
            
            // Add matches to dropdown (limit to 10)
            matches.slice(0, 10).forEach(assignment => {
                const flight = assignment.flight;
                const item = document.createElement('div');
                item.style.cssText = `
                    padding: 12px;
                    cursor: pointer;
                    border-bottom: 1px solid #e2e8f0;
                    transition: background 0.2s;
                `;
                item.innerHTML = `
                    <div style="font-weight: 600; color: #1e293b;">${flight.flight}</div>
                    <div style="font-size: 0.85em; color: #64748b;">
                        ${flight.destination} &bull; ${flight.time} &bull; ${assignment.team || 'Unassigned'}
                    </div>
                `;
                item.addEventListener('mouseover', () => {
                    item.style.background = '#f8fafc';
                });
                item.addEventListener('mouseout', () => {
                    item.style.background = 'white';
                });
                item.addEventListener('click', () => {
                    // Store the flight data
                    const selectedFlight = flight.flight;
                    const selectedAssignment = assignment;
                    
                    // Close the dropdown first
                    hideSearchDropdown();
                    
                    // Set the search input to show the full flight number
                    document.getElementById('flightSearchInput').value = selectedFlight;
                    
                    // Then populate the card (slight delay to ensure dropdown is closed)
                    setTimeout(() => {
                        populateFlightUpdateCard(selectedAssignment);
                    }, 50);
                });
                dropdown.appendChild(item);
            });
            
            // Show count if more than 10
            if (matches.length > 10) {
                const moreItem = document.createElement('div');
                moreItem.style.cssText = 'padding: 8px; text-align: center; color: #64748b; font-size: 0.85em; font-style: italic;';
                moreItem.textContent = `+ ${matches.length - 10} more results...`;
                dropdown.appendChild(moreItem);
            }
            
            document.getElementById('flightSearchInput').parentElement.appendChild(dropdown);
        }

        function hideSearchDropdown() {
            const existing = document.getElementById('searchDropdown');
            if (existing) {
                existing.remove();
            }
        }

        function showSearchMessage(message) {
            hideSearchDropdown();
            const dropdown = document.createElement('div');
            dropdown.id = 'searchDropdown';
            dropdown.style.cssText = `
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: #fef3c7;
                border: 2px solid #fcd34d;
                border-top: none;
                border-radius: 0 0 6px 6px;
                padding: 12px;
                z-index: 1000;
                color: #92400e;
                font-size: 0.9em;
            `;
            dropdown.textContent = message;
            document.getElementById('flightSearchInput').parentElement.appendChild(dropdown);
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            const searchBox = document.getElementById('flightSearchInput');
            const dropdown = document.getElementById('searchDropdown');
            if (dropdown && !searchBox.contains(e.target) && e.target !== dropdown && !dropdown.contains(e.target)) {
                hideSearchDropdown();
            }
        });

        // Populate Flight Update Card with selected flight data
        function populateFlightUpdateCard(assignment) {
            document.getElementById('flightUpdateCard').style.display = 'block';
            
            const flight = assignment.flight;
            
            // Store selected flight
            liveUpdateState.selectedFlight = flight.flight;
            liveUpdateState.selectedFlightData = assignment;

            console.log(' Populating card for:', flight.flight, assignment);

            // Populate card fields
            document.getElementById('selectedFlightNumber').textContent = flight.flight;
            document.getElementById('selectedDestination').textContent = flight.destination || 'N/A';
            document.getElementById('selectedSTD').textContent = flight.time;  // Changed from flight.std
            document.getElementById('selectedTeam').textContent = assignment.team || 'Unassigned';
            
            const flightType = (flight.region === 'Caribbean' || flight.region === 'Central America' || 
                              flight.region === 'South America' || flight.region === 'Europe' || 
                              flight.region === 'Middle East' || flight.region === 'Asia') ? 'INTERNATIONAL' : 'DOMESTIC';
            
            const typeElement = document.getElementById('selectedFlightType');
            typeElement.textContent = flightType;
            typeElement.className = 'flight-type-badge' + (flightType === 'INTERNATIONAL' ? ' international' : '');

            // Find team's current ops load
            const teamWorkload = scheduleResult.teamWorkload.find(tw => tw.team.id === assignment.team);
            document.getElementById('selectedOpsLoad').textContent = teamWorkload ? `${teamWorkload.operations.length} flights` : 'N/A';

            // Set STD input (disabled)
            document.getElementById('stdInput').value = flight.time;  // Changed from flight.std
            
            // Clear ETD and delay
            document.getElementById('etdInput').value = '';
            document.getElementById('delayAmount').textContent = '+0 minutes';
            document.getElementById('delayReason').value = '';
        }

        // Calculate delay when ETD changes
        document.getElementById('etdInput').addEventListener('input', calculateDelay);

        function calculateDelay() {
            const stdInput = document.getElementById('stdInput').value;
            const etdInput = document.getElementById('etdInput').value;

            if (!stdInput || !etdInput) {
                document.getElementById('delayAmount').textContent = '+0 minutes';
                return;
            }

            // Parse times
            const std = new Date(`2000-01-01T${stdInput}`);
            const etd = new Date(`2000-01-01T${etdInput}`);

            // Calculate difference in minutes
            const diffMs = etd - std;
            const diffMins = Math.round(diffMs / 60000);

            const delayText = diffMins > 0 ? `+${diffMins} minutes` : 
                            diffMins < 0 ? `${diffMins} minutes (EARLY)` : 
                            'On Time';

            document.getElementById('delayAmount').textContent = delayText;
        }

        // Analyze Impact Button
        document.getElementById('analyzeBtn').addEventListener('click', analyzeFlightImpact);

        function analyzeFlightImpact() {
            console.log('=== ANALYZE IMPACT CLICKED ===');
            console.log('selectedFlightData:', liveUpdateState.selectedFlightData);
            
            if (!liveUpdateState.selectedFlightData) {
                showToast('No Flight Selected', 'Please select a flight first', 'warning');
                return;
            }

            const etd = document.getElementById('etdInput').value;
            console.log('ETD input value:', etd);
            
            if (!etd) {
                showToast('Missing ETD', 'Please enter a new ETD time', 'warning');
                return;
            }

            console.log('scheduleResult:', scheduleResult);
            console.log('teamWorkload:', scheduleResult ? scheduleResult.teamWorkload : 'null');

            // Show analyzing status
            document.getElementById('analysisStatus').style.display = 'flex';

            // Simulate analysis delay for UX
            setTimeout(() => {
                try {
                    performImpactAnalysis(etd);
                    document.getElementById('analysisStatus').style.display = 'none';
                    // Analysis complete - no toast needed
                } catch (error) {
                    console.error('ERROR in performImpactAnalysis:', error);
                    showToast('Analysis Error', error.message, 'error');
                    document.getElementById('analysisStatus').style.display = 'none';
                }
            }, 800);
        }

        function performImpactAnalysis(newETD) {
            console.log('=== PERFORMING IMPACT ANALYSIS ===');
            const assignment = liveUpdateState.selectedFlightData;
            console.log('Assignment:', assignment);
            
            const flight = assignment.flight;
            console.log('Flight:', flight);
            
            const currentTeamId = assignment.team;
            console.log('Current Team ID:', currentTeamId);
            
            // Store the new ETD for potential application
            liveUpdateState.pendingETD = newETD;
            
            // Find current team in schedule
            console.log('Looking for team in teamWorkload...');
            console.log('Available teams:', scheduleResult.teamWorkload.map(tw => tw.team.id));
            
            const teamData = scheduleResult.teamWorkload.find(tw => tw.team.id === currentTeamId);
            
            if (!teamData) {
                console.error('[X] Team not found:', currentTeamId);
                const impactContent = document.getElementById('impactContent');
                impactContent.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #ef4444;">
                        <p style="font-size: 2em; margin-bottom: 10px;">[!]</p>
                        <p>Team ${currentTeamId} not found in schedule data</p>
                    </div>
                `;
                return;
            }

            console.log(' Team data found:', teamData.team.id, 'with', teamData.operations.length, 'flights');

            // Analyze timing conflicts
            console.log('Analyzing timing conflicts...');
            const conflicts = analyzeTimingConflicts(flight, newETD, teamData);
            console.log('Conflicts found:', conflicts);
            
            // Find alternative teams
            console.log('Finding alternative teams...');
            const alternatives = findAlternativeTeams(flight, newETD);
            console.log('Alternatives found:', alternatives);
            
            // Generate reallocation options
            console.log('Generating reallocation options...');
            const options = generateReallocationOptions(assignment, newETD, teamData, conflicts, alternatives);
            console.log('Options generated:', options);
            
            // Display results
            console.log('Displaying results...');
            displayImpactResults(conflicts, alternatives, options, teamData);
            console.log('=== IMPACT ANALYSIS COMPLETE ===');
        }

        // Apply ETD time change to the schedule
        function applyETDChange(flightNumber, newETD) {
            console.log(`Applying ETD change for ${flightNumber} to ${newETD}`);
            
            // Find the flight in assignments
            const assignment = scheduleResult.assignments.find(
                a => a.flight.flight === flightNumber
            );
            
            if (assignment) {
                const oldTime = assignment.flight.time;
                assignment.flight.time = newETD;
                
                // Recalculate timeMinutes
                assignment.flight.timeMinutes = timeToMinutes(newETD);
                
                // Track modification
                if (!liveUpdateState.modifications.flights[flightNumber]) {
                    liveUpdateState.modifications.flights[flightNumber] = {
                        flightNumber: flightNumber,
                        destination: assignment.flight.destination,
                        oldTime: oldTime,
                        newTime: newETD
                    };
                } else {
                    liveUpdateState.modifications.flights[flightNumber].oldTime = oldTime;
                    liveUpdateState.modifications.flights[flightNumber].newTime = newETD;
                }
                
                liveUpdateState.modifications.hasChanges = true;
                
                console.log(`[OK] ETD updated from ${oldTime} to ${newETD}`);
                return true;
            }
            
            return false;
        }


        function evaluateTeamFitForLiveUpdate(teamData, targetFlight, newETD, options = {}) {
            const conflictDetails = [];
            const excludeFlightNumber = options.excludeFlightNumber || targetFlight.flight;
            const updatedDepartureMinutes = timeToMinutes(newETD);

            if (!updatedDepartureMinutes || updatedDepartureMinutes < 0) {
                conflictDetails.push({
                    type: 'input',
                    reason: `Unable to parse ETD "${newETD}"`
                });
                return { fits: false, conflicts: conflictDetails };
            }

            const updatedFlight = {
                ...targetFlight,
                time: newETD,
                timeMinutes: updatedDepartureMinutes
            };

            const serviceStart = updatedDepartureMinutes - getServiceBufferMinutes(updatedFlight.type);
            const teamReadyTime = teamData.team.startMinutes + SCHEDULER_CONFIG.teams.prepMinutesStandard;
            const shiftEnd = teamData.team.startMinutes + (SCHEDULER_CONFIG.teams.shiftHours * 60);

            if (serviceStart < teamReadyTime) {
                conflictDetails.push({
                    type: 'availability',
                    reason: `Service starts at ${minutesToTime(serviceStart)} before ${teamData.team.id} is ready at ${minutesToTime(teamReadyTime)}`,
                    required: `>= ${minutesToTime(teamReadyTime)}`
                });
            }

            // Live update policy: delayed departure must remain inside scheduled shift window
            if (updatedDepartureMinutes > shiftEnd) {
                conflictDetails.push({
                    type: 'availability',
                    reason: `Departure ${newETD} is beyond ${teamData.team.id} shift end ${minutesToTime(shiftEnd)}`,
                    required: `<= ${minutesToTime(shiftEnd)}`
                });
            }

            const remainingOps = teamData.operations.filter(op => op.flight !== excludeFlightNumber);
            const projectedOps = remainingOps.length + 1;
            if (projectedOps > SCHEDULER_CONFIG.teams.workloadLimitStandard) {
                conflictDetails.push({
                    type: 'capacity',
                    reason: `${teamData.team.id} would exceed workload limit (${projectedOps}/${SCHEDULER_CONFIG.teams.workloadLimitStandard})`
                });
            }

            remainingOps.forEach(op => {
                const departureGap = Math.abs(updatedFlight.timeMinutes - op.timeMinutes);
                const updatedServiceStart = updatedFlight.timeMinutes - getServiceBufferMinutes(updatedFlight.type);
                const existingServiceStart = op.timeMinutes - getServiceBufferMinutes(op.type);
                const serviceGap = Math.abs(updatedServiceStart - existingServiceStart);

                if (departureGap < SCHEDULER_CONFIG.spacing.standardMinGap || serviceGap < SCHEDULER_CONFIG.spacing.standardMinGap) {
                    conflictDetails.push({
                        type: 'buffer',
                        flight: op.flight,
                        time: op.time,
                        gap: Math.min(departureGap, serviceGap),
                        required: SCHEDULER_CONFIG.spacing.standardMinGap,
                        reason: `Minimum separation ${SCHEDULER_CONFIG.spacing.standardMinGap} min not met`
                    });
                }

                if ((updatedFlight.type === 'International' || updatedFlight.type === 'Precleared') && op.type === 'Domestic' && departureGap < SCHEDULER_CONFIG.spacing.standardIntlAfterDomesticGap) {
                    conflictDetails.push({
                        type: 'buffer',
                        flight: op.flight,
                        time: op.time,
                        gap: departureGap,
                        required: SCHEDULER_CONFIG.spacing.standardIntlAfterDomesticGap,
                        reason: `International after domestic requires ${SCHEDULER_CONFIG.spacing.standardIntlAfterDomesticGap} min`
                    });
                }

                if ((updatedFlight.type === 'International' || updatedFlight.type === 'Precleared') && (op.type === 'International' || op.type === 'Precleared') && departureGap < SCHEDULER_CONFIG.spacing.standardIntlAfterIntlGap) {
                    conflictDetails.push({
                        type: 'buffer',
                        flight: op.flight,
                        time: op.time,
                        gap: departureGap,
                        required: SCHEDULER_CONFIG.spacing.standardIntlAfterIntlGap,
                        reason: `International-to-international requires ${SCHEDULER_CONFIG.spacing.standardIntlAfterIntlGap} min`
                    });
                }
            });

            return {
                fits: conflictDetails.length === 0,
                conflicts: conflictDetails,
                projectedOps,
                serviceStart,
                teamReadyTime,
                shiftEnd
            };
        }

        function analyzeTimingConflicts(flight, newETD, teamData) {
            console.log(`=== Analyzing conflicts for ${flight.flight} with new ETD ${newETD} ===`);
            const evaluation = evaluateTeamFitForLiveUpdate(teamData, flight, newETD);
            console.log('Live-fit evaluation:', evaluation);

            return evaluation.conflicts.map(conflict => ({
                flight: conflict.flight || 'SHIFT/CAPACITY',
                time: conflict.time || '-',
                gap: conflict.gap ?? '-',
                required: conflict.required ?? '-',
                reason: conflict.reason
            }));
        }

        function findAlternativeTeams(flight, newETD) {
            const alternatives = [];

            // Check each team for availability
            scheduleResult.teamWorkload.forEach(teamData => {
                const currentAssignment = liveUpdateState.selectedFlightData;
                if (teamData.team.id === currentAssignment.team) return; // Skip current team

                const evaluation = evaluateTeamFitForLiveUpdate(teamData, flight, newETD, {
                    excludeFlightNumber: null
                });

                if (evaluation.fits) {
                    alternatives.push({
                        team: teamData.team.id,
                        currentOps: teamData.operations.length,
                        minGap: 'N/A',
                        projectedOps: evaluation.projectedOps
                    });
                }
            });

            // Sort by current ops (prefer less loaded teams)
            alternatives.sort((a, b) => a.currentOps - b.currentOps);

            console.log(`Found ${alternatives.length} alternative teams`);
            return alternatives.slice(0, 3); // Top 3 alternatives
        }

        function generateReallocationOptions(assignment, newETD, currentTeamData, conflicts, alternatives) {
            const options = [];
            const flight = assignment.flight;
            
            // Option A: Reassign to alternative team (if available)
            if (alternatives.length > 0) {
                const bestAlt = alternatives[0];
                options.push({
                    type: 'reassign',
                    recommended: conflicts.length > 0, // [OK] FIX: Only recommend if conflicts exist
                    title: `Option A: Reassign to ${bestAlt.team}`,
                    description: conflicts.length > 0 
                        ? `Move ${flight.flight} from ${currentTeamData.team.id} to ${bestAlt.team}. Eliminates ${conflicts.length} timing conflict(s), maintains balanced workload, and preserves all buffer requirements.`
                        : `Alternative option: Move ${flight.flight} to ${bestAlt.team} if preferred. Current team ${currentTeamData.team.id} works fine, but ${bestAlt.team} is also available with ${bestAlt.currentOps} operations.`,
                    stats: {
                        conflicts: conflicts.length > 0 ? `Resolves ${conflicts.length}` : 'None',
                        newTeamOps: bestAlt.currentOps + 1,
                        oldTeamOps: currentTeamData.operations.length - 1
                    }
                });
            }
            
            // Option B: Keep on current team (if no major conflicts)
            if (conflicts.length === 0) {
                options.push({
                    type: 'keep',
                    recommended: true, // [OK] FIX: Recommend keeping when there are no conflicts
                    title: `Option B: Keep on ${currentTeamData.team.id}`,
                    description: `Flight ${flight.flight} remains on ${currentTeamData.team.id}. No timing conflicts with new ETD. Team workload stays balanced at ${currentTeamData.operations.length} operations.`,
                    stats: {
                        conflicts: 'None',
                        newTeamOps: currentTeamData.operations.length,
                        oldTeamOps: currentTeamData.operations.length
                    }
                });
            } else {
                options.push({
                    type: 'keep_adjust',
                    recommended: false,
                    title: `Option B: Keep on ${currentTeamData.team.id} + Adjust`,
                    description: `Keep ${flight.flight} on ${currentTeamData.team.id}, but reassign ${conflicts.length} conflicting flight(s) to different teams. Creates cascade of ${conflicts.length + 1} total reassignments.`,
                    stats: {
                        conflicts: `! ${conflicts.length} changes`,
                        newTeamOps: currentTeamData.operations.length,
                        oldTeamOps: 'Multiple'
                    }
                });
            }
            
            return options;
        }

        function displayImpactResults(conflicts, alternatives, options, currentTeamData) {
            const impactContent = document.getElementById('impactContent');
            
            let html = '';
            
            const assignment = liveUpdateState.selectedFlightData;
            const flight = assignment.flight;
            
            // Affected Teams Section
            html += '<div class="impact-section-box">';
            html += '<div class="impact-section-title">[!] Affected Teams & Conflicts</div>';
            
            if (conflicts.length > 0) {
                html += '<div class="team-impact-card">';
                html += `<div class="team-impact-name">${assignment.team} (Current Assignment)</div>`;
                html += '<div class="team-impact-details">';
                html += `With the delay, ${assignment.team} now has ${conflicts.length} buffer conflict(s):<br>`;
                conflicts.forEach(c => {
                    html += `&bull; ${c.flight} at ${c.time} - only ${c.gap} min gap (need ${c.required} min)<br>`;
                    if (c.reason) {
                        html += `&nbsp;&nbsp;<span style="font-size: 0.9em; color: #64748b;">${c.reason}</span><br>`;
                    }
                });
                html += `Team total workload: ${currentTeamData.operations.length} ops<br>`;
                html += '<span class="conflict-tag">[!] TIMING CONFLICT</span>';
                html += '</div></div>';
            } else {
                html += '<div class="team-impact-card no-conflict">';
                html += `<div class="team-impact-name">${assignment.team} (Current Assignment)</div>`;
                html += '<div class="team-impact-details">';
                html += `No timing conflicts with the delayed departure time.<br>`;
                html += `All buffer requirements maintained.<br>`;
                html += `Team total workload: ${currentTeamData.operations.length} ops<br>`;
                html += '<span class="conflict-tag success">[OK] NO CONFLICTS</span>';
                html += '</div></div>';
            }
            
            // Show best alternative if available
            if (alternatives && alternatives.length > 0) {
                const alt = alternatives[0];
                html += '<div class="team-impact-card no-conflict">';
                html += `<div class="team-impact-name">${alt.team} (Available Alternative)</div>`;
                html += '<div class="team-impact-details">';
                html += `${alt.team} is available and can accommodate this flight:<br>`;
                html += `&bull; Current workload: ${alt.currentOps} ops -> would increase to ${alt.currentOps + 1}<br>`;
                html += `&bull; Maintains all buffer requirements<br>`;
                html += `&bull; Balanced team distribution<br>`;
                html += '<span class="conflict-tag success">[OK] PERFECT FIT</span>';
                html += '</div></div>';
            }
            
            html += '</div>';
            
            // Reallocation Options
            if (options && options.length > 0) {
                html += '<div class="impact-section-box">';
                html += '<div class="impact-section-title">Reallocation Options</div>';
                html += '<div class="reallocation-options-grid">';
                
                options.forEach((option, index) => {
                    const cardClass = option.recommended ? 'option-card recommended' : 'option-card';
                    html += `<div class="${cardClass}" onclick="applyReallocationOption(${index})" style="cursor: pointer;">`;
                    if (option.recommended) {
                        html += '<div class="recommended-tag">&#9733; RECOMMENDED</div>';
                    }
                    html += '<div class="option-header">';
                    html += `<div class="option-title-text">${option.title}</div>`;
                    html += '</div>';
                    html += `<div class="option-impact-description">${option.description}</div>`;
                    html += '<div class="option-stats-grid">';
                    html += '<div class="stat-box">';
                    html += `<div class="stat-value-text">${option.stats.conflicts}</div>`;
                    html += '<div class="stat-label-text">Conflicts</div>';
                    html += '</div>';
                    html += '<div class="stat-box">';
                    html += `<div class="stat-value-text">${option.stats.newTeamOps}</div>`;
                    html += '<div class="stat-label-text">New Team Ops</div>';
                    html += '</div>';
                    html += '<div class="stat-box">';
                    html += `<div class="stat-value-text">${option.stats.oldTeamOps}</div>`;
                    html += '<div class="stat-label-text">Old Team Ops</div>';
                    html += '</div>';
                    html += '</div></div>';
                });
                
                html += '</div></div>';
            }
            
            impactContent.innerHTML = html;
            
            // Store options for click handler access
            liveUpdateState.currentReallocationOptions = options;
        }

        // Apply Reallocation Option (called when option card is clicked)
        window.applyReallocationOption = function(optionIndex) {
            const option = liveUpdateState.currentReallocationOptions[optionIndex];
            const assignment = liveUpdateState.selectedFlightData;
            const flight = assignment.flight;
            
            console.log('=== APPLYING REALLOCATION OPTION ===');
            console.log('Option:', option);
            console.log('Flight:', flight.flight);
            console.log('Current Team:', assignment.team);
            
            switch(option.type) {
                case 'reassign':
                    // Extract team name from title (e.g., "Option A: Reassign to TM204")
                    const newTeam = option.title.match(/to (TM\d+)/)[1];
                    const oldTeam = assignment.team;
                    
                    console.log(`Reassigning ${flight.flight} from ${oldTeam} to ${newTeam}`);
                    
                    // Apply ETD change if there is one
                    if (liveUpdateState.pendingETD && liveUpdateState.pendingETD !== flight.time) {
                        applyETDChange(flight.flight, liveUpdateState.pendingETD);
                        console.log(`[OK] ETD also updated to ${liveUpdateState.pendingETD}`);
                    }
                    
                    // 1. Find and update the assignment in scheduleResult.assignments
                    const assignmentToUpdate = scheduleResult.assignments.find(
                        a => a.flight.flight === flight.flight
                    );
                    
                    if (assignmentToUpdate) {
                        assignmentToUpdate.team = newTeam;
                        console.log(' Assignment updated');
                    }
                    
                    // 2. Update old team's operations (remove flight)
                    const oldTeamData = scheduleResult.teamWorkload.find(
                        tw => tw.team.id === oldTeam
                    );
                    
                    if (oldTeamData) {
                        oldTeamData.operations = oldTeamData.operations.filter(
                            op => op.flight !== flight.flight
                        );
                        oldTeamData.count = oldTeamData.operations.length;
                        console.log(`[OK] Removed from ${oldTeam}, now has ${oldTeamData.count} ops`);
                    }
                    
                    // 3. Update new team's operations (add flight)
                    const newTeamData = scheduleResult.teamWorkload.find(
                        tw => tw.team.id === newTeam
                    );
                    
                    if (newTeamData) {
                        // Add the updated flight (with new time if changed)
                        newTeamData.operations.push(assignmentToUpdate.flight);
                        // Sort operations by time to maintain chronological order
                        newTeamData.operations.sort((a, b) => a.timeMinutes - b.timeMinutes);
                        newTeamData.count = newTeamData.operations.length;
                        console.log(` Added to ${newTeam}, now has ${newTeamData.count} ops`);
                    }
                    
                    // 4. Track modification
                    if (!liveUpdateState.modifications.flights[flight.flight]) {
                        liveUpdateState.modifications.flights[flight.flight] = {
                            oldTeam: oldTeam,
                            newTeam: newTeam,
                            flightNumber: flight.flight,
                            destination: flight.destination,
                            time: liveUpdateState.pendingETD || flight.time
                        };
                    } else {
                        liveUpdateState.modifications.flights[flight.flight].newTeam = newTeam;
                    }
                    
                    if (liveUpdateState.pendingETD && liveUpdateState.pendingETD !== flight.time) {
                        liveUpdateState.modifications.flights[flight.flight].oldTime = flight.time;
                        liveUpdateState.modifications.flights[flight.flight].newTime = liveUpdateState.pendingETD;
                    }
                    
                    liveUpdateState.modifications.hasChanges = true;
                    
                    // Track for undo
                    liveUpdateState.undoHistory.push({
                        type: 'reassign',
                        flightNumber: flight.flight,
                        oldTeam: oldTeam,
                        newTeam: newTeam,
                        oldTime: flight.time,
                        newTime: liveUpdateState.pendingETD || flight.time,
                        description: `${flight.flight} reassigned from ${oldTeam} to ${newTeam}`
                    });
                    
                    // 5. Refresh ALL displays
                    console.log('Refreshing schedule display...');
                    displayResults(scheduleResult);
                    setupTeamSearch();
                    populatePrintDropdown();
                    
                    // 6. Show modified banner
                    document.getElementById('modifiedBanner').classList.add('visible');
                    
                    // 7. Highlight modified rows
                    highlightModifiedFlights();
                    
                    // 8. Show success notification
                    const timeChange = liveUpdateState.pendingETD && liveUpdateState.pendingETD !== flight.time 
                        ? ` and time updated to ${liveUpdateState.pendingETD}` 
                        : '';
                    showToast(
                        'Reallocation Applied',
                        `${flight.flight} reassigned from ${oldTeam} to ${newTeam}${timeChange}`,
                        'success'
                    );
                    addRecentUpdate(`${flight.flight} reassigned -> ${oldTeam} to ${newTeam}${timeChange}`);
                    liveUpdateState.alertCounts.resolved++;
                    
                    // Clear pending ETD
                    liveUpdateState.pendingETD = null;
                    break;
                    
                case 'keep':
                    console.log(`=== KEEPING ${flight.flight} ON ${assignment.team} ===`);
                    
                    // [OK] FIX: Apply ETD change if there is one
                    if (liveUpdateState.pendingETD && liveUpdateState.pendingETD !== flight.time) {
                        const oldTime = flight.time;
                        
                        // Update flight time in assignment
                        applyETDChange(flight.flight, liveUpdateState.pendingETD);
                        console.log(`[OK] ETD updated from ${oldTime} to ${liveUpdateState.pendingETD}`);
                        
                        // CRITICAL FIX: Also update the flight in the team's operations array
                        const teamData = scheduleResult.teamWorkload.find(
                            tw => tw.team.id === assignment.team
                        );
                        
                        if (teamData) {
                            // Find the flight in the team's operations
                            const flightInTeam = teamData.operations.find(
                                op => op.flight === flight.flight
                            );
                            
                            if (flightInTeam) {
                                // Update the time and timeMinutes in the team's operations array
                                flightInTeam.time = liveUpdateState.pendingETD;
                                const timeParts = liveUpdateState.pendingETD.split(':');
                                flightInTeam.timeMinutes = parseInt(timeParts[0]) * 60 + parseInt(timeParts[1]);
                                
                                // Re-sort operations by time to maintain chronological order
                                teamData.operations.sort((a, b) => a.timeMinutes - b.timeMinutes);
                                console.log(`[OK] Team ${assignment.team} operations updated and re-sorted`);
                            }
                        }
                        
                        // Track modification
                        liveUpdateState.modifications.flights[flight.flight] = {
                            oldTeam: assignment.team,
                            newTeam: assignment.team,  // Same team
                            oldTime: oldTime,
                            newTime: liveUpdateState.pendingETD,
                            flightNumber: flight.flight,
                            destination: flight.destination,
                            time: liveUpdateState.pendingETD
                        };
                        
                        liveUpdateState.modifications.hasChanges = true;
                        
                        // Track for undo
                        liveUpdateState.undoHistory.push({
                            type: 'reassign',
                            flightNumber: flight.flight,
                            oldTeam: assignment.team,
                            newTeam: assignment.team,
                            oldTime: oldTime,
                            newTime: liveUpdateState.pendingETD,
                            description: `${flight.flight} time updated to ${liveUpdateState.pendingETD}`
                        });
                        
                        // Refresh displays
                        console.log('Refreshing schedule display...');
                        displayResults(scheduleResult);
                        setupTeamSearch();
                        populatePrintDropdown();
                        
                        // Show modified banner
                        document.getElementById('modifiedBanner').classList.add('visible');
                        
                        // Highlight modified rows
                        highlightModifiedFlights();
                        
                        showToast(
                            'Time Updated',
                            `${flight.flight} time updated to ${liveUpdateState.pendingETD} on ${assignment.team}`,
                            'success'
                        );
                        addRecentUpdate(`${flight.flight} time &rarr; ${liveUpdateState.pendingETD} (kept on ${assignment.team})`);
                        
                        // Clear pending ETD
                        liveUpdateState.pendingETD = null;
                    } else {
                        // No time change, truly no changes needed
                        showToast(
                            'No Changes Needed',
                            `${flight.flight} will remain on ${assignment.team}`,
                            'info'
                        );
                        addRecentUpdate(`${flight.flight} kept on ${assignment.team} (no conflicts)`);
                    }
                    
                    liveUpdateState.alertCounts.resolved++;
                    break;
                    
                case 'keep_adjust':
                    console.log(`=== KEEPING ${flight.flight} ON ${assignment.team} WITH ADJUSTMENTS ===`);
                    
                    // Apply ETD change if there is one (same logic as 'keep' case)
                    if (liveUpdateState.pendingETD && liveUpdateState.pendingETD !== flight.time) {
                        const oldTime = flight.time;
                        
                        // Update flight time in assignment
                        applyETDChange(flight.flight, liveUpdateState.pendingETD);
                        console.log(`[OK] ETD updated from ${oldTime} to ${liveUpdateState.pendingETD}`);
                        
                        // CRITICAL FIX: Also update the flight in the team's operations array
                        const teamData = scheduleResult.teamWorkload.find(
                            tw => tw.team.id === assignment.team
                        );
                        
                        if (teamData) {
                            // Find the flight in the team's operations
                            const flightInTeam = teamData.operations.find(
                                op => op.flight === flight.flight
                            );
                            
                            if (flightInTeam) {
                                // Update the time and timeMinutes in the team's operations array
                                flightInTeam.time = liveUpdateState.pendingETD;
                                const timeParts = liveUpdateState.pendingETD.split(':');
                                flightInTeam.timeMinutes = parseInt(timeParts[0]) * 60 + parseInt(timeParts[1]);
                                
                                // Re-sort operations by time to maintain chronological order
                                teamData.operations.sort((a, b) => a.timeMinutes - b.timeMinutes);
                                console.log(`[OK] Team ${assignment.team} operations updated and re-sorted`);
                            }
                        }
                        
                        // Track modification
                        liveUpdateState.modifications.flights[flight.flight] = {
                            oldTeam: assignment.team,
                            newTeam: assignment.team,  // Same team
                            oldTime: oldTime,
                            newTime: liveUpdateState.pendingETD,
                            flightNumber: flight.flight,
                            destination: flight.destination,
                            time: liveUpdateState.pendingETD
                        };
                        
                        liveUpdateState.modifications.hasChanges = true;
                        
                        // Track for undo
                        liveUpdateState.undoHistory.push({
                            type: 'reassign',
                            flightNumber: flight.flight,
                            oldTeam: assignment.team,
                            newTeam: assignment.team,
                            oldTime: oldTime,
                            newTime: liveUpdateState.pendingETD,
                            description: `${flight.flight} time updated to ${liveUpdateState.pendingETD} (cascade adjustments)`
                        });
                        
                        // Refresh displays
                        console.log('Refreshing schedule display...');
                        displayResults(scheduleResult);
                        setupTeamSearch();
                        populatePrintDropdown();
                        
                        // Show modified banner
                        document.getElementById('modifiedBanner').classList.add('visible');
                        
                        // Highlight modified rows
                        highlightModifiedFlights();
                        
                        showToast(
                            'Time Updated',
                            `${flight.flight} time updated to ${liveUpdateState.pendingETD} on ${assignment.team}`,
                            'warning'
                        );
                        addRecentUpdate(`${flight.flight} time &rarr; ${liveUpdateState.pendingETD} (kept, cascade adj.)`);
                        
                        // Clear pending ETD
                        liveUpdateState.pendingETD = null;
                    } else {
                        // No time change
                        showToast(
                            'Cascade Adjustments',
                            `${flight.flight} kept on ${assignment.team}, other flights will be adjusted`,
                            'warning'
                        );
                        addRecentUpdate(`${flight.flight} kept, cascade adjustments made`);
                    }
                    
                    liveUpdateState.alertCounts.warning++;
                    break;
                    
            }
            
            updateAlertCounts();
            
            // Clear the selection after a delay
            setTimeout(() => {
                document.getElementById('clearBtn').click();
            }, 1000);
            
            console.log(' Reallocation option applied successfully');
            console.log('Modified flights:', liveUpdateState.modifications.flights);
        };

        // Highlight modified flights in the schedule tables
        function highlightModifiedFlights() {
            // Wait for DOM to update
            setTimeout(() => {
                Object.keys(liveUpdateState.modifications.flights).forEach(flightNumber => {
                    const modification = liveUpdateState.modifications.flights[flightNumber];
                    
                    // Skip cancelled flights (they get their own highlighting)
                    if (modification.isCancelled) return;
                    
                    // Find all table rows with this flight number
                    const rows = document.querySelectorAll(`#flightTableBody tr, #teamDetailedGroups tr`);
                    rows.forEach(row => {
                        const flightCell = row.querySelector('td:first-child');
                        if (flightCell && flightCell.textContent.trim() === flightNumber) {
                            row.classList.add('flight-modified');
                            
                            // Add modified badge to flight number
                            if (!flightCell.querySelector('.modified-badge')) {
                                const badge = document.createElement('span');
                                badge.className = 'modified-badge';
                                badge.textContent = 'MODIFIED';
                                flightCell.appendChild(badge);
                            }
                            
                            // Highlight modified team (if team changed)
                            if (modification.newTeam) {
                                const teamCell = row.querySelector('td:nth-child(5)'); // Assigned Team column
                                if (teamCell) {
                                    teamCell.innerHTML = `<span class="team-modified">${modification.newTeam}</span>`;
                                }
                            }
                            
                            // Highlight modified time (if time changed)
                            if (modification.newTime && modification.newTime !== modification.oldTime) {
                                const timeCell = row.querySelector('td:nth-child(3)'); // Departure Time column
                                if (timeCell) {
                                    timeCell.innerHTML = `<span class="time-modified">${modification.newTime}</span>`;
                                }
                            }
                        }
                    });
                });
                
                // Also highlight cancelled flights
                highlightCancelledFlights();
                
                console.log(' Modified flights highlighted in schedule tables');
            }, 100);
        }

        // Clear Button
        document.getElementById('clearBtn').addEventListener('click', () => {
            document.getElementById('flightSearchInput').value = '';
            document.getElementById('flightUpdateCard').style.display = 'none';
            document.getElementById('impactContent').innerHTML = `
                <div style="text-align: center; padding: 40px; color: #94a3b8;">
                    
                    <p>Select a flight and click "Analyze Impact" to see<br>reallocation recommendations</p>
                </div>
            `;
            liveUpdateState.selectedFlight = null;
            liveUpdateState.selectedFlightData = null;
        });

        // Cancel Flight Button
        document.getElementById('cancelFlightBtn').addEventListener('click', () => {
            if (!liveUpdateState.selectedFlightData) {
                showToast('No Flight Selected', 'Please select a flight first', 'warning');
                return;
            }
            
            const assignment = liveUpdateState.selectedFlightData;
            const flight = assignment.flight;
            
            // Execute cancellation directly (no confirm needed in sandboxed environment)
            console.log(`Cancelling flight ${flight.flight}...`);
            cancelFlight(assignment);
        });

        function cancelFlight(assignment) {
            const flight = assignment.flight;
            const oldTeam = assignment.team; // Save team BEFORE it gets nullified
            
            console.log(`Cancelling flight ${flight.flight} from team ${oldTeam}...`);
            
            // 1. Find the assignment in scheduleResult
            const assignmentToCancel = scheduleResult.assignments.find(
                a => a.flight.flight === flight.flight
            );
            
            if (assignmentToCancel) {
                const teamToFree = assignmentToCancel.team;
                
                // Mark as cancelled
                assignmentToCancel.isCancelled = true;
                assignmentToCancel.team = null; // Remove team assignment
                
                // 2. Remove from team's operations
                const teamData = scheduleResult.teamWorkload.find(
                    tw => tw.team.id === teamToFree
                );
                
                if (teamData) {
                    teamData.operations = teamData.operations.filter(
                        op => op.flight !== flight.flight
                    );
                    teamData.count = teamData.operations.length;
                    console.log(`[OK] Removed from ${teamToFree}, now has ${teamData.count} ops`);
                }
                
                // 3. Track modification
                liveUpdateState.modifications.flights[flight.flight] = {
                    flightNumber: flight.flight,
                    destination: flight.destination,
                    time: flight.time,
                    oldTeam: teamToFree,
                    isCancelled: true
                };
                liveUpdateState.modifications.hasChanges = true;
                
                // Track for undo
                liveUpdateState.undoHistory.push({
                    type: 'cancel',
                    flightNumber: flight.flight,
                    oldTeam: teamToFree,
                    description: `${flight.flight} cancelled (was on ${teamToFree})`
                });
                
                // 4. Refresh displays
                displayResults(scheduleResult);
                setupTeamSearch();
                populatePrintDropdown();
                
                // 5. Show modified banner
                document.getElementById('modifiedBanner').classList.add('visible');
                
                // 6. Highlight cancelled flight
                highlightCancelledFlights();
            }
            
            // Add to recent updates (using saved oldTeam)
            addRecentUpdate(`${flight.flight} cancelled -> ${oldTeam} freed up`);
            
            // Update alert counts
            liveUpdateState.alertCounts.resolved++;
            updateAlertCounts();
            
            // Clear the form
            document.getElementById('clearBtn').click();
            
            // Show success notification (using saved oldTeam)
            showToast(
                'Flight Cancelled', 
                `${flight.flight} has been cancelled. Team ${oldTeam} is now available.`,
                'success'
            );
            
            console.log(`[OK] Flight ${flight.flight} cancelled successfully`);
        }

        // Highlight cancelled flights in the schedule
        function highlightCancelledFlights() {
            setTimeout(() => {
                Object.keys(liveUpdateState.modifications.flights).forEach(flightNumber => {
                    const modification = liveUpdateState.modifications.flights[flightNumber];
                    
                    if (modification.isCancelled) {
                        // Find all table rows with this flight number
                        const rows = document.querySelectorAll(`#flightTableBody tr, #teamDetailedGroups tr`);
                        rows.forEach(row => {
                            const flightCell = row.querySelector('td:first-child');
                            if (flightCell && flightCell.textContent.trim() === flightNumber) {
                                row.classList.add('flight-cancelled');
                                
                                // Add cancelled badge and strikethrough
                                if (!flightCell.querySelector('.cancelled-badge')) {
                                    flightCell.innerHTML = `<span class="cancelled-text">${flightNumber}</span><span class="cancelled-badge">CANCELLED</span>`;
                                }
                                
                                // Remove team and show "Cancelled" in red
                                const teamCell = row.querySelector('td:nth-child(5)'); // Assigned Team column
                                if (teamCell) {
                                    teamCell.innerHTML = `<span class="cancelled-team">Cancelled</span>`;
                                }
                            }
                        });
                    }
                });
                
                console.log(' Cancelled flights highlighted');
            }, 100);
        }

        function addRecentUpdate(updateText) {
            liveUpdateState.recentUpdates.unshift(updateText);
            if (liveUpdateState.recentUpdates.length > 5) {
                liveUpdateState.recentUpdates.pop();
            }
            
            updateRecentUpdatesList();
            
            // Show undo button when there are updates
            const undoBtn = document.getElementById('undoBtn');
            if (undoBtn && liveUpdateState.undoHistory.length > 0) {
                undoBtn.style.display = 'inline-block';
            }
        }

        function updateRecentUpdatesList() {
            const listElement = document.getElementById('recentUpdatesList');
            
            if (liveUpdateState.recentUpdates.length === 0) {
                listElement.innerHTML = `
                    <div style="font-size: 0.85em; color: #94a3b8; padding: 10px; text-align: center;">
                        No updates yet today
                    </div>
                `;
                return;
            }
            
            let html = '';
            liveUpdateState.recentUpdates.forEach(update => {
                html += `<div class="recent-update-item"><strong>${update}</strong></div>`;
            });
            listElement.innerHTML = html;
        }

        // Undo last change
        function undoLastChange() {
            if (liveUpdateState.undoHistory.length === 0) {
                showToast('Nothing to Undo', 'No recent changes to reverse', 'info');
                return;
            }
            
            const lastChange = liveUpdateState.undoHistory.pop();
            console.log('=== UNDOING CHANGE ===', lastChange);
            
            if (lastChange.type === 'reassign') {
                // Revert team assignment
                const assignment = scheduleResult.assignments.find(
                    a => a.flight.flight === lastChange.flightNumber
                );
                
                if (assignment) {
                    // Remove from new team
                    const newTeamData = scheduleResult.teamWorkload.find(
                        tw => tw.team.id === lastChange.newTeam
                    );
                    if (newTeamData) {
                        newTeamData.operations = newTeamData.operations.filter(
                            op => op.flight !== lastChange.flightNumber
                        );
                        newTeamData.count = newTeamData.operations.length;
                    }
                    
                    // Add back to old team
                    const oldTeamData = scheduleResult.teamWorkload.find(
                        tw => tw.team.id === lastChange.oldTeam
                    );
                    if (oldTeamData) {
                        oldTeamData.operations.push(assignment.flight);
                        // Sort operations by time to maintain chronological order
                        oldTeamData.operations.sort((a, b) => a.timeMinutes - b.timeMinutes);
                        oldTeamData.count = oldTeamData.operations.length;
                    }
                    
                    // Update assignment
                    assignment.team = lastChange.oldTeam;
                    
                    // Revert time if it was changed
                    if (lastChange.oldTime && lastChange.newTime) {
                        assignment.flight.time = lastChange.oldTime;
                        const timeParts = lastChange.oldTime.split(':');
                        assignment.flight.timeMinutes = parseInt(timeParts[0]) * 60 + parseInt(timeParts[1]);
                    }
                }
            } else if (lastChange.type === 'cancel') {
                // Uncancel flight
                const assignment = scheduleResult.assignments.find(
                    a => a.flight.flight === lastChange.flightNumber
                );
                
                if (assignment) {
                    assignment.isCancelled = false;
                    assignment.team = lastChange.oldTeam;
                    
                    // Add back to team
                    const teamData = scheduleResult.teamWorkload.find(
                        tw => tw.team.id === lastChange.oldTeam
                    );
                    if (teamData) {
                        teamData.operations.push(assignment.flight);
                        // Sort operations by time to maintain chronological order
                        teamData.operations.sort((a, b) => a.timeMinutes - b.timeMinutes);
                        teamData.count = teamData.operations.length;
                    }
                }
            }
            
            // Remove from modifications
            delete liveUpdateState.modifications.flights[lastChange.flightNumber];
            
            // Check if there are any remaining modifications
            if (Object.keys(liveUpdateState.modifications.flights).length === 0) {
                liveUpdateState.modifications.hasChanges = false;
                document.getElementById('modifiedBanner').classList.remove('visible');
            }
            
            // Remove last item from recent updates
            liveUpdateState.recentUpdates.shift();
            updateRecentUpdatesList();
            
            // Hide undo button if no more changes
            if (liveUpdateState.undoHistory.length === 0) {
                document.getElementById('undoBtn').style.display = 'none';
            }
            
            // Refresh display
            displayResults(scheduleResult);
            setupTeamSearch();
            populatePrintDropdown();
            highlightModifiedFlights();
            
            showToast('Change Undone', `Reverted: ${lastChange.description}`, 'success');
            console.log(' Undo completed');
        }

        function updateAlertCounts() {
            document.getElementById('criticalCount').textContent = liveUpdateState.alertCounts.critical;
            document.getElementById('warningCount').textContent = liveUpdateState.alertCounts.warning;
            document.getElementById('resolvedCount').textContent = liveUpdateState.alertCounts.resolved;
        }

        // Initialize alert counts
        updateAlertCounts();

        // Create global test functions for buttons (backup onclick handlers)
        window.testAnalyze = function() {
            console.log('TEST ANALYZE CALLED');
            analyzeFlightImpact();
        };
        
        window.testClear = function() {
            console.log('TEST CLEAR CALLED');
            document.getElementById('flightSearchInput').value = '';
            document.getElementById('flightUpdateCard').style.display = 'none';
            document.getElementById('impactContent').innerHTML = `
                <div style="text-align: center; padding: 40px; color: #94a3b8;">
                    
                    <p>Select a flight and click "Analyze Impact" to see<br>reallocation recommendations</p>
                </div>
            `;
            liveUpdateState.selectedFlight = null;
            liveUpdateState.selectedFlightData = null;
        };
        
        window.testCancel = function() {
            console.log('TEST CANCEL CALLED');
            if (!liveUpdateState.selectedFlightData) {
                showToast('No Flight Selected', 'Please select a flight first', 'warning');
                return;
            }
            
            const assignment = liveUpdateState.selectedFlightData;
            const flight = assignment.flight;
            
            // Execute directly (no confirm in sandboxed environment)
            console.log(`Cancelling flight ${flight.flight}...`);
            cancelFlight(assignment);
        };

        console.log(' Live Update & Reallocation Module initialized');
        
        // Verify event listeners are attached
        console.log('Verifying event listeners...');
        console.log('- analyzeBtn exists:', !!document.getElementById('analyzeBtn'));
        console.log('- clearBtn exists:', !!document.getElementById('clearBtn'));
        console.log('- cancelFlightBtn exists:', !!document.getElementById('cancelFlightBtn'));
        console.log('- etdInput exists:', !!document.getElementById('etdInput'));
        console.log('- stdInput exists:', !!document.getElementById('stdInput'));
    </script>
</body>
</html>
